<!DOCTYPE html><html ko="ko"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 5.13.4"/><meta data-react-helmet="true" name="viewport" content="width=device-width, initial-scale=1"/><meta data-react-helmet="true" charSet="utf-8"/><meta data-react-helmet="true" name="robots" content="index,follow"/><meta data-react-helmet="true" name="googlebot" content="index,follow"/><meta data-react-helmet="true" name="color-scheme" content="light"/><meta data-react-helmet="true" name="description" content="필자는 쓸데없지만 재밌는 프로그램을 만들면서 공부하는 것을 좋아한다. 최근에 정신적으로 에너지가 바닥나고 있다는 것을 느껴 작년에 재미로 만들었던 Jazzlang과 같이 정신적 에너지를 채워줄만한 재미를 느끼고 싶었다. 그래서 무언가 할만한 것을…"/><meta data-react-helmet="true" property="author" content="Lee Sun-Hyoup"/><meta data-react-helmet="true" property="og:title" content="ASCII 3D 렌더러 만들기"/><meta data-react-helmet="true" property="og:description" content="필자는 쓸데없지만 재밌는 프로그램을 만들면서 공부하는 것을 좋아한다. 최근에 정신적으로 에너지가 바닥나고 있다는 것을 느껴 작년에 재미로 만들었던 Jazzlang과 같이 정신적 에너지를 채워줄만한 재미를 느끼고 싶었다. 그래서 무언가 할만한 것을…"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" property="og:site_name" content="kciter.so"/><meta data-react-helmet="true" property="og:locale" content="ko_KR"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="Sunhyoup Lee"/><meta data-react-helmet="true" name="twitter:title" content="ASCII 3D 렌더러 만들기"/><meta data-react-helmet="true" name="twitter:description" content="필자는 쓸데없지만 재밌는 프로그램을 만들면서 공부하는 것을 좋아한다. 최근에 정신적으로 에너지가 바닥나고 있다는 것을 느껴 작년에 재미로 만들었던 Jazzlang과 같이 정신적 에너지를 채워줄만한 재미를 느끼고 싶었다. 그래서 무언가 할만한 것을…"/><meta data-react-helmet="true" property="og:image" content="https://kciter.so/images/2024-03-03-ascii-3d-renderer/thumbnail.png"/><meta data-react-helmet="true" name="article:published_time" content="2024-03-03T00:00:00+09:00"/><meta data-react-helmet="true" name="image" content="https://kciter.so/images/2024-03-03-ascii-3d-renderer/thumbnail.png"/><meta data-react-helmet="true" property="og:image" content="https://kciter.so/images/2024-03-03-ascii-3d-renderer/thumbnail.png"/><meta data-react-helmet="true" property="og:image:secure_url" content="https://kciter.so/images/2024-03-03-ascii-3d-renderer/thumbnail.png"/><style data-href="/styles.bd0803f641a1f076f7e7.css" data-identity="gatsby-global-css">.command-line-prompt{border-right:1px solid #999;display:block;float:left;font-size:100%;letter-spacing:-1px;margin-right:1em;pointer-events:none;text-align:right;-webkit-user-select:none;user-select:none}.command-line-prompt>span:before{opacity:.7}.command-line-prompt>span[data-continuation-prompt]:before{content:attr(data-continuation-prompt)}.command-line span.token.output{opacity:.7}code[class*=language-],pre[class*=language-]{color:#5c6e74;direction:ltr;font-family:Source Code Pro,monospace;font-size:13px;-webkit-hyphens:none;hyphens:none;line-height:1.5;tab-size:4;text-align:left;text-shadow:none;white-space:pre;word-break:normal;word-spacing:normal}code[class*=language-]::mozselection,code[class*=language-]::selection,pre[class*=language-]::mozselection,pre[class*=language-]::selection{background:#b3d4fc;text-shadow:none}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{background:#fff;margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-]{background:#f9f2f4;border-radius:3px;color:#db4c69;padding:.25em .5em;position:relative;top:-1px;white-space:normal}.namespace{opacity:.7}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#93a1a1}.token.punctuation{color:#999}.token.boolean,.token.constant,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{color:#a67f59}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}pre[data-line]{position:relative}pre[class*=language-]>code[class*=language-]{position:relative;z-index:1}.line-highlight{background:#f7efda;box-shadow:inset 5px 0 0 #87d8ff;left:0;line-height:inherit;margin-top:1em;padding-bottom:inherit;padding-left:0;padding-right:0;padding-top:inherit;pointer-events:none;position:absolute;right:0;white-space:pre;z-index:0}.command-line-prompt>span:before{color:#999;content:" ";display:block;padding-right:.8em}.command-line-prompt>span[data-user]:before{content:"[" attr(data-user) "@" attr(data-host) "] $"}.command-line-prompt>span[data-user=root]:before{content:"[" attr(data-user) "@" attr(data-host) "] #"}.command-line-prompt>span[data-prompt]:before{content:attr(data-prompt)}.gatsby-highlight pre{float:left;min-width:100%}.gatsby-highlight{background-color:#fff;border-radius:.3em;box-shadow:0 5px 20px rgba(0,0,0,.12);margin:32px auto;overflow:auto;padding:1em}.gatsby-highlight pre[class*=language-]{background-color:transparent;float:left;margin:0;min-width:100%;overflow:initial;padding:0}.gatsby-highlight-code-line{background:#fffbdd;border-left:.25em solid #87d8ff;display:block;margin-left:-1em;margin-right:-1em;padding-left:.75em;padding-right:1em}html{-webkit-text-size-adjust:none;-moz-text-size-adjust:none;-o-text-size-adjust:none;text-size-adjust:none}body{color:#212b36;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;font-size:16px;line-height:1.75rem}@media (max-width:30em){body{font-size:14px;line-height:1.5rem}body h1{font-size:1.5rem}}h1{border-bottom:1px solid #eee;font-size:2rem;padding-bottom:12px}h1 a{text-decoration:none}h2{border-bottom:1px solid #eee;font-size:1.6em;padding-bottom:8px}h3{font-size:1.3em}h3,h4{margin:8px 0}h4{font-size:1.2em}h1,h2,h3,h4,h5,h6{color:#454f5b;margin-top:48px}h1 a,h2 a,h3 a,h4 a,h5 a,h6 a{color:#454f5b!important}a{color:#454f5b;text-decoration:underline}a:hover{border-bottom:none;color:#000}img{border-radius:5px;height:auto;max-width:100%}blockquote{background-color:#eee;border-left:.25em solid #ccc;color:#454f5b;line-height:1.5;margin:10px 0;padding:8px 16px}hr{border-top:1px solid #ccc}.container{margin-left:auto;margin-right:auto;width:715px}@media (max-width:768px){.container{width:90vw}}.masthead{font-family:Quattrocento Sans,sans-serif;margin-bottom:4rem;padding-bottom:.5rem;padding-top:.5rem}.masthead a:hover{color:#000}.masthead-title a{color:#505050;font-size:2rem;text-decoration:none}.masthead-subtitle{color:#999}.thumbnail-container{border-radius:8px;box-shadow:0 0 10px 2px rgba(0,0,0,.05);margin-bottom:25px;max-width:100%}.thumbnail-container a,.thumbnail-container img{display:block;object-fit:cover;width:100%}.post-container{position:relative}.post-content a{color:#5c6ac4;text-decoration:none}.post-content a:hover{text-decoration:underline}.post-content a.footnote-ref{color:#ff6f00}.post-content>p:first-letter{margin-left:.3em}.post-content ul{word-break:break-all}@media (max-width:30em){.post-content ul{list-style-position:outside;padding-left:24px}.post-content li>ul{list-style-position:outside;padding-left:12px}}sup{font-weight:400;position:relative;top:-.5em;vertical-align:top}.posts{line-height:26px;list-style:none;margin-bottom:16px;padding:0}.post-title{border:none;margin:0;padding:0}.post-date{color:#9a9a9a;display:block;font-family:Quattrocento Sans,sans-serif;font-size:.8rem;margin-bottom:1rem;margin-top:3px}@media (max-width:30rem){.posts h1{font-size:1.5rem}}.related{padding-bottom:2rem;padding-top:2rem}.related-posts{column-gap:20px;display:grid;grid-template-columns:1fr 1fr 1fr;row-gap:10px}.related-post img{box-shadow:0 0 10px 2px rgba(0,0,0,.05);height:140px;object-fit:cover}.related-post .title{font-size:20px;font-weight:100;line-height:24px;margin-top:12px}.related-posts a{text-decoration:none}@media (max-width:30rem){.related-posts{grid-template-columns:1fr}.related-post img{width:100%}}figure{margin:24px 40px;text-align:center}@media (max-width:30em){figure{margin:24px 0}}figcaption{color:#637381;font-size:12px;text-align:center}.pagination{font-family:Quattrocento Sans,sans-serif;overflow:hidden;text-align:center}.pagination a{text-decoration:none}.pagination-button{border:1px solid #e0e0e0;color:#999;display:inline-block;font-size:16px;font-weight:700;padding:15px 45px}.pagination-active{color:#000}.pagination-active:hover{background-color:#e0e0e0}.footer{color:#999;margin:2rem;text-align:center}.footer a{color:#999;padding:10px;text-decoration:none}.footer a:hover{color:#333}.menu{display:block;padding-top:.5rem}.menu-content{float:left}.menu-content a{color:#999;font-size:1rem;padding-right:15px}.menu-content a:last-child{padding-right:0}.social-icons{float:right}.social-icons a{color:#999;font-size:1rem}@media (max-width:30em){.social-icons{float:left;padding-top:0}.menu-content{margin-bottom:5px}}.toc{max-height:80vh;overflow-x:hidden;overflow-y:auto;position:absolute;right:-20px;transform:translateX(100%)}.toc,.toc ul{max-width:250px;width:100%}.toc ul{height:100%;margin:0 0 8px;padding:0}.toc li{list-style:none;margin:0;padding:0}.toc li ul{border-left:1px solid #dfe3e8;margin-left:16px}.toc a{border-radius:4px;color:#454f5b;display:block;font-size:14px;font-weight:400;line-height:20px;margin-left:6px;padding:8px 12px;text-decoration:none;word-break:keep-all}.toc a:hover{background-color:#f4f6f8;color:#212b36}@media (max-width:1400px){.toc{display:none}}.series{left:-20px;max-width:320px;position:absolute;transform:translateX(-100%);width:100%}.series h4{margin:0;padding:0}.series ul{margin:0 0 8px;max-width:320px;padding:0;width:100%}.series li{list-style:none;margin:0;padding:0}.series li ul{border-left:1px solid #dfe3e8;margin-left:16px}.series a{border-radius:4px;color:#454f5b;display:block;font-size:14px;font-weight:400;line-height:20px;margin-left:6px;padding:8px 12px;text-decoration:none;word-break:keep-all}.series a:hover{background-color:#f4f6f8;color:#212b36}@media (max-width:1400px){.series{display:none}}.footnotes{font-size:12px;margin-top:12px}.footnotes hr{border:none;border-top:1px solid #eee;margin:0}.footnotes ol{line-height:16px;padding-left:16px}.footnotes ol li{margin-top:12px;padding-left:4px}.footnotes ol li::marker{color:#ff6f00}.footnotes ol li .footnote-backref{margin-left:5px}.gist .gist-file{font-family:Source Code Pro,monospace!important}.gist .markdown-body{padding:15px}.gist pre{background-color:transparent;padding:0}.gist .gist-file .gist-data{font-size:.8rem!important;line-height:1.4}.gist code{background-color:transparent;border-radius:0;color:inherit;padding:0}table{border-collapse:collapse;margin-bottom:30px;width:100%}table,td,th{border:1px solid #888}td,th{padding:8px;text-align:left}.sharing-icons a{padding-right:10px}.fa-envelope{padding:5px;transition:.5s}.fa-envelope:hover{color:#f39c12}.fa-twitter{padding:5px;transition:.5s}.fa-twitter:hover{color:#00aced}.fa-instagram{padding:5px;transition:.5s}.fa-instagram:hover{color:#375989}.fa-github{padding:5px;transition:.5s}.fa-github:hover{color:#343434}.fa-linkedin{padding:5px;transition:.5s}.fa-linkedin:hover{color:#0073a4}.fa-facebook{padding:5px;transition:.5s}.fa-facebook:hover{color:#3d5b99}.fa-google-plus{padding:5px;transition:.5s}.fa-google-plus:hover{color:#e64a41}.fa-pinterest{padding:5px;transition:.5s}.fa-pinterest:hover{color:#bd081c}.fa-medium{padding:5px;transition:.5s}.fa-medium:hover{color:#00ab6c}.fa-codepen{padding:5px;transition:.5s}.fa-codepen:hover{color:#000}.fa-rss-square{padding:5px;transition:.5s}.fa-rss-square:hover{color:#f60}.not-found{background:url(https://38.media.tumblr.com/546c0cd48d71f210f9b67a389003790d/tumblr_neq0yw9rMA1tm16jjo1_500.gif) no-repeat 50%;background-size:contain;border-radius:12px;height:400px;width:100%}[data-tooltip]{position:relative}[data-tooltip]:after{word-wrap:break-word;background-color:#212b36;border-left:6px solid #ff6f00;border-radius:2px;box-shadow:1px 2px 6px rgba(0,0,0,.3);color:#fff;content:attr(data-tooltip);display:none;font-size:12px;left:10px;line-height:16px;overflow-wrap:break-word;padding:8px 10px;pointer-events:none;position:absolute;top:0;white-space:nowrap;word-break:break-all;z-index:1000}[data-tooltip]:focus:after,[data-tooltip]:hover:after{display:block}@media (max-width:30em){[data-tooltip]:focus:after,[data-tooltip]:hover:after{display:none}}.member-container{display:flex;padding:24px 0}.member-container .avatar{flex:0 1 160px}.avatar img{border-radius:50%;width:100%}.member-container .summary{flex:1 1;margin-left:32px}.member-container{display:block}.member-container .avatar{display:block;margin:0 auto;max-width:300px;width:50%}.member-container .summary{font-size:12px;margin-left:0;text-align:center}.member-container .summary .name{font-size:28px;font-weight:100;margin-top:18px}.member-container .summary .description{font-weight:100;margin-top:8px}#page-footer{margin-bottom:16px}#page-footer:after{clear:both;content:"";display:block}#tags{float:left;margin-top:4px}#tags .tag{border:1px solid #dfe3e8;border-radius:50px;color:#888;display:inline-block;font-size:10px;height:20px;line-height:20px;margin-right:4px;padding:0 8px}#comment-button-wrapper{float:right}#comment-button{border:1px solid #dfe3e8;border-radius:50px;color:#888;cursor:pointer;display:inline-block;font-size:14px;padding:4px 12px}#comments{display:block}@media (max-width:30rem){#tags{float:none}#comment-button-wrapper{display:none;float:none}#comments{display:block}}.tiny-header{color:#212b36;font-size:16px;font-weight:700}.gatsby-highlight{padding:0;width:95%}.gatsby-highlight pre[class*=language-]{box-sizing:border-box;padding:16px}@media (max-width:30em){.gatsby-highlight{width:100%}}.special-thanks{margin-bottom:8px}.avatars,.sponsors{display:flex}.avatars{flex:1 1}.sponser-button{background-color:#fff;border-radius:7px;color-scheme:light;height:32px;width:120px}.sponsors .avatar{border-radius:50%;height:36px;overflow:hidden;position:relative;width:36px}.sponsors .avatar img{height:100%;width:100%}.not-yet-published{font-size:20px;font-weight:700;margin:16px 0;text-align:center}.post-bio-container{display:flex;padding:24px 0}.post-bio-container .avatar{flex:0 1 80px}.post-bio-container .avatar img{border-radius:50%;width:100%}.post-bio-container .summary{flex:1 1;font-size:16px;margin-left:32px}.post-bio-container .summary .name{-webkit-text-fill-color:transparent;background:linear-gradient(90deg,#191335,#191335 33.33333%,#00ab6c 66.66666%,#00cb8c);-webkit-background-clip:text;background-clip:text;background-position:0 0;background-size:300% 100%;font-weight:700;transition:all .3s ease}.post-bio-container .summary .name:hover{background-position:top left 100%}.post-bio-container .summary .description{font-size:14px;font-weight:100}.post-bio-container .summary .socials{margin-left:-4px}.post-bio-container .summary .socials a{color:#888;font-size:14px}</style><title data-react-helmet="true">ASCII 3D 렌더러 만들기 | kciter.so</title><link data-react-helmet="true" rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400"/><link data-react-helmet="true" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Code+Pro"/><link data-react-helmet="true" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Quattrocento+Sans"/><link data-react-helmet="true" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"/><script data-react-helmet="true" type="application/ld+json">{"headline":"ASCII 3D 렌더러 만들기","dateModified":"2024-03-03T00:00:00+09:00","datePublished":"2024-03-03T00:00:00+09:00","image":"undefined/images/2024-03-03-ascii-3d-renderer/thumbnail.png","mainEntityOfPage":{"@type":"WebPage"},"author":{"@type":"Person","name":"Lee Sun-Hyoup"},"description":"필자는 쓸데없지만 재밌는 프로그램을 만들면서 공부하는 것을 좋아한다. 최근에 정신적으로 에너지가 바닥나고 있다는 것을 느껴 작년에 재미로 만들었던 Jazzlang과 같이 정신적 에너지를 채워줄만한 재미를 느끼고 싶었다. 그래서 무언가 할만한 것을…","@type":"BlogPosting","@context":"https://schema.org"}</script><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= 'https://www.googletagmanager.com/gtm.js?id='+i+dl+'';f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer', 'G-7M8K7EBEDX');</script></head><body><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=G-7M8K7EBEDX" height="0" width="0" style="display: none; visibility: hidden" aria-hidden="true"></iframe></noscript><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="container"><header class="masthead"><h3 class="masthead-title"><a href="/" style="margin-right:5px">kciter.so</a><small class="masthead-subtitle">devlog</small><div class="menu"><nav class="menu-content"><a href="https://kciter.so/resume" target="_blank">Résumé</a><a href="/writing/">Writing</a><a href="/about/">About</a></nav><nav class="social-icons"><a href="https://github.com/kciter" target="_blank" style="margin-right:5px"><i class="fa fa-github" aria-hidden="true"></i></a><a href="https://www.facebook.com/sunhyoup.lee" target="_blank" style="margin-right:5px"><i class="fa fa-facebook" aria-hidden="true"></i></a><a href="https://www.linkedin.com/in/kciter" target="_blank" style="margin-right:5px"><i class="fa fa-linkedin" aria-hidden="true"></i></a><a href="https://twitter.com/kciter" target="_blank" style="margin-right:5px"><i class="fa fa-twitter" aria-hidden="true"></i></a><a href="mailto:kciter@naver.com" target="_blank" style="margin-right:5px"><i class="fa fa-envelope" aria-hidden="true"></i></a><a href="/feed.xml" target="_blank"><i class="fa fa-rss-square" aria-hidden="true"></i></a></nav></div></h3></header><div class="post-container"><h1 class="post-title">ASCII 3D 렌더러 만들기</h1><span class="post-date">Written on <!-- -->March 3, 2024</span><img src="/images/2024-03-03-ascii-3d-renderer/thumbnail.png"/><div class="toc" data-margin-top="50"><ul><li><a href="#어떻게-ascii를-3d처럼-보이게-할까">어떻게 ASCII를 3D처럼 보이게 할까?</a></li><li><a href="#3d-좌표를-2d-좌표로">3D 좌표를 2D 좌표로</a><ul><li><a href="#버텍스-처리">버텍스 처리</a><ul><li><a href="#월드-변환">월드 변환</a></li><li><a href="#뷰-변환">뷰 변환</a></li><li><a href="#투영-변환">투영 변환</a></li></ul></li><li><a href="#래스터화">래스터화</a><ul><li><a href="#뷰포트-변환">뷰포트 변환</a></li><li><a href="#클리핑">클리핑</a></li><li><a href="#삼각형-래 스터화">삼각형 래스터화</a></li></ul></li><li><a href="#프래그먼트-처리">프래그먼트 처리</a></li></ul></li><li><a href="#구현하기">구현하기</a><ul><li><a href="#사전-준비">사전 준비</a></li><li><a href="#모델-로더-구현">모델 로더 구현</a></li><li><a href="#렌더러-구현">렌더러 구현</a></li></ul></li><li><a href="#마치며">마치며</a></li></ul></div><div class="post-content"><p>필자는 쓸데없지만 재밌는 프로그램을 만들면서 공부하는 것을 좋아한다. 최근에 정신적으로 에너지가 바닥나고 있다는 것을 느껴 작년에 재미로 만들었던 <a href="https://kciter.so/posts/crafting-esolang/" rel="nofollow noopener noreferrer">Jazzlang</a>과 같이 정신적 에너지를 채워줄만한 재미를 느끼고 싶었다. 그래서 무언가 할만한 것을 찾던 중 작년 이맘때 쯤 재밌는 <a href="https://www.youtube.com/watch?v=p09i_hoFdd0" rel="nofollow noopener noreferrer">유튜브 영상</a>을 봤던 것이 생각났다. 영상에서는 <strong>CLI 환경에서 큐브를 회전시키는 프로그램</strong>을 처음부터 끝까지 조용히 코딩하는 것을 보여준다.</p>
<figure><figure><img src="/images/2024-03-03-ascii-3d-renderer/youtube.gif" width="80%" style="cursor:default"/></figure><figcaption>영상 중 일부 캡쳐</figcaption></figure>
<p>필자는 이 아이디어가 굉장히 참신하다 생각했다. 마침 무언가를 만들고 싶었던 차에 <span><code class="language-text">큐브가 됐다면 CLI 환경에서 다른 물체도 3D 렌더링 할 수 있지 않을까?</code></span>라는 생각을 하게되었고 실제로 구현했다. 이 글의 결과물은 <a href="https://github.com/kciter/ascii-3d-renderer.js" rel="nofollow noopener noreferrer">이곳</a>에서 볼 수 있다.</p>
<h1 id="어떻게-ascii를-3d처럼-보이게-할까"><a href="#어떻게-ascii를-3d처럼-보이게-할까">어떻게 ASCII를 3D처럼 보이게 할까?</a></h1>
<p>3D 렌더링은  빛과 그림자, 최적화, 쉐이더, 충돌 처리, 물리 계산 등 굉장히 난이도가 높은 기술이 포함된다. 하지만 우리는 단순히 3D 물체를 화면에 그리기만 할 것이기 때문에 몇 가지 기본적인 기술만 알면 된다. 우리는 화면에 나오는 물체를 왜 삼차원 공간으로 인식을 할까? 답은 간단하다. 스크린을 통해 <strong>원근감</strong>을 표현했기 때문이다. 사람이 원근감을 느끼도록 만드는 방법은 다양하지만 일반적인 CLI 환경에서 쓸 수 있는 것은 <strong>선<sup><a href="#user-content-fn-1" id="user-content-fnref-1" data-footnote-ref="true" aria-describedby="footnote-label">1</a></sup>과 명암</strong> 뿐이다.</p>
<figure><img src="/images/2024-03-03-ascii-3d-renderer/perspective.png" style="cursor:default"/><figcaption>겨우 선 몇 개로 공간을 느낄 수 있다</figcaption></figure>
<p>선을 이용하여 원근감을 표현하는 방법은 간단하다. <strong>멀리있는 것은 결국 한 점으로 모인다</strong>는 사실을 이용할 수 있다. 이를 미술 용어로 <a href="https://ko.wikipedia.org/wiki/%EC%86%8C%EC%8B%A4%EC%A0%90" rel="nofollow noopener noreferrer">소실점</a>이라 부른다. 소실점은 여러 개가 있을 수 있다.</p>
<figure><img src="/images/2024-03-03-ascii-3d-renderer/shade.jpeg" width="70%" style="cursor:default"/><figcaption>빛과 그림자를 통해 입체감을 표현할 수 있다</figcaption></figure>
<p>명암을 포함한 원근감을 표현하는 방법은 더욱 간단하다. <strong>빛이 있는 곳은 밝게, 빛이 없는 곳은 어둡게</strong> 표현하면 된다. 이를 통해 물체의 입체감을 표현할 수 있다.</p>
<p>그런데 ASCII 만으로 원금감, 입체감을 표현할 수 있을까? 우선 결론부터 이야기하자면 <strong>ASCII를 이용한다는 것은 사실 조금 큰 픽셀</strong>이라 생각하면 된다. 다음 이미지를 보자.</p>
<figure><img src="/images/2024-03-03-ascii-3d-renderer/pixelate.png" style="cursor:default"/></figure>
<p>좌측은 원본 이미지 우측은 Pixelate 이펙트를 입힌 이미지다. ASCII를 사용한다는 것은 단지 글자를 이용하여 우측 이미지 처럼 만드는 것과 크게 다르지 않다. 이를 이용한 작품도 존재한다.</p>
<figure><img src="/images/2024-03-03-ascii-3d-renderer/ascii-art.png" width="80%" style="cursor:default"/><figcaption>문자를 이용하여 위키피디아 로고를 표현했다</figcaption></figure>
<p>위 이미지를 보면 텍스트만으로 충분히 이미지를 표현할 수 있다는 것을 알 수 있다. 그리고 <strong>빛이 보고있는 방향에서 나온다 가정했을 때 가까이 있을 수록 짙은 텍스트 멀리 있을 수록 옅은 텍스트</strong>로 나타냈기에 원근감과 명암마저도 표현할 수 있다.</p>
<figure><img src="/images/2024-03-03-ascii-3d-renderer/shade.png" style="cursor:default"/></figure>
<p>참고로 간격이 일정해야 하므로 반드시 고정폭 글꼴을 사용해야 한다. 앞서 소개했던 유튜브 영상에서 나오는 큐브처럼 명암을 표현하면 다음과 같다.</p>
<div style="box-shadow:1px 1px 2px 2px rgba(0, 0, 0, 0.1);border-radius:4px;padding:16px;width:80%;margin:0 auto 8px auto"><div style="font-family:monospace;font-size:0;line-height:1.8;text-align:center"></div></div>
<figcaption>마치 상자가 회전하는 것처럼 보인다</figcaption>
<p>위 예제는 필자가 유튜브 영상에 나온 프로그램을 직접 웹에서 실행 가능하도록 구현한 것이다. 빛에 기반한 명암 처리는 아니지만 각 면의 명암이 다르기에 <strong>입체감</strong>을 느낄 수 있다. 이제 이를 구현하기 위해 필요한 지식을 알아보자.</p>
<h1 id="3d-좌표를-2d-좌표로"><a href="#3d-좌표를-2d-좌표로">3D 좌표를 2D 좌표로</a></h1>
<p>우리가 표현하고자 하는 물체는 3D 공간에 존재하지만 모니터 스크린은 2D 공간이다. 따라서 이를 표  현하기 위해서는 <strong>값으로 정의된 3D 공간을 모니터 스크린인 2D 공간에 보이도록 변환</strong>시킬 필요가 있다. 이런 변환하는 과정을 <strong>렌더링 파이프라인</strong>이라고 한다.</p>
<figure><img src="/images/2024-03-03-ascii-3d-renderer/rendering-pipeline.png" style="cursor:default"/><figcaption>렌더링 파이프라인</figcaption></figure>
<p>이 글에서는 오로지 ASCII를 이용하여 3D 물체를 표현하는 것이 목표이므로 렌더링 파이프라인의 일부만 구현할 것이다. 그렇기 때문에 전체를 자세히 설명하지는 않고 필요한 부분만 설명할 것이다. 렌더링 파이프라인은 크게 보면 세 과정으로 이루어진다.</p>
<ul>
<li>버텍스 처리 (Vertex processing)</li>
<li>래스터화 (Rasterization)</li>
<li>프래그먼트 처리 (Fragment processing)</li>
</ul>
<p>각 과정을 하나씩 살펴보자.</p>
<h2 id="버텍스-처리"><a href="#버텍스-처리">버텍스 처리</a></h2>
<p>3D 공간을 표현하기 위해서는 <strong>3D 공간 좌표</strong>가 필요하다. 3D 공간 좌표는 <strong>데카르트 좌표계</strong>를 사용하여 좌표를 3개의 축 <span><code class="language-text">(x, y, z)</code></span>와 같이 표현한다. 어려운 용어처럼 느껴지지만 그냥 3개의 값으로 좌표를 표현한다고 생각하면 된다.</p>
<figure><img src="/images/2024-03-03-ascii-3d-renderer/cartesian-coordinate-system.png" width="50%" style="cursor:default"/><figcaption>데카르트 좌표계</figcaption></figure>
<p>이렇게 표현된 좌표를 <strong>버텍스</strong><sup>Vertex</sup>라고 부르며 3D 공간에 위치한 &#x27;정점&#x27;을 의미한다. 버텍스 하나로는 물체를 표현할 수 없으므로 버텍스를 모아 물체를 표현한다. 이때 물체를 표현하는 최소 단위를 <strong>폴리곤</strong><sup>Polygon</sup>이라고 부른다. 보통 폴리곤은 특수한 경우<sup><a href="#user-content-fn-2" id="user-content-fnref-2" data-footnote-ref="true" aria-describedby="footnote-label">2</a></sup>를 제외하면 3개의 버텍스로 이루어진 삼각형으로 표현한다. 하필 삼각형인 이유는 면을 구성하기 위해 필요한 최소 단위가 삼각형이며 효율적이기 때문이다.</p>
<figure><img src="/images/2024-03-03-ascii-3d-renderer/low-polygon.jpeg" style="cursor:default"/><figcaption>적은 수의 폴리곤을 사용했기에 각져 보인다 / 버추어 파이터</figcaption></figure>
<p>이렇게 버텍스와 폴리곤으로 구성된 하나의 물체를 <strong>폴리곤 메시</strong><sup>Polygon mesh</sup>라고 부른다. 보통 개발자는 디자이너가 만들어준 3D 모델 파일을 불러와서 폴리곤 메시를 만든다. 3D 모델 파일에는 버텍스와 폴리곤을 포함한 다양한 정보가 담겨있다. 이 정보를 통해 물체를 표현할 수 있다. 이 과정에서 버텍스를 변형하는 과정을 <strong>버텍스 처리</strong><sup>Vertex processing</sup>라고 부른다.</p>
<p>버텍스 처리 단계에서 버텍스에 대한 여러 처리를 할 수 있지만 보통 변환을 처리하는 것이 가장 기본이다. 여기서 말하는 변환이 <strong>3D 공간을 2D 스크린으로 옮기는 핵심</strong>이다. 버텍스 처리 과정에서 변환은 보통 세 단계를 거친다.</p>
<ul>
<li>월드 변환 (World transform)</li>
<li>뷰 변환 (View transform)</li>
<li>투영 변환 (Projection transform)</li>
</ul>
<p>각 변환은 <strong>행렬</strong><sup>Matrix</sup>을 이용하여 처리한다. 이제 각 변환에 대해 알아보자.</p>
<h3 id="월드-변환"><a href="#월드-변환">월드 변환</a></h3>
<p>월드 변환은 <strong>3D 모델 파일에 담겨있는 버텍스를 월드라고 부르는 3D 공간에 배치하는 것</strong>이다. 3D 모델 파일은 자신만의 공간에서 고정된 값을 가지지만 월드에 배치할 위치나 크기, 회전 각도에 따라 새로운 값을 부여해줄 필요가 있다. 모델 좌표를 변경하여 월드에 배치하는 것이기 때문에 모델 변환이라 부르기도 한다.</p>
<figure><img src="/images/2024-03-03-ascii-3d-renderer/world-transform.jpeg" style="cursor:default"/><figcaption>세상 어딘가에 배치하는 것이 월드 변환이다</figcaption></figure>
<p>앞서 설명한 것처럼 좌표 변환은 행렬을 이용하여 처리한다. 이때 변환을 처리하기 위한 행렬은 3차원 좌표를 처리함에도 불구하고 4x4 행렬을 사용한다. 각각 하나씩만 처리한다면 3x3 행렬을 사용해도 문제 없지만 이동, 크기, 회전을 한 번에 처리하기 위해서는 4x4 행렬을 사용해야 한다.<sup><a href="#user-content-fn-3" id="user-content-fnref-3" data-footnote-ref="true" aria-describedby="footnote-label">3</a></sup></p>
<figure><img src="/images/2024-03-03-ascii-3d-renderer/transform-matrix.png" width="70%" style="cursor:default"/><figcaption>좌표 열벡터에 4×4 변환 행렬을 곱하면 변환된 좌표를 얻을 수 있다</figcaption></figure>
<p>이동, 크기, 회전에 대한 행렬이 존재하지만 지금은 우선 그런 것들이 있다는 것만 이해하고 넘어가자. 요약하자면 <strong>버텍스 위치에 대한 열벡터(1×4 행렬)와 각 행렬을 모두 곱하는 것이 월드 변환</strong>이다. 월드 변환을 마치고나면 불러온 모델을 월드에 절대적인 좌표로 배치했다고 볼 수 있다.</p>
<h3 id="뷰-변환"><a href="#뷰-변환">뷰 변환</a></h3>
<p>월드 변환을 통해 절대적인 좌표로 모델을 월드에 배치했지만 아직 스크린에 표현할 수는 없다. 스크린에 표현하기 위해서는 어느 좌표에서 어느 시점으로 물체를 바라보는지 알아야 한다. 그 좌표와 시점을 포함한 것을 카메라라고 부르며 카메라의 위치에 따라 물체가 보이는 모습이 달라질 수 있다. 따라서 카메라의 위치와 방향을 월드에 배치하고 모델의 좌표를 카메라의 위치를 기준으로 변환해야 한다. 이를 관점이라는 의미를 담아 뷰 변환이라 부른다. 카메라 값에 따라 달라지기 때문에 카메라 변환이라고 부르기도 한다.</p>
<p>카메라를 표현하는 값은 세 가지가 있다.</p>
<ul>
<li>카메라 위치 (Eye)</li>
<li>카메라 방향 (Look)</li>
<li>카메라 업 벡터 (Up)</li>
</ul>
<p>카메라 위치는 카메라가 월드에서 어디에 위치하는지를 나타내는 값이다. 카메라 방향은 카메라가 어느 방향을 바라보는지를 나타내는 값이다. 카메라 업 벡터는 카메라가 어느 방향을 위로 할지를 나타내는 값이다. 카메라 업 벡터는 카메라 방향과 수직이어야 한다. 이 세 가지 값은 카메라를 표현하는 좌표계를 구성한다. 이를 카메라 좌표계라고 부른다.</p>
<p>이후에 뷰 변환을 할 때는 카메라 좌표계를 이용하여 <strong>카메라를 기준으로 다른 물체의 좌표를 변환</strong>하게 된다. 따라서 모든 물체에 카메라에 대한 역행렬을 적용하면 된다. 참고로 뷰 변환을 할 때는 아직 원근감을 표현하지 않는다. 원근감을 표현하기 위해서는 투영 변환이 필요하다.</p>
<h3 id="투영-변환"><a href="#투영-변환">투영 변환</a></h3>
<p>앞서 설명한 것처럼 원근감을 표현하기 위해서 투영 변환을 해야한다. 투영 변환은 크게 직교 투영과 원근 투영 두 가지로 나뉘지만 직교 투영은 원근감을 표현하지 않는 방법<sup><a href="#user-content-fn-4" id="user-content-fnref-4" data-footnote-ref="true" aria-describedby="footnote-label">4</a></sup>이기 때문에 원근 투영을 사용한다.</p>
<figure><img src="/images/2024-03-03-ascii-3d-renderer/perspective-projection.jpeg" width="60%" style="cursor:default"/><figcaption>원근 투영</figcaption></figure>
<p>투영 변환 과정을 거치면 3D 공간 좌표를 2D 공간 좌표로 변환했다고 볼 수 있다. 이제 래스터화를 통해 2D 공간 좌표를 픽셀 좌표로 변환해야 한다.</p>
<h2 id="래스터화"><a href="#래스터화">래스터화</a></h2>
<p>버텍스 처리를 통해 3D 공간 좌표를 2D 공간 좌표로 변환했다. 이후에 <strong>2D 공간 좌표를 픽셀 좌표로 변환하는 것을 래스터화</strong>라고 부른다. 래스터화는 2D 공간 좌표를 픽셀 좌표로 변환하는 것이다. 이때 픽셀 좌표는 <strong>정수</strong>로 표현한다. 이는 픽셀이 정수로 표현되기 때문이다. 래스터화는 보통 세 단계를 거친다.</p>
<ul>
<li>뷰포트 변환 (Viewport transform)</li>
<li>클리핑 (Clipping)</li>
<li>삼각형 래스터화 (Triangle rasterization)</li>
</ul>
<p>각 과정을 하나씩 살펴보자.</p>
<h3 id="뷰포트-변환"><a href="#뷰포트-변환">뷰포트 변환</a></h3>
<p>뷰포트 변환은 2D 공간 좌표를 픽셀 좌표로 변환하는 것이다. 이때 픽셀 좌표는 정수로 표현되기 때문에 2D 공간 좌표를 정수로 변환해야 한다. 이를 위해 2D 공간 좌표를 픽셀 좌표로 변환하는 과정을 뷰포트 변환이라고 부른다. 뷰포트 변환은 보통 뷰포트라는 사각형 영역을 정의하고 그 영역 안에 있는 2D 공간 좌표를 픽셀 좌표로 변환한다.</p>
<h3 id="클리핑"><a href="#클리핑">클리핑</a></h3>
<p>클리핑은 뷰포트 변환을 통해 픽셀 좌표로 변환된 좌표가 뷰포트 영역을 벗어나는지 확인하는 과정이다. 만약 벗어난다면 뷰포트 영역 안에 있는 좌표로 변환한다. 이를 통해 뷰포트 영역을 벗어나는 좌표를 제거할 수 있다.</p>
<h3 id="삼각형-래스터화"><a href="#삼각형-래스터화">삼각형 래스터화</a></h3>
<p>삼각형 래스터화는 폴리곤을 픽셀 좌표로 변환하는 것이다. 폴리곤은 보통 삼각형으로 표현되기 때문에 삼각형 래스터화를 통해 폴리곤을 픽셀 좌표로 변환할 수 있다. 삼각형 래스터화는 보통 세 단계를 거친 다.</p>
<ul>
<li>삼각형 분할 (Triangle subdivision)</li>
<li>삼각형 스캔 (Triangle scan)</li>
<li>삼각형 채움 (Triangle fill)</li>
</ul>
<h2 id="프래그먼트-처리"><a href="#프래그먼트-처리">프래그먼트 처리</a></h2>
<p>프래그먼트 처리는 래스터화를 통해 픽셀 좌표로 변환된 좌표를 이용하여 명암을 계산하는 것이다. 명암을 계산하는 방법은 다양하지만 보통 빛과 그림자를 이용하여 명암을 계산한다. 이를 쉐이딩이라고 부른다. 쉐이딩은 보통 세 단계를 거친다.</p>
<ul>
<li>조명 계산 (Lighting calculation)</li>
<li>텍스처 매핑 (Texture mapping)</li>
<li>알파 블렌딩 (Alpha blending)</li>
</ul>
<p>여기서는 ASCII를 렌더링할 것이기 때문에 실제로 질감을 표현하기 위한 텍스처 매핑이나 투명도를 조절하는 알파 블렌딩은 처리하지 않을 것이다. 따라서 명암을 계산하기 위한 조명 계산만 필요하다.</p>
<p>조명 계산은 빛과 그림자를 이용하여 명암을 계산하는 것이다. 이때 빛과 그림자를 계산하기 위해서는 빛의 위치와 방향이 필요하다. 빛의 위치와 방향은 빛을 표현하는 좌표계를 구성한다. 이를 라이트 좌표계라고 부른다. 라이트 좌표계는 카메라 좌표계와 마찬가지로 빛의 위치와 방향을 표현하는 좌표계이다.</p>
<h1 id="구현하기"><a href="#구현하기">구현하기</a></h1>
<h2 id="사전-준비"><a href="#사전-준비">사전 준비</a></h2>
<p>이제 렌더링 파이프라인에 대해 알았으니 ASCII로 3D 물체를 표현하기 위한 렌더링 파이프라인 구현을 해보자. 먼저 CLI 상에서 ASCII로 표현하는 것이기 때문에 몇 가지 제약이 있다.</p>
<ol>
<li>정확한 픽셀 좌표를 이용할 수 없다.</li>
<li>텍스처를 입힐 수 없다.</li>
</ol>
<p>정확한 픽셀 좌표를 알더라도 CLI에서 표현할 수 없기 때문에 문자열 공간에 표현할 수 있는 좌  표로 변환해야 한다. 따라서 뷰포트 변환을 할 때 이를 고려해야 한다. 또한 텍스처를 입힐 수 없기 때문에 명암을 표현할 때 사용할 문자열을 미리 정의할 필요가 있다. 이를 고려하여 구현해야 한다.</p>
<p>우선 크게 로직의 순서는 다음과 같을 것이다.</p>
<ul>
<li>광원과 카메라 위치를 정한다.</li>
<li>3D 모델을 불러온다.</li>
<li>모델의 버텍스에 월드 변환, 뷰 변환, 투영 변환을 한다.</li>
<li>래스터화를 통해 CLI에서 표현할 수 있는 좌표로 변환한다.</li>
<li>광원 위치를 기준으로 명암을 계산한다.</li>
<li>명암에 따른 ASCII 문자를 출력한다.</li>
</ul>
<p>수학 계산이 필요하므로 이에 대한 객체를 먼저 만들어 보자.</p>
<span><div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">class</span> <span class="token class-name">Matrix44</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Vector2</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Vector3</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Vector4</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span></code></pre></div></span>
<p>여기서 자세한 코드는 적지 않지만 각 클래스는 기본적인 더하기 빼기 곱하기 나누기 연산을 포함하여 앞서 설명한 회전 변환, 크기 변환, 이동 변환 등을 처리할 수 있도록 구현한다. 이제 렌더러를 만들어보자. 다음으로 필요한 객체는 다음과 같다.</p>
<span><div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">class</span> <span class="token class-name">Mesh</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Camera</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span></code></pre></div></span>
<p>각각 월드에 배치할 객체와 카메라 객체는 월드 변환과 뷰 변환을 처리할 수 있도록 구현한다.</p>
<h2 id="모델-로더-구현"><a href="#모델-로더-구현">모델 로더 구현</a></h2>
<p>모델 로더는 3D 모델 파일을 불러와서 버텍스와 폴리곤을 추출하는 역할을 한다. 여기서는 <a href="https://en.wikipedia.org/wiki/Wavefront_.obj_file" rel="nofollow noopener noreferrer">obj</a> 확장자를 기준으로 구현할 것이다.</p>
<span><div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">o Cube
v -1.000000 1.000000 1.000000
v -1.000000 -1.000000 1.000000
v -1.000000 1.000000 -1.000000
v -1.000000 -1.000000 -1.000000
v 1.000000 1.000000 1.000000
v 1.000000 -1.000000 1.000000
v 1.000000 1.000000 -1.000000
v 1.000000 -1.000000 -1.000000
f 5 3 1
f 3 8 4
f 7 6 8
f 2 8 6
f 1 4 2
f 5 2 6
f 5 7 3
f 3 7 8
f 7 5 6
f 2 4 8
f 1 3 4
f 5 1 2</code></pre></div></span>
<p><span><code class="language-text">obj</code></span> 확장자는 위와 같이 작성되어 있다 <span><code class="language-text">v</code></span>는 버 텍스를 나타내고 <span><code class="language-text">f</code></span>는 Face element로 버텍스 연결을 통해 나타나는 도형을 뜻한다. 이를 이용하여 모델 로더를 구현해보자.</p>
<span><div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">class</span> <span class="token class-name">Loader</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token function">loadFromFile</span><span class="token punctuation">(</span>file<span class="token operator">:</span> File<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>Polygon<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">></span> <span class="token punctuation">{</span>
    <span class="token comment">/* ... */</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">static</span> <span class="token function">loadFromString</span><span class="token punctuation">(</span><span class="token builtin">string</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> Polygon<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">parseOBJ</span><span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token function">parseOBJ</span><span class="token punctuation">(</span>data<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> Polygon<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> lines <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> vertices<span class="token operator">:</span> Vector3<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> polygons<span class="token operator">:</span> Polygon<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> line <span class="token keyword">of</span> lines<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> parts <span class="token operator">=</span> line<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>parts<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">"v"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        vertices<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>
          <span class="token keyword">new</span> <span class="token class-name">Vector3</span><span class="token punctuation">(</span>
            <span class="token function">parseFloat</span><span class="token punctuation">(</span>parts<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">parseFloat</span><span class="token punctuation">(</span>parts<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">parseFloat</span><span class="token punctuation">(</span>parts<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
          <span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>parts<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">"f"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        polygons<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>
          <span class="token keyword">new</span> <span class="token class-name">Polygon</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
            vertices<span class="token punctuation">[</span><span class="token function">parseInt</span><span class="token punctuation">(</span>parts<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            vertices<span class="token punctuation">[</span><span class="token function">parseInt</span><span class="token punctuation">(</span>parts<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            vertices<span class="token punctuation">[</span><span class="token function">parseInt</span><span class="token punctuation">(</span>parts<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> polygons<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div></span>
<p>위 코드는 <span><code class="language-text">obj</code></span> 내용을 파싱하여 버텍스와 폴리곤을 추출하는 역할을 한다. 코드 내용은 어렵지 않다. 단순히 whitespace를 기준으로 문자열을 나누고 값을 넣어줬을 뿐이다. 그리고 폴리곤 구성은 이미 정리한 버텍스 정보를 이용하여 만들었다.</p>
<h2 id="렌더러-구현"><a href="#렌더러-구현">렌더러 구현</a></h2>
<p>이제 렌더러를 구현해보자. 렌더러는 앞서 설명한 것처럼 다음과 같은 로직으로 구성된다.</p>
<ul>
<li>광원과 카메라 위치를 정한다.</li>
<li>3D 모델을 불러온다.</li>
<li>모델의 버텍스에 월드 변환, 뷰 변환, 투영 변환을 한다.</li>
<li>래스터화를 통해 CLI에서 표현할 수 있는 좌표로 변환한다.</li>
<li>광원 위치를 기준으로 명암을 계산한다.</li>
<li>명암에 따른 ASCII 문자를 출력한다.</li>
</ul>
<span><div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">class</span> <span class="token class-name">Renderer</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> el<span class="token operator">:</span> HTMLElement<span class="token punctuation">;</span>
  <span class="token keyword">private</span> width<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  <span class="token keyword">private</span> height<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  <span class="token keyword">private</span> camera<span class="token operator">:</span> Camera<span class="token punctuation">;</span>
  <span class="token keyword">private</span> frameBuffer<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">private</span> mesh<span class="token operator">:</span> Mesh<span class="token punctuation">;</span>

  <span class="token function">constructor</span><span class="token punctuation">(</span>el<span class="token operator">:</span> HTMLElement<span class="token punctuation">,</span> width<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> height<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> objString<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>el <span class="token operator">=</span> el<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>width <span class="token operator">=</span> width<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>height <span class="token operator">=</span> height<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>mesh <span class="token operator">=</span> Loader<span class="token punctuation">.</span><span class="token function">loadFromString</span><span class="token punctuation">(</span>objString<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>camera <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Camera</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> fps <span class="token operator">=</span> <span class="token number">60</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> interval <span class="token operator">=</span> <span class="token number">1000</span> <span class="token operator">/</span> fps<span class="token punctuation">;</span>
    <span class="token keyword">let</span> then <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> now<span class="token punctuation">;</span>
    <span class="token keyword">let</span> delta<span class="token punctuation">;</span>

    <span class="token keyword">const</span> <span class="token function-variable function">renderFrame</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      now <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      delta <span class="token operator">=</span> now <span class="token operator">-</span> then<span class="token punctuation">;</span>

      <span class="token keyword">if</span> <span class="token punctuation">(</span>delta <span class="token operator">></span> interval<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        then <span class="token operator">=</span> now <span class="token operator">-</span> <span class="token punctuation">(</span>delta <span class="token operator">%</span> interval<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>angle <span class="token operator">+=</span> <span class="token number">0.01</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>angle <span class="token operator">>=</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token number">3.14</span><span class="token punctuation">)</span> <span class="token keyword">this</span><span class="token punctuation">.</span>angle <span class="token operator">-=</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token number">3.14</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>renderFrame<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>renderFrame<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">clearFrameBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">process</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">drawFrameBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">private</span> <span class="token function">clearFrameBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>frameBuffer <span class="token operator">=</span> <span class="token builtin">Array</span><span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token punctuation">{</span> length<span class="token operator">:</span> height <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span>
      <span class="token builtin">Array</span><span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token punctuation">{</span> length<span class="token operator">:</span> width <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token string">" "</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">private</span> <span class="token function">process</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> polygons <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mesh<span class="token punctuation">.</span>polygons<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> polygon <span class="token keyword">of</span> polygons<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> vertices <span class="token operator">=</span> polygon<span class="token punctuation">.</span>vertices<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>vertex<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> v <span class="token operator">=</span> vertex<span class="token punctuation">;</span>
        v <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mesh<span class="token punctuation">.</span><span class="token function">transform</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>
        v <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>camera<span class="token punctuation">.</span><span class="token function">transform</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>
        v <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>camera<span class="token punctuation">.</span><span class="token function">project</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> v<span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">rasterize</span><span class="token punctuation">(</span>vertices<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">private</span> <span class="token function">rasterize</span><span class="token punctuation">(</span>vertices<span class="token operator">:</span> Vector2<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">/* ... */</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">private</span> <span class="token function">drawFrameBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> ascii <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>frameBuffer
      <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span> <span class="token operator">=></span> row<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">"&lt;br />"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>el<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> ascii<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div></span>
<p>위와 같이 구현 후 <span><code class="language-text">run</code></span> 메서드를 호출하면 렌더링이 된다. <span><code class="language-text">run</code></span> 메서드에선 60 프레임을 유지하도록 시간을 계산하여 렌더링한다. 이제 <span><code class="language-text">rasterize</code></span> 메서드를 구현해보자.</p>
<span><div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">private</span> <span class="token function">rasterize</span><span class="token punctuation">(</span><span class="token constant">V1</span><span class="token operator">:</span> Vector3<span class="token punctuation">,</span> <span class="token constant">V2</span><span class="token operator">:</span> Vector3<span class="token punctuation">,</span> <span class="token constant">V3</span><span class="token operator">:</span> Vector3<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> halfWidth <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>width <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> halfHeight <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>height <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> v1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vector2</span><span class="token punctuation">(</span><span class="token constant">V1</span><span class="token punctuation">.</span>x <span class="token operator">*</span> halfWidth <span class="token operator">+</span> halfWidth<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token constant">V1</span><span class="token punctuation">.</span>y <span class="token operator">*</span> halfHeight <span class="token operator">+</span> halfHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> v2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vector2</span><span class="token punctuation">(</span><span class="token constant">V2</span><span class="token punctuation">.</span>x <span class="token operator">*</span> halfWidth <span class="token operator">+</span> halfWidth<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token constant">V2</span><span class="token punctuation">.</span>y <span class="token operator">*</span> halfHeight <span class="token operator">+</span> halfHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> v3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vector2</span><span class="token punctuation">(</span><span class="token constant">V3</span><span class="token punctuation">.</span>x <span class="token operator">*</span> halfWidth <span class="token operator">+</span> halfWidth<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token constant">V3</span><span class="token punctuation">.</span>y <span class="token operator">*</span> halfHeight <span class="token operator">+</span> halfHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> minX <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>v1<span class="token punctuation">.</span>x<span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>v2<span class="token punctuation">.</span>x<span class="token punctuation">,</span> v3<span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> minY <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>v1<span class="token punctuation">.</span>y<span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>v2<span class="token punctuation">.</span>y<span class="token punctuation">,</span> v3<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> maxX <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>width<span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>v1<span class="token punctuation">.</span>x<span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>v2<span class="token punctuation">.</span>x<span class="token punctuation">,</span> v3<span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> maxY <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>height<span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>v1<span class="token punctuation">.</span>y<span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>v2<span class="token punctuation">.</span>y<span class="token punctuation">,</span> v3<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> minY<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> maxY<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> j <span class="token operator">=</span> minX<span class="token punctuation">;</span> j <span class="token operator">&lt;</span> maxX<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">isPointInTriangle</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span> i<span class="token punctuation">,</span> v1<span class="token punctuation">,</span> v2<span class="token punctuation">,</span> v3<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>frameBuffer<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'#'</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div></span>
<p>위 코드를 통해 폴리곤 속 좌표를 래스터화하여 ASCII 문자열을 출력할 수 있다. 다음으로 월드 행렬을 회전시켜 3D라는 것을 인지할 수 있도록 만들어보자.</p>
<span><div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">class</span> <span class="token class-name">Renderer</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> angle<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>

  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>angle <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// ...</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>angle <span class="token operator">+=</span> <span class="token number">0.01</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>angle <span class="token operator">>=</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token number">3.14</span><span class="token punctuation">)</span> <span class="token keyword">this</span><span class="token punctuation">.</span>angle <span class="token operator">-=</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token number">3.14</span><span class="token punctuation">;</span> <span class="token comment">// 다 돌면 다시 0으로</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">private</span> <span class="token function">process</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 메쉬를 회전시킨다.</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>mesh<span class="token punctuation">.</span><span class="token function">rotateX</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>angle<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>mesh<span class="token punctuation">.</span><span class="token function">rotateY</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>angle<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>mesh<span class="token punctuation">.</span><span class="token function">rotateZ</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>angle<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div></span>
<p>위와 같이 메쉬 객체를 회전시키면 3D 물체가 회전하는 것처럼 보인다. 마치 물체가 회전하는 것처럼 보인다.</p>
<p>JavaScript(TypeScript를 빌드)로 구현했기 때문에 웹에서 실행이 가능하다. 결과적으로 다음과 같은 결과물을 웹에서 볼 수 있다.</p>
<div style="box-shadow:1px 1px 2px 2px rgba(0, 0, 0, 0.1);border-radius:4px;padding:16px;width:80%;margin:0 auto 8px auto"><div style="font-size:0;line-height:1;width:100%;font-family:monospace"></div></div>
<figcaption>명암도 잘 구분된다</figcaption>
<h1 id="마치며"><a href="#마치며">마치며</a></h1>
<p>반쯤 재미로 시작한 프로젝트지만 생각보다 구현이 쉽지는 않았다. 게임 개발이 하고 싶어 개발자의 길을 걸었지만 마지막으로 게임 개발과 관련된 공부를 한지도 벌써 10년이 지났다. 그럼에도 불구하고 오랜만에 작업을 하니 재미있었고 다시 머리가 깨어나는 느낌이었다. 역시 학습에서 중요한 것은 평소에 잘 하지 않는 것을 해보는 것, 그리고 그것을 익숙해질 때까지 반복하는 것이라는 것을 다시 한 번 깨달았다. 다음에 기회가 된다면 또 다시 이런 재미있는 프로젝트를 해보고 싶다.</p>
<!-- -->
<section data-footnotes="true" class="footnotes"><h2 class="sr-only" id="footnote-label"><a href="#footnote-label">Footnotes</a></h2>
<ol>
<li id="user-content-fn-1">
<p>엄밀히 따지면 선은 아니다. 픽셀이라는 작은 사각형이 모여 선처럼 보이는 것처럼 ASCII 문자열이 모여 선처럼 보이는 것이다. <a href="#user-content-fnref-1" data-footnote-backref="true" class="data-footnote-backref" aria-label="Back to content">↩</a></p>
</li>
<li id="user-content-fn-2">
<p>3D 모델링 툴은 작업의 편의성을 위해 사각 폴리곤을 제공한다. 이는 후처리 과정에서 삼각 폴리곤으로 변환된다. <a href="#user-content-fnref-2" data-footnote-backref="true" class="data-footnote-backref" aria-label="Back to content">↩</a></p>
</li>
<li id="user-content-fn-3">
<p>이는 <a href="https://ko.wikipedia.org/wiki/%EB%8F%99%EC%B0%A8%EC%A2%8C%ED%91%9C" rel="nofollow noopener noreferrer">동차좌표</a>를 사용했기 때문이다. 이를 이용한 동차좌표계는 3차원 좌표에서 방향성을 추가하여 4차원 좌표로 확장함으로서 3차원 좌표의 회전, 이동, 크기 조절을 한 번에 처리할 수 있다. <a href="#user-content-fnref-3" data-footnote-backref="true" class="data-footnote-backref" aria-label="Back to content">↩</a></p>
</li>
<li id="user-content-fn-4">
<p>따라서 보통 화면에 딱 붙어야하는 UI를 구현할 때 많이 사용한다. <a href="#user-content-fnref-4" data-footnote-backref="true" class="data-footnote-backref" aria-label="Back to content">↩</a></p>
</li>
</ol>
</section></div><div id="page-footer"><div id="tags"><div class="tag">crafting</div><div class="tag">renderer</div><div class="tag">3d</div><div class="tag">ascii</div></div></div><div class="post-bio-container"><div class="avatar"><img src="/images/about/avatar.jpg"/></div><div class="summary"><div>Written by<!-- --> <a class="name" href="/about">@kciter</a></div><div class="description">제가 쓴 글이 당신에게 가치있는 지식이 되기를 바랍니다 / CoBalt. CTO.</div><div class="socials"><a href="https://github.com/kciter" target="_blank" style="margin-right:5px"><i class="fa fa-github" aria-hidden="true"></i></a><a href="https://www.facebook.com/sunhyoup.lee" target="_blank" style="margin-right:5px"><i class="fa fa-facebook" aria-hidden="true"></i></a><a href="https://www.linkedin.com/in/kciter" target="_blank" style="margin-right:5px"><i class="fa fa-linkedin" aria-hidden="true"></i></a><a href="https://twitter.com/kciter" target="_blank" style="margin-right:5px"><i class="fa fa-twitter" aria-hidden="true"></i></a><a href="mailto:kciter@naver.com" target="_blank" style="margin-right:5px"><i class="fa fa-envelope" aria-hidden="true"></i></a><a href="/feed.xml" target="_blank"><i class="fa fa-rss-square" aria-hidden="true"></i></a></div></div></div><div class="special-thanks"><h3>이 글을 후원해주신 고마운 분들</h3><div class="sponsors"><div class="avatars"><a href="https://github.com/seohyeon2222" target="_blank" style="margin-right:4px"><div class="avatar"><img src="https://avatars.githubusercontent.com/u/82202674?v=4" alt="seohyeon2222"/></div></a><a href="https://github.com/ibcylon" target="_blank" style="margin-right:4px"><div class="avatar"><img src="https://avatars.githubusercontent.com/u/25360781?v=4" alt="ibcylon"/></div></a><a href="https://github.com/18-12847" target="_blank" style="margin-right:4px"><div class="avatar"><img src="https://avatars.githubusercontent.com/u/118495919?v=4" alt="18-12847"/></div></a><a href="https://github.com/light8reeze" target="_blank" style="margin-right:4px"><div class="avatar"><img src="https://avatars.githubusercontent.com/u/22555243?v=4" alt="light8reeze"/></div></a><a href="https://github.com/JongtaekChoi" target="_blank" style="margin-right:4px"><div class="avatar"><img src="https://avatars.githubusercontent.com/u/17980230?v=4" alt="TerryChoi"/></div></a><a href="https://github.com/pilgwon" target="_blank" style="margin-right:4px"><div class="avatar"><img src="https://avatars.githubusercontent.com/u/6335605?v=4" alt="pilgwon"/></div></a><a href="https://github.com/shinwonse" target="_blank" style="margin-right:4px"><div class="avatar"><img src="https://avatars.githubusercontent.com/u/62709718?v=4" alt="Wonse Shin"/></div></a></div><iframe src="https://github.com/sponsors/kciter/button" title="Sponsor kciter" style="border:0" class="sponser-button"></iframe></div></div><div id="comments"><div></div></div></div><footer class="footer"><a href="https://github.com/kciter" target="_blank" style="margin-right:5px"><i class="fa fa-github" aria-hidden="true"></i></a><a href="https://www.facebook.com/sunhyoup.lee" target="_blank" style="margin-right:5px"><i class="fa fa-facebook" aria-hidden="true"></i></a><a href="https://www.linkedin.com/in/kciter" target="_blank" style="margin-right:5px"><i class="fa fa-linkedin" aria-hidden="true"></i></a><a href="https://twitter.com/kciter" target="_blank" style="margin-right:5px"><i class="fa fa-twitter" aria-hidden="true"></i></a><a href="mailto:kciter@naver.com" target="_blank" style="margin-right:5px"><i class="fa fa-envelope" aria-hidden="true"></i></a><a href="/feed.xml" target="_blank"><i class="fa fa-rss-square" aria-hidden="true"></i></a><div class="post-date"><a href="/about/">kciter.so | devlog by Lee Sun-Hyoup</a></div></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/posts/ascii-3d-renderer/";/*]]>*/</script><!-- slice-start id="_gatsby-scripts-1" -->
          <script
            id="gatsby-chunk-mapping"
          >
            window.___chunkMapping="{\"app\":[\"/app-721db6843bb82bb6a800.js\"],\"component---src-pages-404-tsx\":[\"/component---src-pages-404-tsx-630877b9427f5f37e19c.js\"],\"component---src-pages-about-tsx\":[\"/component---src-pages-about-tsx-8a56befeed34332adc16.js\"],\"component---src-pages-index-tsx\":[\"/component---src-pages-index-tsx-2f066135ae7c11152be5.js\"],\"component---src-pages-writing-tsx\":[\"/component---src-pages-writing-tsx-6182cd2e1738b0b2b9a4.js\"],\"component---src-posts-2021-02-23-first-post-md\":[\"/component---src-posts-2021-02-23-first-post-md-6935966a587bede3c435.js\"],\"component---src-posts-2021-02-25-about-mongodb-mdx\":[\"/component---src-posts-2021-02-25-about-mongodb-mdx-dc81117b4158fb4f6abd.js\"],\"component---src-posts-2021-02-28-basic-web-hacking-mdx\":[\"/component---src-posts-2021-02-28-basic-web-hacking-mdx-aaa5236e2d256c7a1915.js\"],\"component---src-posts-2021-03-14-effective-atomic-design-mdx\":[\"/component---src-posts-2021-03-14-effective-atomic-design-mdx-9dc81d58f3f86e4be6e7.js\"],\"component---src-posts-2021-03-20-deep-dive-into-datetime-mdx\":[\"/component---src-posts-2021-03-20-deep-dive-into-datetime-mdx-0f44167a767a6619b966.js\"],\"component---src-posts-2022-08-05-programmers-brain-book-report-mdx\":[\"/component---src-posts-2022-08-05-programmers-brain-book-report-mdx-a4dc19c9048cd638ab70.js\"],\"component---src-posts-2022-08-16-polymorphic-react-component-mdx\":[\"/component---src-posts-2022-08-16-polymorphic-react-component-mdx-ef2bbac8260a2ce11bff.js\"],\"component---src-posts-2022-08-31-the-nature-of-software-development-book-report-mdx\":[\"/component---src-posts-2022-08-31-the-nature-of-software-development-book-report-mdx-30a9f99912eb9bfb25b1.js\"],\"component---src-posts-2022-09-08-software-master-book-report-mdx\":[\"/component---src-posts-2022-09-08-software-master-book-report-mdx-29612448119514fba731.js\"],\"component---src-posts-2022-09-18-crafting-esolang-mdx\":[\"/component---src-posts-2022-09-18-crafting-esolang-mdx-1aa28de6f5556dac2143.js\"],\"component---src-posts-2023-05-03-spring-multi-module-architecture-mdx\":[\"/component---src-posts-2023-05-03-spring-multi-module-architecture-mdx-dd84b21edc5a9e15e903.js\"],\"component---src-posts-2023-07-10-effective-work-mdx\":[\"/component---src-posts-2023-07-10-effective-work-mdx-c2f062fbf5f54497299f.js\"],\"component---src-posts-2023-07-17-railway-oriented-programming-mdx\":[\"/component---src-posts-2023-07-17-railway-oriented-programming-mdx-931639eefe475db875f5.js\"],\"component---src-posts-2023-07-24-functional-data-structure-mdx\":[\"/component---src-posts-2023-07-24-functional-data-structure-mdx-f9e428280521a982201e.js\"],\"component---src-posts-2023-11-08-retrace-my-life-mdx\":[\"/component---src-posts-2023-11-08-retrace-my-life-mdx-afe2a0925e0c6b81dece.js\"],\"component---src-posts-2023-12-05-what-is-beautiful-code-mdx\":[\"/component---src-posts-2023-12-05-what-is-beautiful-code-mdx-51babe85c3ec91e0a274.js\"],\"component---src-posts-2023-12-24-developers-learning-and-growth-mdx\":[\"/component---src-posts-2023-12-24-developers-learning-and-growth-mdx-5e82cdaf4b7335b11a6a.js\"],\"component---src-posts-2024-01-21-type-driven-development-mdx\":[\"/component---src-posts-2024-01-21-type-driven-development-mdx-25524e3aa48c2961d731.js\"],\"component---src-posts-2024-01-23-linear-method-mdx\":[\"/component---src-posts-2024-01-23-linear-method-mdx-5faf1713d075a1f5f098.js\"],\"component---src-posts-2024-02-18-render-delegation-react-component-mdx\":[\"/component---src-posts-2024-02-18-render-delegation-react-component-mdx-97e8562d57964508c47e.js\"],\"component---src-posts-2024-03-03-ascii-3-d-renderer-mdx\":[\"/component---src-posts-2024-03-03-ascii-3-d-renderer-mdx-7c10aaf8ad152007b0d9.js\"],\"component---src-posts-2024-03-16-principles-of-debugging-mdx\":[\"/component---src-posts-2024-03-16-principles-of-debugging-mdx-eb1c706655cab67fb1cd.js\"],\"component---src-posts-2024-04-14-encrypted-vault-system-mdx\":[\"/component---src-posts-2024-04-14-encrypted-vault-system-mdx-c3342605bc1c0df2a5a1.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2021-02-23-first-post-md\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2021-02-23-first-post-md-676d4898a71e9cef53c3.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2021-02-25-about-mongodb-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2021-02-25-about-mongodb-mdx-416a4e3b5d0cf39a020b.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2021-02-28-basic-web-hacking-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2021-02-28-basic-web-hacking-mdx-dac8532f9af18c33741b.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2021-03-14-effective-atomic-design-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2021-03-14-effective-atomic-design-mdx-8e5a1d486dec3903aa57.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2021-03-20-deep-dive-into-datetime-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2021-03-20-deep-dive-into-datetime-mdx-9b2deae92c0e6de602ea.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2022-08-05-programmers-brain-book-report-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2022-08-05-programmers-brain-book-report-mdx-9dd0a95f1be6ef0f03a9.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2022-08-16-polymorphic-react-component-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2022-08-16-polymorphic-react-component-mdx-f39e24083e4c23791916.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2022-08-31-the-nature-of-software-development-book-report-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2022-08-31-the-nature-of-software-development-book-report-mdx-43eee23e23c7e3cd88bd.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2022-09-08-software-master-book-report-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2022-09-08-software-master-book-report-mdx-a7568d3f9cd22cb122b4.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2022-09-18-crafting-esolang-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2022-09-18-crafting-esolang-mdx-a07356ce4792c641da21.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2023-05-03-spring-multi-module-architecture-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2023-05-03-spring-multi-module-architecture-mdx-0c818455044c95a68068.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2023-07-10-effective-work-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2023-07-10-effective-work-mdx-fbecf25d78eb20e4c9ef.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2023-07-17-railway-oriented-programming-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2023-07-17-railway-oriented-programming-mdx-c0e08d383d5c04225a67.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2023-07-24-functional-data-structure-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2023-07-24-functional-data-structure-mdx-08dca71ccdcfe6e8437b.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2023-11-08-retrace-my-life-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2023-11-08-retrace-my-life-mdx-c99ffda97c400727290d.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2023-12-05-what-is-beautiful-code-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2023-12-05-what-is-beautiful-code-mdx-8f4813b5119ff3c324f1.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2023-12-24-developers-learning-and-growth-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2023-12-24-developers-learning-and-growth-mdx-a8d88c55c62e17c2165b.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2024-01-21-type-driven-development-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2024-01-21-type-driven-development-mdx-c7d213a76d0214c88b79.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2024-01-23-linear-method-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2024-01-23-linear-method-mdx-d8b93accc365ceb37619.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2024-02-18-render-delegation-react-component-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2024-02-18-render-delegation-react-component-mdx-f21077df34c92d8c552a.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2024-03-03-ascii-3-d-renderer-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2024-03-03-ascii-3-d-renderer-mdx-9d972dbcf09db586c766.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2024-03-16-principles-of-debugging-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2024-03-16-principles-of-debugging-mdx-9036519af27929a73530.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2024-04-14-encrypted-vault-system-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2024-04-14-encrypted-vault-system-mdx-dd02a789c7d252f1c198.js\"]}";
          </script>
        <script>window.___webpackCompilationHash="c45a62d87e42ead6e564";</script><script src="/webpack-runtime-bd5a156bea65263d0d61.js" async></script><script src="/app-721db6843bb82bb6a800.js" async></script><!-- slice-end id="_gatsby-scripts-1" --></body></html>