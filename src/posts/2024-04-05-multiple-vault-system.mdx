---
title: "비밀 관리를 위한 다중 금고 시스템 만들기"
categories: dev
tags: [vault, cipher, security, password]
image: /images/2024-04-05-multiple-vault-system/thumbnail.png
comments: true
draft: true
hide: false
---

import Image from '@components/Image';

요즘은 편한 UX에 힘입어 비밀번호 관리 시스템을 사용하는 사람들이 많다. 대체로 브라우저 혹은 OS에서 제공하는 시스템을 이용하지만 1Password와 같은 애플리케이션을 이용하는 사람도 적지않다. 만약 힙한 것을 좋아하는 사람이라면 오픈소스를 이용하는 경우도 있다.

이런 제품을 사용한다면 편리하니 믿고 사용하지만 `정말 안전한게 맞을까?`라는 의심을 해본 적이 있을 것이다. 이번 글에서는 비밀번호 관리자를 직접 구현해보며 그 원리에 대해 알아볼 것이다.

# 케르크호프스의 원칙

프로그래밍에 쓰이는 암호화 관련 알고리즘은 대부분 공개되어 있다. 알고리즘이 공개되었는데 정말 안전한게 맞는가? 라는 의문이 충분히 들 수 있다. 결론부터 말하자면 안전하다. 이는 케르크호프스의 원칙을 알면 이해할 수 있다.

케르크호프스 혹은 커코프라 불리는 원칙은 Auguste Kerckhoffs가 작성한 글인 군사용 암호 설계 원칙에서 따온 것이다. 한국어 위키백과에 실린 내용은 다음과 같다.

1. 암호체계는 수학적으로는 해독불가능하지 않다고 하더라도, 실질적으로 그래야한다.
2. 암호체계는 비밀에 부쳐질 필요가 없어야만 하며, 적의 손에 떨어지더라도 문제가 없어야 한다.
3. 키는 글로 쓰여지지 않더라도 교환 혹은 보관할 수 있어야 한다. 당사자들의 의지에 의해서 바뀌거나 수정될 수 있어야 한다.
4. 전신에 적용할 수 있어야 한다.
5. 이동이 가능해야하며, 암호 체계의 사용과 기능을 위해 여러 사람의 협력을 필요로 하지 않아야 한다.
6. 마지막으로, 시스템의 활용을 요구하는 여러 상황들이 주어졌을 때, 암호 체계는 이용이 쉬워야 하며, 정신적인 압박감이나 여러 규칙들의 관찰을 필요로 하지 않아야 한다.

이 중 두 번째 `암호체계는 비밀에 부쳐질 필요가 없어야만 하며, 적의 손에 떨어지더라도 문제가 없어야 한다.`가 케르크호프스의 원칙으로 알려졌으며 소프트웨어적으로 표현한다면 암호화 알고리즘이 노출되더라도 안전해야 한다고 할 수 있다. 이 말처럼 이미 HTTPS나 이 글에서 다루는 비밀번호 관리자 시스템 등 많은 영역에서 공개된 암호화 알고리즘을 사용하지만 충분히 안전하다.

알고리즘이 공개되어도 안전할 수 있는 이유는 **비밀 키**에 있다. 이 비밀 키를 다른 사람들이 모른다면 알고리즘이 알려지더라도 암호문을 안전하게 전달할 수 있다. 반대로 이야기하면 비밀 키가 노출되는 것은 치명적이라 할 수 있다.

# 개인 비밀번호 관리자

보통 브라우저나 OS에서 제공하는 비밀번호 관리자 시스템은 사용자 개인을 위해 만들어졌다. 이를 이용하면 어렵게 만든 비밀번호를 외우지 않더라도 쉽게 로그인하는 것이 가능하기에 매우 편리하다. 하지만 쓰면서도 정말 안전하게 맞는지 의심이 들 수 있다. 이번에는 개인 비밀번호 관리자를 만들어보며 그 원리를 알아보자.

## 원리가 무엇인가?

개인 비밀번호 관리자가 어떻게 돌아가는 지 이해하기 위해선 두 가지 개념을 알아야 한다. 바로 **마스터 패스워드**와 **대칭키**다. 이 두 개념은 

마스터 패스워드
대칭키

## E2EE

# 팀 단위 관리

마스터 패스워드
대칭키
비대칭키
하이브리드 암호화

## 영지식 증명

# 마치며

암호라는 것은 모든 것이 공개되는 인터넷 세계에선 필수라고 할 수 있다. 그럼에도 불구하고 필자를 포함한 많은 개발자들이 암호에 대해 잘 알지 못한다. 이 도메인을 전문적으로 다루거나 종사하는 것이 아니라면 모든 것을 다 알아야할 필요는 없겠지만 단순히 패스워드를 해싱하는 수준에서 벗어나 더 넓은 세계를 탐구해보는 것은 좋을 것이다.

참고로 이 글에서 쓰여진 코드는 정말 안전한지 검증된 것은 아니다. 따라서 실제 제품에 반영한다면 충분히 검증하며 구현하는 것을 권장한다. 여기서 사용된 알고리즘은 보편적으로 사용하는 것을 택했으며 더 안전한 방법이 있을 수 있다.