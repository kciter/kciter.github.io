<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 5.13.4"/><meta name="theme-color" content="#ffffff"/><style data-href="/styles.974dea2fd376dd55ba3e.css" data-identity="gatsby-global-css">.command-line-prompt{border-right:1px solid #999;display:block;float:left;font-size:100%;letter-spacing:-1px;margin-right:1em;pointer-events:none;text-align:right;-webkit-user-select:none;user-select:none}.command-line-prompt>span:before{opacity:.7}.command-line-prompt>span[data-continuation-prompt]:before{content:attr(data-continuation-prompt)}.command-line span.token.output{opacity:.7}code[class*=language-],pre[class*=language-]{color:#5c6e74;direction:ltr;font-family:Source Code Pro,monospace;font-size:13px;-webkit-hyphens:none;hyphens:none;line-height:1.5;tab-size:4;text-align:left;text-shadow:none;white-space:pre;word-break:normal;word-spacing:normal}code[class*=language-]::mozselection,code[class*=language-]::selection,pre[class*=language-]::mozselection,pre[class*=language-]::selection{background:#b3d4fc;text-shadow:none}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{background:#fff;margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-]{background:#f9f2f4;border-radius:3px;color:#db4c69;padding:.25em .5em;position:relative;top:-1px;white-space:normal}.namespace{opacity:.7}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#93a1a1}.token.punctuation{color:#999}.token.boolean,.token.constant,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{color:#a67f59}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}pre[data-line]{position:relative}pre[class*=language-]>code[class*=language-]{position:relative;z-index:1}.line-highlight{background:#f7efda;box-shadow:inset 5px 0 0 #87d8ff;left:0;line-height:inherit;margin-top:1em;padding-bottom:inherit;padding-left:0;padding-right:0;padding-top:inherit;pointer-events:none;position:absolute;right:0;white-space:pre;z-index:0}.command-line-prompt>span:before{color:#999;content:" ";display:block;padding-right:.8em}.command-line-prompt>span[data-user]:before{content:"[" attr(data-user) "@" attr(data-host) "] $"}.command-line-prompt>span[data-user=root]:before{content:"[" attr(data-user) "@" attr(data-host) "] #"}.command-line-prompt>span[data-prompt]:before{content:attr(data-prompt)}.gatsby-highlight pre{float:left;min-width:100%}.gatsby-highlight{background-color:#fff;border-radius:.3em;box-shadow:0 5px 20px rgba(0,0,0,.12);margin:32px auto;overflow:auto;padding:1em}.gatsby-highlight pre[class*=language-]{background-color:transparent;float:left;margin:0;min-width:100%;overflow:initial;padding:0}.gatsby-highlight-code-line{background:#fffbdd;border-left:.25em solid #87d8ff;display:block;margin-left:-1em;margin-right:-1em;padding-left:.75em;padding-right:1em}h1{border-bottom:1px solid #eee;font-size:2rem;padding-bottom:12px}h1 a{text-decoration:none}h2{border-bottom:1px solid #eee;font-size:1.6em;padding-bottom:8px}h3{font-size:1.3em}h3,h4{margin:8px 0}h4{font-size:1.2em}h1,h2,h3,h4,h5,h6{color:#454f5b;margin-top:48px}h1 a,h2 a,h3 a,h4 a,h5 a,h6 a{color:#454f5b!important;text-decoration:none}a{color:#454f5b;text-decoration:underline}a:hover{border-bottom:none;color:#000}img,video{border-radius:5px;height:auto;max-width:100%}blockquote{background-color:#eee;border-left:.25em solid #ccc;color:#454f5b;line-height:1.5;margin:10px 0;padding:8px 16px}hr{border-top:1px solid #ccc}.thumbnail-container{border-radius:8px;box-shadow:0 0 10px 2px rgba(0,0,0,.05);margin-bottom:25px;max-width:100%}.thumbnail-container a,.thumbnail-container img{display:block;object-fit:cover;width:100%}.post-container{line-height:1.75rem;position:relative}.post-content a{color:#5c6ac4;text-decoration:none}.post-content a:hover{text-decoration:underline}.post-content a.footnote-ref,.post-content a[data-footnote-ref]{color:#ff6f00}.post-content>p:first-letter{margin-left:.3em}.post-content ul{word-break:break-all}@media (max-width:30em){.post-content ul{list-style-position:outside;padding-left:24px}.post-content li>ul{list-style-position:outside;padding-left:12px}}sup{font-weight:400;position:relative;top:-.5em;vertical-align:top}.post-title{border:none;line-height:1.2;margin:0;padding:0}.post-date{color:#9a9a9a;display:block;font-family:Quattrocento Sans,sans-serif;font-size:.8rem;margin-bottom:1rem;margin-top:3px}@media (max-width:30rem){.posts h1{font-size:1.5rem}}figure{margin:24px 40px;text-align:center}@media (max-width:30em){figure{margin:24px 0}}figcaption{color:#637381;font-size:12px;text-align:center}.series{left:-20px;max-width:320px;position:absolute;transform:translateX(-100%);width:100%}.series h4{margin:0;padding:0}.series ul{margin:0 0 8px;max-width:320px;padding:0;width:100%}.series li{list-style:none;margin:0;padding:0}.series li ul{border-left:1px solid #dfe3e8;margin-left:16px}.series a{border-radius:4px;color:#454f5b;display:block;font-size:14px;font-weight:400;line-height:20px;margin-left:6px;padding:8px 12px;text-decoration:none;word-break:keep-all}.series a:hover{background-color:#f4f6f8;color:#212b36}@media (max-width:1400px){.series{display:none}}.footnotes{border-top:1px solid #eee;font-size:12px;margin-top:48px}.footnotes ol{line-height:16px;padding-left:16px}.footnotes ol li{margin-top:8px;padding-left:4px}.footnotes ol p{margin:0}.footnotes ol li::marker{color:#ff6f00}.footnotes ol li .footnote-backref{margin-left:5px}table{border-collapse:collapse;margin-bottom:30px;width:100%}table,td,th{border:1px solid #888}td,th{padding:8px;text-align:left}.sharing-icons a{padding-right:10px}.fa-envelope{padding:5px;transition:.5s}.fa-envelope:hover{color:#f39c12}.fa-twitter{padding:5px;transition:color .5s}.fa-twitter:hover{color:#00aced}.fa-instagram{padding:5px;transition:color .5s}.fa-instagram:hover{color:#375989}.fa-github{padding:5px;transition:color .5s}.fa-github:hover{color:#343434}.fa-linkedin{padding:5px;transition:color .5s}.fa-linkedin:hover{color:#0073a4}.fa-facebook{padding:5px;transition:color .5s}.fa-facebook:hover{color:#3d5b99}.fa-google-plus{padding:5px;transition:color .5s}.fa-google-plus:hover{color:#e64a41}.fa-pinterest{padding:5px;transition:color .5s}.fa-pinterest:hover{color:#bd081c}.fa-medium{padding:5px;transition:color .5s}.fa-medium:hover{color:#00ab6c}.fa-codepen{padding:5px;transition:color .5s}.fa-codepen:hover{color:#000}.fa-rss-square{padding:5px;transition:color .5s}.fa-rss-square:hover{color:#f60}[data-tooltip]{position:relative}[data-tooltip]:after{word-wrap:break-word;background-color:#212b36;border-left:6px solid #ff6f00;border-radius:2px;box-shadow:1px 2px 6px rgba(0,0,0,.3);color:#fff;content:attr(data-tooltip);display:none;font-size:12px;left:10px;line-height:16px;overflow-wrap:break-word;padding:8px 10px;pointer-events:none;position:absolute;top:0;white-space:nowrap;word-break:break-all;z-index:1000}[data-tooltip]:focus:after,[data-tooltip]:hover:after{display:block}@media (max-width:30em){[data-tooltip]:focus:after,[data-tooltip]:hover:after{display:none}}.member-container{display:flex;padding:24px 0}.member-container .avatar{flex:0 1 160px}.avatar img{border-radius:50%;width:100%}.member-container .summary{flex:1 1;margin-left:32px}.member-container{display:block}.member-container .avatar{display:block;margin:0 auto;max-width:300px;width:50%}.member-container .summary{font-size:12px;margin-left:0;text-align:center}.member-container .summary .name{font-size:28px;font-weight:100;margin-top:18px}.member-container .summary .description{font-weight:100;margin-top:8px}.tiny-header{color:#212b36;font-size:16px;font-weight:700}.gatsby-highlight{padding:0;width:95%}.gatsby-highlight pre[class*=language-]{box-sizing:border-box;padding:16px}@media (max-width:30em){.gatsby-highlight{width:100%}}</style><link rel="icon" href="/favicon-32x32.png?v=8d8fa298b67e447760210d9e8b28e447" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=8d8fa298b67e447760210d9e8b28e447"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=8d8fa298b67e447760210d9e8b28e447"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=8d8fa298b67e447760210d9e8b28e447"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=8d8fa298b67e447760210d9e8b28e447"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=8d8fa298b67e447760210d9e8b28e447"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=8d8fa298b67e447760210d9e8b28e447"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=8d8fa298b67e447760210d9e8b28e447"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=8d8fa298b67e447760210d9e8b28e447"/><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= 'https://www.googletagmanager.com/gtm.js?id='+i+dl+'';f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer', 'G-7M8K7EBEDX');</script><link rel="alternate" type="application/rss+xml" title="kciter.so" href="/feed.xml"/></head><body><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=G-7M8K7EBEDX" height="0" width="0" style="display: none; visibility: hidden" aria-hidden="true"></iframe></noscript><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><p>블로그를 시작한 김에 대충 알아보고 넘길만한 것들을 깊게 알아보기 위한 <span><code class="language-text">Deep Dive into</code></span> 시리즈를 연재하기로 결정했다. 첫 주제로 어떤 걸 고를지 고민하던 중 작년에 대표님이 &#x27;Date &amp; Time 탐구&#x27;란 주제로 사내 발표를 해주셨던 내용이 생각났다. 이번 포스트에서는 그 내용에 개인적인 호기심을 조금 더 보충하여 정리하기로 했다.</p>
<h2 id="시간은-어떻게-결정되는가"><a href="#시간은-어떻게-결정되는가">시간은 어떻게 결정되는가?</a></h2>
<p>컴퓨터 세계에 존재하는 것들은 거의 대부분 현실에 있는 것을 전산화 한 것이라 볼 수 있다. 마찬가지로 DateTime은 <strong>현실의 시간을 전산화</strong> 한 것이다. 그렇기 때문에 먼저 현실에서 시간이란 개념이 어떻게 표현되는지 알아야 할 필요가 있다. 시간은 다음 여섯 가지 조건에 의해 정해진다.</p>
<ul>
<li><strong>물리량</strong>
<ul>
<li>시간은 물리학 관점에서 봤을 때 시각과 시각 사이의 간격을 표현하는 단위를 뜻한다.</li>
<li>ex) 지금 이 순간(Instant)은 빅뱅(Epoch) 이후 시간이 얼마나 흘렀나?</li>
</ul>
</li>
<li><strong>위치</strong>
<ul>
<li>시간은 위치에 따라 다르게 표현될 수 있다.</li>
<li>ex) 경도 0도(UTC)가 정오일 때 동경 135도의 시각은? (경도상 위치)</li>
<li>ex) 런던이 정오일 때 프랑스의 시각은? (국가, 지역)</li>
</ul>
</li>
<li><strong>천문 현상</strong>
<ul>
<li>지구자전속도의 불규칙성, 지구의 자전주기와 공전주기 등 천문 현상으로 인해 시간은 보정이 필요하다.</li>
<li>ex) 윤초, 윤달, 윤년</li>
</ul>
</li>
<li><strong>문화</strong>
<ul>
<li>문화에 따라 시간 표현이 다를 수 있다.</li>
<li>ex) 태양력, 태음력, 이슬람력, 에티오피아력 등</li>
</ul>
</li>
<li><strong>역사</strong>
<ul>
<li>역사적 사건에 의해 시간은 다르게 표현될 수 있다.</li>
<li>ex) 1582년 10월 4일의 다음 날은?</li>
</ul>
</li>
<li><strong>사회</strong>
<ul>
<li>사회적 제도에 의해 시간은 변할 수 있다.</li>
<li>ex) 일광 시간 절약제(Summer Time)</li>
</ul>
</li>
</ul>
<p>보다시피 우리는 꽤 많은 조건을 고려하여 시간을 표시해야 한다. 물리량과 위치, 천문 현상은 그렇다 치더라도 역사적 사건, 사회적 제도같이 규칙이 존재하지 않는 경우도 존재하기에 단순히 수학식만으론 시간을 정확히 구할 수 없다. 게다가 문화에 따라 시간을 표현하는 방법이 다를 수 있다는 점도 골치아프다.</p>
<p>그렇기에 통일된 시간 표기법을 위한 <a href="https://ko.wikipedia.org/wiki/%ED%98%91%EC%A0%95_%EC%84%B8%EA%B3%84%EC%8B%9C" rel="nofollow noopener noreferrer">협정 세계시</a>가 탄생했다. UTC는 <a href="https://ko.wikipedia.org/wiki/%EA%B5%AD%EC%A0%9C%EC%9B%90%EC%9E%90%EC%8B%9C" rel="nofollow noopener noreferrer">원자 시계</a>와 윤초 보정을 기반으로 표준화한 시각으로 모든 시간대는 UTC+0을 기준으로 환산한다. 예를 들어, 대한민국의 시간은 UTC 시간에 +9를 더한 시간으로 영국 시간이 오전 1시라면 대한민국은 오전 10시<sup><a href="#user-content-fn-1" id="user-content-fnref-1" data-footnote-ref="true" aria-describedby="footnote-label">1</a></sup>가 된다. UTC는 <a href="https://ko.wikipedia.org/wiki/ISO_8601" rel="nofollow noopener noreferrer">ISO 8601</a>을 따라 다음과 같은 표기법을 따른다.</p>
<span><div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">// UTC+0 기준 2021년 3월 20일 9시
2021-03-20T09:00:00.000Z

// UTC+9 (한국 시간) 기준 2021년 3월 20일 9시
2021-03-20T09:00:00.000+09:00</code></pre></div></span>
<p>가운데 <span><code class="language-text">T</code></span>는 Time을 뜻하고 시간 뒤 <span><code class="language-text">Z</code></span>는 Zulu time<sup><a href="#user-content-fn-2" id="user-content-fnref-2" data-footnote-ref="true" aria-describedby="footnote-label">2</a></sup> 을 뜻한다.</p>
<figure><img src="/images/2021-03-20-deep-dive-into-datetime/utc.png" style="cursor:default"/><figcaption>국가마다 시간대가 다르다</figcaption></figure>
<p>참고로 국가, 지역마다 경도상 시간과 국가 시간이 다를 수 있다. 아이슬란드의 경우 경도상 위치는 UTC-1이지만 UTC+0을 사용하고 있다.</p>
<h2 id="컴퓨터가-시간을-표현하는-방법"><a href="#컴퓨터가-시간을-표현하는-방법">컴퓨터가 시간을 표현하는 방법</a></h2>
<p>컴퓨터는 시간을 표시하기 위해 하드웨어의 시스템 클럭을 이용한다. 주로 특정 시간(Epoch)를 기준으로 시스템 클럭의 틱을 세는 것으로 구현되고 이를 <strong>시스템 시간</strong>이라고 부른다. 그리고 시스템 시간을 값으로 표현한 것을 <strong>Timestamp</strong>라고 부른다. 주의할 점으로 Timestamp는 운영체제마다 기준 시간과 단위가 다를 수 있다. 대표적으로 유닉스에선 1970년 1월 1일 00:00:00이 기준 시간이며 초 단위로 시간이 증가하지만 윈도우즈는 1601년 1월 1일 00:00:00이 기준 시간이며 100 나노초 단위로 증가한다.</p>
<p>유닉스 계열 운영체제에서 시간을 표시하는 방법을 <a href="https://ko.wikipedia.org/wiki/%EC%9C%A0%EB%8B%89%EC%8A%A4_%EC%8B%9C%EA%B0%84" rel="nofollow noopener noreferrer">Unix time</a>이라 부른다. 내용을 보면 몇 가지 의문이 생길 수 있다.</p>
<ul>
<li>1970년 이전 시간은 어떻게 표현할까?</li>
<li>왜 하필 &#x27;1970년 1월 1일&#x27;일까?</li>
<li>현재 시간을 어떻게 알지?</li>
<li>시간대는 어떻게 고려할까?</li>
</ul>
<p>충분히 의문을 품을 수 있는 내용들이다. 하나씩 파해쳐보  자.</p>
<h3 id="1970년-이전-시간은-어떻게-표현할까"><a href="#1970년-이전-시간은-어떻게-표현할까">1970년 이전 시간은 어떻게 표현할까?</a></h3>
<figure><img src="/images/2021-03-20-deep-dive-into-datetime/negative-timestamp.png" style="cursor:default"/><figcaption>-1616254565은 1918년 10월 14일이다</figcaption></figure>
<p>이 의문은 굉장히 쉽게 풀린다. 답은 &#x27;음수&#x27;를 사용하는 것이다. <a href="https://www.epochconverter.com/" rel="nofollow noopener noreferrer">EpochConverter</a>라는 사이트에서 음수 값을 넣어 확인해보자.</p>
<h3 id="왜-하필-1970년-1월-1일일까"><a href="#왜-하필-1970년-1월-1일일까">왜 하필 &#x27;1970년 1월 1일&#x27;일까?</a></h3>
<p>사실 필자는 이유를 알기위해 많은 리서치를 했지만 딱히 명쾌한 이유은 없었다. 단지 <a href="https://stackoverflow.com/questions/24472979/what-is-so-special-about-unix-time/24472994#24472994" rel="nofollow noopener noreferrer">Stack Overflow 글 하나</a>를 통해 유닉스를 개발한 데니스 리치의 인터뷰 기사를 하나 발견했는데 이를 통해 알아낸 이유는 다음과 같다.</p>
<blockquote>
<p>&quot;At the time we didn&#x27;t have tapes and we had a couple of file-systems running and we kept changing the origin of time. So finally we said, &#x27;Let&#x27;s pick one thing that&#x27;s not going to overflow for a while.&#x27; <strong>1970 seemed to be as good as any.</strong>&quot; - Dennis Ritchie</p>
</blockquote>
<p>핵심만 해석하면 &quot;그냥 1970년이 좋아 보였다&quot;로 요약할 수 있다. 즉, 정리하자면 1970년 1월 1일인 이유에 별다른 이유는 없다.</p>
<h3 id="현재-시간을-어떻게-알지"><a href="#현재-시간을-어떻게-알지">현재 시간을 어떻게 알지?</a></h3>
<p>시스템 시간은 <a href="https://www.ntp.org/" rel="nofollow noopener noreferrer">네트워크 타임 프로토콜(NTP)</a>를 통해 현재 시간을 동기화할 수   있다. 당연하지만 네트워크 연결이 되어야하며 UDP 123번 포트를 통해 통신한다. NTP 서버는 <a href="https://gist.github.com/mutin-sa/eea1c396b1e610a2da1e5550d94b0453" rel="nofollow noopener noreferrer">여러 곳</a>이 존재하며 이 서버가 기준 시간을 만들어낸다.</p>
<p>NTP 서버는 트리 구조로 상위 NTP 서버에서 하위 NTP 서버로 동기화된다. 여기서 계층을 <strong>Stratum</strong>으로 표현하는데 가장 최상위에 해당하는 Stratum 0은 Primary Reference Clock(PRC)이라고도 부르며 정교한 원자 시계를 사용하기에 매우 정밀한 시간을 만들 수 있다. 다음 계층인 Stratum 1은 물리적으로 Stratum 0과 동기화되며 기준 시간을 만드는 1차 타임 서버가 된다. 이후 Stratum 2 ~ 15에 해당하는 서버들은 상위 Stratum과 동기화되며 낮은 계층일수록 정밀도가 떨어진다.</p>
<p>NTP 클라이언트는 NTP 서버를 주기적으로 Polling 하는데 클라이언트는 서버에서 받아온 데이터를 보정해야 한다. 이를 해결하기 위한 <a href="https://en.wikipedia.org/wiki/Network_Time_Protocol#Clock_synchronization_algorithm" rel="nofollow noopener noreferrer">식</a>은 다음과 같다.</p>
<span><div class="gatsby-highlight" data-language="c"><pre class="language-c"><code class="language-c"><span class="token comment">// 왕복 지연(d)와 클럭 오프셋(c)을 계산한다.</span>
d <span class="token operator">=</span> <span class="token punctuation">(</span>t2 <span class="token operator">-</span> t3<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token punctuation">(</span>t1 <span class="token operator">-</span> t0<span class="token punctuation">)</span><span class="token punctuation">;</span>
c <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>t2 <span class="token operator">-</span> t3<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>t1 <span class="token operator">-</span> t0<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>

<span class="token comment">// t0는 클라이언트가 서버로 요청 보낸 시점의 Timestamp다.</span>
<span class="token comment">// t1은 서버가 클라이언트에게 요청 받은시점의 Timestamp다.</span>
<span class="token comment">// t2는 서버가 클라이언트에게 응답하는 시점의 Timestamp다.</span>
<span class="token comment">// t3는 클라이언트가 서버로부터 응답받은 시점의 Timestamp다.</span></code></pre></div></span>
<p>위 식을 통해 클라이언트는 네트워크 지연 시간과 응답 받은 시점의 클럭 오프셋을 보정할 수 있다. 이때 통신 왕복 시간이 대칭적<sup><a href="#user-content-fn-3" id="user-content-fnref-3" data-footnote-ref="true" aria-describedby="footnote-label">3</a></sup>일 때 정확한 동기화가 이루어진다. 만약 통신 왕복 시간이 대칭적이지 않은 경우엔 <span><code class="language-text">송수신 시간의 차 / 2</code></span>만큼 <a href="https://en.wikipedia.org/wiki/Observational_error" rel="nofollow noopener noreferrer">Systematic bias</a>가 발생한다고 한다. 혹시라도 해당 로직에 대한 구현이 궁금하다면 <a href="https://github.com/ntp-project/ntp/blob/master-no-authorname/ntpdate/ntpdate.c" rel="nofollow noopener noreferrer">링크</a>를 확인해보자.</p>
<p>참고로 우리가 주로 사용하는 리눅스에선 <span><code class="language-text">rdate</code></span>를 통해 시간 동기화를 할 수 있다. 요즘은 거의 대부분 클라우드 시스템을 사용하기에 직접 설정할 일은 거의 없긴하다.</p>
<h3 id="time-zone"><a href="#time-zone">Time Zone</a></h3>
<p>그렇다면 국가, 지역에 따른 시간 표시는 어떻게 할까? 앞서 설명했듯이 국가, 지역은 경도를 따르지 않고 시간대를 지정한 경우도 있다. 거기에 프랑스<sup><a href="#user-content-fn-4" id="user-content-fnref-4" data-footnote-ref="true" aria-describedby="footnote-label">4</a></sup>나 러시아, 미국처럼 시간대가 여러 개거나 정책에 따라 <a href="https://ko.wikipedia.org/wiki/%ED%8F%89%EC%96%91%EC%8B%9C%EA%B0%84" rel="nofollow noopener noreferrer">바뀔 수 있기에</a> 초기 설정만으론 문제가 생길 수 있다.</p>
<p>이를 해결하기 위해 멋진 사람들이 국가, 지역별 시간대 설정을 위한 <a href="https://en.wikipedia.org/wiki/Tz_database" rel="nofollow noopener noreferrer">tz database</a>라는 데이터베이스를 구축했다. 우리는 tz database를 통해 세계 각국의 Time Zone 데이터를 받아와서 국가, 지역별 시간을 설정할 수 있다. Time Zone은 다음처럼 표기할 수 있다.</p>
<span><div class="gatsby-highlight" data-language="c"><pre class="language-c"><code class="language-c"><span class="token comment">// 서울</span>
Asia<span class="token operator">/</span>Seoul

<span class="token comment">// 뉴욕</span>
America<span class="token operator">/</span>New_York

<span class="token comment">// 파리</span>
Europe<span class="token operator">/</span>Paris</code></pre></div></span>
<p>보다시피 <span><code class="language-text">대륙/도시</code></span> 형태를 따른다. 이 값을 Zone Id라고 부른다. 해당 국가, 지역의 정확한 시간을 표기하기 위해선 UTC 시간과 Zone Id를 저장해두고 클라이언트에서 계산하는 것이 가장 좋은 방법이다.</p>
<h2 id="시간을-어떤-기준으로-사용해야-하는가"><a href="#시간을-어떤-기준으로-사용해야-하는가">시간을 어떤 기준으로 사용해야 하는가?</a></h2>
<p>국제화를 고려하지 않아도되는 서비스의 경우 모든 것을 한국 기준으로 시간을 기록한다면 크게 문제될 일은 없다. 하지만 우리가 만약 글로벌 서비스를 준비해야 한다면 가장 중요한 것은 시간이라고 할 수 있다.</p>
<p><strong>&quot;그냥 전부 Time Zone쓰면 되는 것 아닌가요?&quot;</strong></p>
<p>그렇지 않다. 우리는 서비스에서 사용되는 시간을 용도에 맞춰서 기록할 필요가 있다. 하나씩 예시를 살펴보자.</p>
<h3 id="순수한-시간"><a href="#순수한-시간">순수한 시간</a></h3>
<p>뜬금없지만 필자의 생일은 1월 26일이다. 갑자기 생일 이야기를 한 것은 예시에 적합하기 때문이다. 보다시피 보통 생일은 시간대를 고려하지 않고 말한다. 만약 필자가 <strong>&quot;내가 한국에서 1월 26일에 태어났지만 미국 시간으로 따지면 1월 25일에 태어났으니 미국 생일은 1월 25일이야~&quot;</strong>라고 말하고 다닌다면 많은 사람들이 정말 이상한 사람이라고 생각할 것이다.</p>
<p>이처럼 시간대와 지역, 문화, 사회를 고려하지 않고 순수한 시간과 날짜를 사용해야하는 경우가 있다. 좀 더 예를 들어보자면 다음과 같은 사례에 쓰일 수 있다.</p>
<ul>
<li>생일</li>
<li>기업 설립일</li>
<li>기념일</li>
<li>국경일</li>
</ul>
<p>혹은 기록을 위해 시간을 사용하지 않는 경우에도 순수한 시간을 사용할 때가 있다. 보통 벤치마킹을 하기 위해 시간을 사용하거나 유니크한 값을 만들어내기 위해 사용하기도 한다. 혹은 랜덤 값 SEED 용도로 사용될 수도 있다.</p>
<h3 id="utc"><a href="#utc">UTC</a></h3>
<p>역사, 사회, 문화에 대한 맥락 없이 <strong>&#x27;사건이 발생한 시각&#x27;</strong>만을 고려할 땐 UTC를 사용하여 시간을 기록하는 것이 좋다. 가장 대표적인 예시로 <strong>로깅</strong>을 들 수 있다. 로그는 분산되어 저장될 수 있기에 발생한 순서를 쉽게 알기 위해선 UTC처럼 기준이 되는 시간대를 정하는 것이 좋다. 만약 로그가 기록된 시간에 타임존이 적용되어 발생한 곳 마다 다르게 시간이 적용된다면 큰 혼란이 생길 수 있다. 마찬가지로 자주 사용하는 <span><code class="language-text">createdAt</code></span>, <span><code class="language-text">updatedAt</code></span>도 UTC로 기록하는 것이 좋다.</p>
<figure><img src="/images/2021-03-20-deep-dive-into-datetime/stock-chart.png" style="cursor:default"/><figcaption>주식 차트는 대표적인 시계열 데이터다</figcaption></figure>
<p>또 다른 사용 예시로 시계열 데이터를 들 수 있다. 시계열 데이터의 경우 시간에 종속된 연속적인 데이터를 말하는데 UTC처럼 시간대가 정해진 상태로 기록된게 아니라면 언제 저장된 시간 인지 알 수 없어 잘못된 분석으로 이어질 수 있다. 추가로 UTC는 다음과 같은 사례에 쓰일 수 있다.</p>
<ul>
<li>로그</li>
<li>감사</li>
<li>시계열 데이터</li>
<li><span><code class="language-text">createdAt</code></span>, <span><code class="language-text">updatedAt</code></span></li>
</ul>
<h3 id="time-zone이-적용된-시간"><a href="#time-zone이-적용된-시간">Time Zone이 적용된 시간</a></h3>
<p>반면 사용자가 이용한 시각을 정확히 알기위해 Time Zone을 사용해야 할 떄도 있다. 예를 들면, 사용자가 상품을 결제했을 때 UTC 시간만 기록했다면 사용자가 정확히 몇시 몇분 몇초에 주문했는지 알 수가 없다. 이때 정확한 시각을 알기 위해선 데이터베이스에 Zone Id도 함께 기록해야 한다. 또한, UI에 표시되는 시간을 사용자 기준으로 보여주기 위해서도 Time Zone은 필요하다.</p>
<figure><img src="/images/2021-03-20-deep-dive-into-datetime/facebook.png" style="cursor:default"/></figure>
<p>예를 들어, 같은 페이스북 게시물을 보더라도 사는 나라가 다르다면 작성한 시간이 다를 수 있다. 필자가 3월 15일 오후 12시 31분에 작성한 게시물은 영국 사람이 보기엔 새벽 3시 31분에 작성한 것으로 보일 것이고 하와이에 사는 사람이 보기엔 3월 14일 오후 5시 31분에 작성한 것으로 보일 것이다.</p>
<p>그렇기 때문에 글로벌 서비스를 준비한다면 사용자 혹은 사용자가 포함되는 그룹 데이터에 Zone Id 정보를 추가해야 한다. 추가로 Time Zone이 적용된 시간은 다음과 같은 사례에 쓰일 수 있다.</p>
<ul>
<li>결제 시각</li>
<li>푸시 알림 시각</li>
<li>UI 시각 표시</li>
<li>캘린더</li>
</ul>
<p>UI에 내려주는 JSON 데이터 예시는 다음과 같다.</p>
<span><div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token punctuation">{</span>
  <span class="token string-property property">"userId"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token string-property property">"name"</span><span class="token operator">:</span> <span class="token string">"이선협"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"zoneId"</span><span class="token operator">:</span> <span class="token string">"Asia/Seoul"</span><span class="token punctuation">,</span> <span class="token comment">// Time Zone을 위한 Zone Id</span>
  <span class="token string-property property">"birthdate"</span><span class="token operator">:</span> <span class="token string">"1994-01-26"</span><span class="token punctuation">,</span> <span class="token comment">// 순수한 시간</span>
  <span class="token string-property property">"createdAt"</span><span class="token operator">:</span> <span class="token string">"2021-03-20T04:59:25Z"</span><span class="token punctuation">,</span> <span class="token comment">// 기준 시간 UTC</span>
  <span class="token string-property property">"updatedAt"</span><span class="token operator">:</span> <span class="token string">"2021-03-20T05:12:38Z"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"posts"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token string-property property">"postId"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token string-property property">"publishedAt"</span><span class="token operator">:</span> <span class="token string">"2021-03-20T06:00:00Z"</span><span class="token punctuation">,</span> <span class="token comment">// 기준 시간 오전 6시에 발행됨</span>
      <span class="token comment">// publishedAt은 user의 zondId에 따라 다르게 보일 수 있다.</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span></code></pre></div></span>
<h2 id="마치며"><a href="#마치며">마치며</a></h2>
<p>사실 가볍게 작성하려한 글이지만 <strong>Deep Dive into</strong>라는 주제답게 파다 보니 생각보다 알아야할 내용들이 많았다. 그 모든 내용을 글에 담으려면 끝이 없을 것 같아 어느정도 자른 부분도 꽤 있다. 고작 DateTime을 이해하기 위해 이렇게까지 공부해야 할까라는 의문도 들었고 자료를 조사하고 글을 작성하는 시간을 합쳐 8시간 정도 걸려 할 일이 많음에도 꽤 시간을 많이 빼앗겼다.</p>
<p>하지만 인생이란 어떻게 될지 아무도 모르는 거다. 오늘 시간에 대해 공부한 덕분에 훗날 시스템에 치명적인 <strong>0.1%의 버그</strong>를 수정할 수 있다면 얼마나 멋진 일일까. 우리 모두 매 순간을 소중히 여기는 멋진 개발자가 되기로 하자.</p>
<section data-footnotes="true" class="footnotes"><h2 class="sr-only" id="footnote-label"><a href="#footnote-label">Footnotes</a></h2>
<ol>
<li id="user-content-fn-1">
<p>참고로 한국 표준 시간은 KST라고 부른다 <a href="#user-content-fnref-1" data-footnote-backref="true" class="data-footnote-backref" aria-label="Back to content">↩</a></p>
</li>
<li id="user-content-fn-2">
<p>UTC, GMT, Zulu time 모두 같은 시간대를 나타낸다 <a href="#user-content-fnref-2" data-footnote-backref="true" class="data-footnote-backref" aria-label="Back to content">↩</a></p>
</li>
<li id="user-content-fn-3">
<p>송수신 시간이 같을 때 <a href="#user-content-fnref-3" data-footnote-backref="true" class="data-footnote-backref" aria-label="Back to content">↩</a></p>
</li>
<li id="user-content-fn-4">
<p>프랑스는 무려 12개의 시간대를 가지고 있다 <a href="#user-content-fnref-4" data-footnote-backref="true" class="data-footnote-backref" aria-label="Back to content">↩</a></p>
</li>
</ol>
</section></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/2021-03-20-deep-dive-into-datetime/";/*]]>*/</script><!-- slice-start id="_gatsby-scripts-1" -->
          <script
            id="gatsby-chunk-mapping"
          >
            window.___chunkMapping="{\"app\":[\"/app-b245d27d04ec2e3445c9.js\"],\"component---src-pages-404-tsx\":[\"/component---src-pages-404-tsx-d559859aa3bf46d4ff2f.js\"],\"component---src-pages-about-tsx\":[\"/component---src-pages-about-tsx-ab43e6ef36385f2d4a4f.js\"],\"component---src-pages-bookshelf-tsx\":[\"/component---src-pages-bookshelf-tsx-6a7015941a4810a773a2.js\"],\"component---src-pages-index-tsx\":[\"/component---src-pages-index-tsx-f8664b3d4a700d9732b3.js\"],\"component---src-pages-timeline-tsx\":[\"/component---src-pages-timeline-tsx-a9dfafe33cd6c170690d.js\"],\"component---src-posts-2021-02-23-first-post-md\":[\"/component---src-posts-2021-02-23-first-post-md-cf88179ff9f031ac1ce7.js\"],\"component---src-posts-2021-02-25-about-mongodb-mdx\":[\"/component---src-posts-2021-02-25-about-mongodb-mdx-bacd90a1b6d492726dc4.js\"],\"component---src-posts-2021-02-28-basic-web-hacking-mdx\":[\"/component---src-posts-2021-02-28-basic-web-hacking-mdx-44ccd86beda85b90682f.js\"],\"component---src-posts-2021-03-14-effective-atomic-design-mdx\":[\"/component---src-posts-2021-03-14-effective-atomic-design-mdx-d0495bf7ad2a1d787558.js\"],\"component---src-posts-2021-03-20-deep-dive-into-datetime-mdx\":[\"/component---src-posts-2021-03-20-deep-dive-into-datetime-mdx-5fd67cbc4366f0d69789.js\"],\"component---src-posts-2022-08-05-programmers-brain-book-report-mdx\":[\"/component---src-posts-2022-08-05-programmers-brain-book-report-mdx-5f364d76bd9f44fe27dd.js\"],\"component---src-posts-2022-08-16-polymorphic-react-component-mdx\":[\"/component---src-posts-2022-08-16-polymorphic-react-component-mdx-d5bff2c633c134a54e14.js\"],\"component---src-posts-2022-08-31-the-nature-of-software-development-book-report-mdx\":[\"/component---src-posts-2022-08-31-the-nature-of-software-development-book-report-mdx-690feff069e38ebb44a9.js\"],\"component---src-posts-2022-09-08-software-master-book-report-mdx\":[\"/component---src-posts-2022-09-08-software-master-book-report-mdx-9a1bda03a5053e263eeb.js\"],\"component---src-posts-2022-09-18-crafting-esolang-mdx\":[\"/component---src-posts-2022-09-18-crafting-esolang-mdx-debf9e0c04a4cb9baa64.js\"],\"component---src-posts-2023-05-03-spring-multi-module-architecture-mdx\":[\"/component---src-posts-2023-05-03-spring-multi-module-architecture-mdx-f20420ea6519c326f751.js\"],\"component---src-posts-2023-07-10-effective-work-mdx\":[\"/component---src-posts-2023-07-10-effective-work-mdx-f54884ddf598bb842615.js\"],\"component---src-posts-2023-07-17-railway-oriented-programming-mdx\":[\"/component---src-posts-2023-07-17-railway-oriented-programming-mdx-af9c01cdadb4f98bc5ca.js\"],\"component---src-posts-2023-07-24-functional-data-structure-mdx\":[\"/component---src-posts-2023-07-24-functional-data-structure-mdx-fcb4219443c9eb6715c7.js\"],\"component---src-posts-2023-11-08-retrace-my-life-mdx\":[\"/component---src-posts-2023-11-08-retrace-my-life-mdx-bfd9933cdc0d34b98b1f.js\"],\"component---src-posts-2023-12-05-what-is-beautiful-code-mdx\":[\"/component---src-posts-2023-12-05-what-is-beautiful-code-mdx-e88869fe200b84883e97.js\"],\"component---src-posts-2023-12-24-developers-learning-and-growth-mdx\":[\"/component---src-posts-2023-12-24-developers-learning-and-growth-mdx-bb0a95888858b249aaf5.js\"],\"component---src-posts-2024-01-21-type-driven-development-mdx\":[\"/component---src-posts-2024-01-21-type-driven-development-mdx-329ddcb6f84db5b0f40b.js\"],\"component---src-posts-2024-01-23-linear-method-mdx\":[\"/component---src-posts-2024-01-23-linear-method-mdx-7399776291a251b17bad.js\"],\"component---src-posts-2024-02-18-render-delegation-react-component-mdx\":[\"/component---src-posts-2024-02-18-render-delegation-react-component-mdx-31c0bee0bd7f41de586c.js\"],\"component---src-posts-2024-03-03-ascii-3-d-renderer-mdx\":[\"/component---src-posts-2024-03-03-ascii-3-d-renderer-mdx-25627e37e4e3cbfff08e.js\"],\"component---src-posts-2024-03-16-principles-of-debugging-mdx\":[\"/component---src-posts-2024-03-16-principles-of-debugging-mdx-4cd41a1b00c0e85b9125.js\"],\"component---src-posts-2024-04-14-encrypted-vault-system-mdx\":[\"/component---src-posts-2024-04-14-encrypted-vault-system-mdx-ac29611cb590fd1ba729.js\"],\"component---src-posts-2024-04-26-living-with-ai-mdx\":[\"/component---src-posts-2024-04-26-living-with-ai-mdx-fa5fe1e661adb1e3da23.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2021-02-23-first-post-md\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2021-02-23-first-post-md-8cd51f52b3e71bc13b82.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2021-02-25-about-mongodb-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2021-02-25-about-mongodb-mdx-9fdaf0ee9cf578e25ad1.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2021-02-28-basic-web-hacking-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2021-02-28-basic-web-hacking-mdx-6c5cf4b7b32703eea14a.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2021-03-14-effective-atomic-design-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2021-03-14-effective-atomic-design-mdx-41473955265961d72846.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2021-03-20-deep-dive-into-datetime-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2021-03-20-deep-dive-into-datetime-mdx-c6954ab13a38429973c6.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2022-08-05-programmers-brain-book-report-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2022-08-05-programmers-brain-book-report-mdx-778e9e89e96139e30f1e.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2022-08-16-polymorphic-react-component-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2022-08-16-polymorphic-react-component-mdx-0472fe8f505f47bd32e5.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2022-08-31-the-nature-of-software-development-book-report-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2022-08-31-the-nature-of-software-development-book-report-mdx-4081dd5e63156c302a82.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2022-09-08-software-master-book-report-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2022-09-08-software-master-book-report-mdx-a71cb6de4800b5d9545a.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2022-09-18-crafting-esolang-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2022-09-18-crafting-esolang-mdx-7da9479f1db355dee119.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2023-05-03-spring-multi-module-architecture-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2023-05-03-spring-multi-module-architecture-mdx-596153af11a290edbeee.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2023-07-10-effective-work-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2023-07-10-effective-work-mdx-0b4b09deee753a368c85.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2023-07-17-railway-oriented-programming-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2023-07-17-railway-oriented-programming-mdx-46e062fcea2f4bda1eff.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2023-07-24-functional-data-structure-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2023-07-24-functional-data-structure-mdx-5c33441c571d39850d84.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2023-11-08-retrace-my-life-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2023-11-08-retrace-my-life-mdx-9fc90c0ac4c50545b433.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2023-12-05-what-is-beautiful-code-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2023-12-05-what-is-beautiful-code-mdx-1fb81f369752dc0c180d.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2023-12-24-developers-learning-and-growth-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2023-12-24-developers-learning-and-growth-mdx-753ad2fefbf6e6b189cc.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2024-01-21-type-driven-development-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2024-01-21-type-driven-development-mdx-ee65f2f2b0ffc064eddf.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2024-01-23-linear-method-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2024-01-23-linear-method-mdx-68b1b70099fce29a3cff.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2024-02-18-render-delegation-react-component-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2024-02-18-render-delegation-react-component-mdx-1ba529d9bf1886b77c89.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2024-03-03-ascii-3-d-renderer-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2024-03-03-ascii-3-d-renderer-mdx-33bf56c8d57cd2caff28.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2024-03-16-principles-of-debugging-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2024-03-16-principles-of-debugging-mdx-d144522e3f683b90bab0.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2024-04-14-encrypted-vault-system-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2024-04-14-encrypted-vault-system-mdx-31debd95fb154f20ed43.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2024-04-26-living-with-ai-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2024-04-26-living-with-ai-mdx-d985e837358dcec70c14.js\"]}";
          </script>
        <script>window.___webpackCompilationHash="a65a4a914253747c8746";</script><script src="/webpack-runtime-c654684c5506d3ea736f.js" async></script><script src="/app-b245d27d04ec2e3445c9.js" async></script><!-- slice-end id="_gatsby-scripts-1" --></body></html>