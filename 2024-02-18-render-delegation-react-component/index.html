<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 5.13.4"/><meta name="theme-color" content="#ffffff"/><style data-href="/styles.ee3099c5e640503dd61e.css" data-identity="gatsby-global-css">.command-line-prompt{border-right:1px solid #999;display:block;float:left;font-size:100%;letter-spacing:-1px;margin-right:1em;pointer-events:none;text-align:right;-webkit-user-select:none;user-select:none}.command-line-prompt>span:before{opacity:.7}.command-line-prompt>span[data-continuation-prompt]:before{content:attr(data-continuation-prompt)}.command-line span.token.output{opacity:.7}code[class*=language-],pre[class*=language-]{color:#5c6e74;direction:ltr;font-family:Source Code Pro,monospace;font-size:13px;-webkit-hyphens:none;hyphens:none;line-height:1.5;tab-size:4;text-align:left;text-shadow:none;white-space:pre;word-break:normal;word-spacing:normal}code[class*=language-]::mozselection,code[class*=language-]::selection,pre[class*=language-]::mozselection,pre[class*=language-]::selection{background:#b3d4fc;text-shadow:none}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{background:#fff;margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-]{background:#f9f2f4;border-radius:3px;color:#db4c69;padding:.25em .5em;position:relative;top:-1px;white-space:normal}.namespace{opacity:.7}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#93a1a1}.token.punctuation{color:#999}.token.boolean,.token.constant,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{color:#a67f59}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}pre[data-line]{position:relative}pre[class*=language-]>code[class*=language-]{position:relative;z-index:1}.line-highlight{background:#f7efda;box-shadow:inset 5px 0 0 #87d8ff;left:0;line-height:inherit;margin-top:1em;padding-bottom:inherit;padding-left:0;padding-right:0;padding-top:inherit;pointer-events:none;position:absolute;right:0;white-space:pre;z-index:0}.command-line-prompt>span:before{color:#999;content:" ";display:block;padding-right:.8em}.command-line-prompt>span[data-user]:before{content:"[" attr(data-user) "@" attr(data-host) "] $"}.command-line-prompt>span[data-user=root]:before{content:"[" attr(data-user) "@" attr(data-host) "] #"}.command-line-prompt>span[data-prompt]:before{content:attr(data-prompt)}.gatsby-highlight pre{float:left;min-width:100%}.gatsby-highlight{background-color:#fff;border-radius:.3em;box-shadow:0 5px 20px rgba(0,0,0,.12);margin:32px auto;overflow:auto;padding:1em}.gatsby-highlight pre[class*=language-]{background-color:transparent;float:left;margin:0;min-width:100%;overflow:initial;padding:0}.gatsby-highlight-code-line{background:#fffbdd;border-left:.25em solid #87d8ff;display:block;margin-left:-1em;margin-right:-1em;padding-left:.75em;padding-right:1em}h1{border-bottom:1px solid #eee;font-size:2rem;padding-bottom:12px}h1 a{text-decoration:none}h2{border-bottom:1px solid #eee;font-size:1.6em;padding-bottom:8px}h3{font-size:1.3em}h3,h4{margin:8px 0}h4{font-size:1.2em}h1,h2,h3,h4,h5,h6{color:#454f5b;margin-top:48px}h1 a,h2 a,h3 a,h4 a,h5 a,h6 a{color:#454f5b!important;text-decoration:none}a{color:#454f5b;text-decoration:underline}a:hover{border-bottom:none;color:#000}img,video{border-radius:5px;height:auto;max-width:100%}blockquote{background-color:#eee;border-left:.25em solid #ccc;color:#454f5b;line-height:1.5;margin:10px 0;padding:8px 16px}hr{border-top:1px solid #ccc}.thumbnail-container{border-radius:8px;box-shadow:0 0 10px 2px rgba(0,0,0,.05);margin-bottom:25px;max-width:100%}.thumbnail-container a,.thumbnail-container img{display:block;object-fit:cover;width:100%}.post-container{line-height:1.75rem;position:relative}.post-content a{color:#5c6ac4;text-decoration:none}.post-content a:hover{text-decoration:underline}.post-content a.footnote-ref,.post-content a[data-footnote-ref]{color:#ff6f00}.post-content>p:first-letter{margin-left:.3em}.post-content ul{word-break:break-all}@media (max-width:30em){.post-content ul{list-style-position:outside;padding-left:24px}.post-content li>ul{list-style-position:outside;padding-left:12px}}sup{font-weight:400;position:relative;top:-.5em;vertical-align:top}.post-title{border:none;line-height:1.2;margin:0;padding:0}.post-date{color:#9a9a9a;display:block;font-family:Quattrocento Sans,sans-serif;font-size:.8rem;margin-bottom:1rem;margin-top:3px}@media (max-width:30rem){.posts>h1{font-size:1.5rem}}figure{margin:24px 40px;text-align:center}@media (max-width:30em){figure{margin:24px 0}}figcaption{color:#637381;font-size:12px;text-align:center}.footnotes{border-top:1px solid #eee;font-size:12px;margin-top:48px}.footnotes ol{line-height:16px;padding-left:16px}.footnotes ol li{margin-top:8px;padding-left:4px}.footnotes ol p{margin:0}.footnotes ol li::marker{color:#ff6f00}.footnotes ol li .footnote-backref{margin-left:5px}table{border-collapse:collapse;margin-bottom:30px;width:100%}table,td,th{border:1px solid #888}td,th{padding:8px;text-align:left}.sharing-icons a{padding-right:10px}.fa-envelope{padding:5px;transition:.5s}.fa-envelope:hover{color:#f39c12}.fa-twitter{padding:5px;transition:color .5s}.fa-twitter:hover{color:#00aced}.fa-instagram{padding:5px;transition:color .5s}.fa-instagram:hover{color:#375989}.fa-github{padding:5px;transition:color .5s}.fa-github:hover{color:#343434}.fa-linkedin{padding:5px;transition:color .5s}.fa-linkedin:hover{color:#0073a4}.fa-facebook{padding:5px;transition:color .5s}.fa-facebook:hover{color:#3d5b99}.fa-google-plus{padding:5px;transition:color .5s}.fa-google-plus:hover{color:#e64a41}.fa-pinterest{padding:5px;transition:color .5s}.fa-pinterest:hover{color:#bd081c}.fa-medium{padding:5px;transition:color .5s}.fa-medium:hover{color:#00ab6c}.fa-codepen{padding:5px;transition:color .5s}.fa-codepen:hover{color:#000}.fa-rss-square{padding:5px;transition:color .5s}.fa-rss-square:hover{color:#f60}[data-tooltip]{position:relative}[data-tooltip]:after{word-wrap:break-word;background-color:#212b36;border-left:6px solid #ff6f00;border-radius:2px;box-shadow:1px 2px 6px rgba(0,0,0,.3);color:#fff;content:attr(data-tooltip);display:none;font-size:12px;left:10px;line-height:16px;overflow-wrap:break-word;padding:8px 10px;pointer-events:none;position:absolute;top:0;white-space:nowrap;word-break:break-all;z-index:1000}[data-tooltip]:focus:after,[data-tooltip]:hover:after{display:block}@media (max-width:30em){[data-tooltip]:focus:after,[data-tooltip]:hover:after{display:none}}.member-container{display:flex;padding:24px 0}.member-container .avatar{flex:0 1 160px}.avatar img{border-radius:50%;width:100%}.member-container .summary{flex:1 1;margin-left:32px}.member-container{display:block}.member-container .avatar{display:block;margin:0 auto;max-width:300px;width:50%}.member-container .summary{font-size:12px;margin-left:0;text-align:center}.member-container .summary .name{font-size:28px;font-weight:100;margin-top:18px}.member-container .summary .description{font-weight:100;margin-top:8px}.tiny-header{color:#212b36;font-size:16px;font-weight:700}.gatsby-highlight{padding:0;width:95%}.gatsby-highlight pre[class*=language-]{box-sizing:border-box;padding:16px}@media (max-width:30em){.gatsby-highlight{width:100%}}</style><link rel="icon" href="/favicon-32x32.png?v=8d8fa298b67e447760210d9e8b28e447" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=8d8fa298b67e447760210d9e8b28e447"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=8d8fa298b67e447760210d9e8b28e447"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=8d8fa298b67e447760210d9e8b28e447"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=8d8fa298b67e447760210d9e8b28e447"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=8d8fa298b67e447760210d9e8b28e447"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=8d8fa298b67e447760210d9e8b28e447"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=8d8fa298b67e447760210d9e8b28e447"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=8d8fa298b67e447760210d9e8b28e447"/><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= 'https://www.googletagmanager.com/gtm.js?id='+i+dl+'';f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer', 'G-7M8K7EBEDX');</script><link rel="alternate" type="application/rss+xml" title="kciter.so" href="/feed.xml"/></head><body><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=G-7M8K7EBEDX" height="0" width="0" style="display: none; visibility: hidden" aria-hidden="true"></iframe></noscript><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><p>이전에 <a href="/posts/polymorphic-react-component">Polymorphic한 React 컴포넌트 만들기</a>라는 글을 통해 컴포넌트에 다형성을 적용하는 방법을 소개했었다. 해당 글에서는 <span><code class="language-text">as</code></span> 속성을 이용하여 컴포넌트를 변형시키는 것을 소개하는 데 이를 이용하면 하나의 컴포넌트로 여러 요소(Element)나 그에 따른 속성(Attribute)을 이용할 수 있고 이를 넘어 다른 컴포넌트를 합성하는 것도 가능하다. 따라서 이를 이용하여 <strong>무엇이든지 될 수 있는 가장 추상화된 형태의 컴포넌트</strong>를 만들 수 있다.</p>
<p>다만 이 방법은 여러 비판을 받기도 하는데 가장 큰 이유는 <strong>모호성</strong> 때문이다. <span><code class="language-text">as</code></span> 속성을 이용하여 컴포넌트를 결합하는 경우 전달할 수 있는 <span><code class="language-text">prop</code></span>이 어떤 컴포넌트의 것인지 알기 힘들다는 점과 코드만 봐서는 어떻게 렌더링 되는지 알기 힘들다는 점이다. 그 외의 비판점으로는 자동 완성이 느려진다거나 TypeScript에서 타입을 추론하기 어렵다는 점 등이 있다.</p>
<p>따라서 이에 대한 대안으로 자신의 속성과 행동을 자식 컴포넌트에 넘긴 후 자식이 직접 부모 컴포넌트를 대신하여 렌더링하는 방법인 <span><code class="language-text">Render Delegation</code></span><sup><a href="#user-content-fn-1" id="user-content-fnref-1" data-footnote-ref="true" aria-describedby="footnote-label">1</a></sup>이 등장했다. 이는 <a href="https://www.radix-ui.com" rel="nofollow noopener noreferrer">Radix</a>라는 오픈소스 리액트 컴포넌트 라이브러리를 통해 유명해진 방법으로 Render Delegation 기능을 제공하는 라이브러리는 보통 <span><code class="language-text">asChild</code></span>라는 속성을 통해 해당 기능을 이용할 수 있게 제공한다.</p>
<figure><img src="/images/2024-02-18-render-delegation-react-component/render-delegation-component.png" style="cursor:default"/><figcaption>Render Delegation 컴포넌트의 구성</figcaption></figure>
<p>Render Delegation 컴포넌트는 보통 <span><code class="language-text">Slot</code></span>과 <span><code class="language-text">Slottable</code></span>이라는 두 컴포넌트를 통해 구성된다. <span><code class="language-text">Slot</code></span>은 자식 컴포넌트를 렌더링하는 역할을 하고 <span><code class="language-text">Slottable</code></span>은 <span><code class="language-text">Slot</code></span>에 들어갈 것이 무엇인지를 나타낸다.</p>
<p>참고로 Polymorphic 컴포넌트처럼 변형을 통한 다형성 문제 해결이라는 점은 같지만 Render Delegation 컴포넌트는 <strong>기존 컴포넌트와 합성이될 컴포넌트를 코드에서 분리한다는 점</strong>이 다르다.</p>
<h1 id="문제-인식하기"><a href="#문제-인식하기">문제 인식하기</a></h1>
<p>만약 앞서 언급한 Polymorphic 컴포넌트와 이번 글에서 다룰 Render Delegation 컴포넌트가 왜 필요한지 잘 모를 수 있다. 이전에 작성한 글에서도 설명했지만 다시 한번 간단히 설명해 보겠다.</p>
<span><div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token comment">/**
 * Button.jsx
 */</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">Button</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> <span class="token operator">...</span>props <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> 
      <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token literal-property property">backgroundColor</span><span class="token operator">:</span> <span class="token string">'black'</span><span class="token punctuation">,</span> <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">'white'</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span> 
      <span class="token spread"><span class="token punctuation">{</span><span class="token operator">...</span>props<span class="token punctuation">}</span></span> 
    <span class="token punctuation">/></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * App.jsx
 */</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Button <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./Button'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">App</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Button</span></span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'Good!'</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">Click Me!</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Button</span></span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div></span>
<p>설명이 필요 없을 정도로 간단한 코드다. 단순하게 표현했지만 위 코드처럼 스타일만 적용한 컴포넌트는 실제로도 많이 사용된다. Button 컴포넌트는 prop으로 넘기는 값을 button 태그의 속성으로 전부 넘기기 때문에 꽤 확장성 있게 사용할 수 있는 컴포넌트라고 생각할 수 있다. 그런데 만약 버튼에 페이지 링크를 추가하고 싶다면 어떻게 해야 할까?</p>
<span><div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">import</span> <span class="token punctuation">{</span> Button <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./Button'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">App</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://kciter.so<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Button</span></span><span class="token punctuation">></span></span><span class="token plain-text">Click Me!</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Button</span></span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div></span>
<p>위 코드처럼 작성할 수도 있겠지만 재사용성 측면에선 그다지 좋은 방법은 아니다. 추후 재사용을 고려하여 새로운 컴포넌트를 만들 수도 있다.</p>
<span><div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token comment">/**
 * Button.jsx
 */</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">Button</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> <span class="token operator">...</span>props <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> 
      <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token literal-property property">backgroundColor</span><span class="token operator">:</span> <span class="token string">'black'</span><span class="token punctuation">,</span> <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">'white'</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span> 
      <span class="token spread"><span class="token punctuation">{</span><span class="token operator">...</span>props<span class="token punctuation">}</span></span> 
    <span class="token punctuation">/></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * LinkButton.jsx
 */</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Button <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./Button'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">LinkButton</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> href<span class="token punctuation">,</span> <span class="token operator">...</span>props <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>href<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Button</span></span> <span class="token spread"><span class="token punctuation">{</span><span class="token operator">...</span>props<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * App.jsx
 */</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> LinkButton <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./LinkButton'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">App</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">LinkButton</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://kciter.so<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token plain-text">Click Me!</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">LinkButton</span></span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div></span>
<p>혹은 위와 같이 작성할 수도 있지만 이 경우 a 태그가 확장되지 않는다는 문제점이 있고 컴포넌트의 의존 관계가 새롭게 추가된다는 문제점이 있다. 그리고 만약 react-router나 Next.js를 사용하여 SPA를 위한 Link 컴포넌트를 사용한다면 또 새로운 컴포넌트를 만들어줄 수밖에 없다. 이 문제의 해결법으로 이전 글에서 다룬 Polymorphic 컴포넌트나 이번 글에서 다룰 Render Delegation 컴포넌트를 사용할 수 있다.</p>
<h1 id="살펴보기"><a href="#살펴보기">살펴보기</a></h1>
<p>앞서 언급한 <a href="https://www.radix-ui.com" rel="nofollow noopener noreferrer">Radix</a>에서는 <a href="https://www.radix-ui.com/primitives/docs/guides/composition" rel="nofollow noopener noreferrer">asChild</a>를 통해 Render Delegation이 가능한 컴포넌트를 제공한다. 해당 라이브러리를 통해 동작을 살펴보자.</p>
<h2 id="엿보기"><a href="#엿보기">엿보기</a></h2>
<p>먼저 아주 간단한 예제를 살펴보자. 다음은 Radix에서 제공하는 <span><code class="language-text">Label</code></span>을 사용하는 예제다.</p>
<span><div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> Label <span class="token keyword">from</span> <span class="token string">"@radix-ui/react-label"</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">App</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span><span class="token comment">/* asChild를 사용하지 않은 경우 */</span><span class="token punctuation">}</span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Label.Root</span></span><span class="token punctuation">></span></span><span class="token plain-text">
        https://kciter.so
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Label.Root</span></span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div></span>
<p>위 코드에서 사용하는 <span><code class="language-text">Label.Root</code></span> 컴포넌트를 이용하면 특별한 기능 없이 <span><code class="language-text">label</code></span>을 렌더링할 수 있다. 여기서 만약 링크를 추가하고 싶다면 다음과 같이 <span><code class="language-text">asChild</code></span> 속성을 사용할 수 있다.</p>
<span><div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> Label <span class="token keyword">from</span> <span class="token string">"@radix-ui/react-label"</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">App</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span><span class="token comment">/* asChild를 사용한 경우 */</span><span class="token punctuation">}</span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Label.Root</span></span> <span class="token attr-name">asChild</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://kciter.so<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token plain-text">https://kciter.so</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Label.Root</span></span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div></span>
<figure><img src="/images/2024-02-18-render-delegation-react-component/aschild-basic-example.png" style="cursor:default"/><figcaption>요소가 변경되었다</figcaption></figure>
<p>위와 같이 작성하면 렌더링 되는 요소가 <span><code class="language-text">a</code></span>로 변경된다.</p>
<h2 id="slot-사용하기"><a href="#slot-사용하기">Slot 사용하기</a></h2>
<p>앞서 살펴본 예제는 기본적으로 제공하는 컴포넌트에서 단순히 요소를 변경하기만 하는 아주 간단한 예제였다. Radix에서 제공하는 <a href="https://www.radix-ui.com/primitives/docs/utilities/slot" rel="nofollow noopener noreferrer">Slot</a>을 이용하면 사용자가 직접 Render Delegation이 가능한 컴포넌트를 만들 수 있다.</p>
<span><div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">import</span> <span class="token punctuation">{</span> Slot <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@radix-ui/react-slot"</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">Button</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> asChild<span class="token punctuation">,</span> <span class="token operator">...</span>props <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> Element <span class="token operator">=</span> asChild <span class="token operator">?</span> Slot <span class="token operator">:</span> <span class="token string">"button"</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Element</span></span> 
      <span class="token spread"><span class="token punctuation">{</span><span class="token operator">...</span>props<span class="token punctuation">}</span></span>
      <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
        <span class="token literal-property property">padding</span><span class="token operator">:</span> <span class="token string">"10px"</span><span class="token punctuation">,</span>
        <span class="token literal-property property">border</span><span class="token operator">:</span> <span class="token string">"1px solid #000"</span><span class="token punctuation">,</span>
        <span class="token literal-property property">borderRadius</span><span class="token operator">:</span> <span class="token string">"5px"</span><span class="token punctuation">,</span>
        <span class="token literal-property property">backgroundColor</span><span class="token operator">:</span> <span class="token string">'transparent'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">fontSize</span><span class="token operator">:</span> <span class="token number">12</span>
      <span class="token punctuation">}</span><span class="token punctuation">}</span></span>
    <span class="token punctuation">/></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">App</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Button</span></span><span class="token punctuation">></span></span><span class="token plain-text">
        This is button
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Button</span></span><span class="token punctuation">></span></span><span class="token plain-text">

      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Button</span></span> <span class="token attr-name">asChild</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://kciter.so<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token plain-text">This is link</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Button</span></span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div></span>
<p><span><code class="language-text">Slot</code></span> 컴포넌트는 <span><code class="language-text">children</code></span>으로 받은 JSX 요소를 렌더링한다. 위 코드를 살펴보면 <span><code class="language-text">asChild</code></span> 속성이 <span><code class="language-text">true</code></span>일 때는 <span><code class="language-text">Slot</code></span> 컴포넌트를 사용하고 <span><code class="language-text">false</code></span>일 때는 <span><code class="language-text">button</code></span>를 사용한다. 따라서 <span><code class="language-text">asChild</code></span>를 사용한 컴포넌트의 렌더링 결과를 보면 기존 <span><code class="language-text">Button</code></span> 컴포넌트에서 설정한 스타일은 변하지 않지만 요소가 변경된 것을 확인할 수 있다.</p>
<figure><img src="/images/2024-02-18-render-delegation-react-component/slot-example.png" width="50%" style="cursor:default"/><figcaption>asChild 여부에 따라 렌더링이 달라진다</figcaption></figure>
<p>즉 <span><code class="language-text">Slot</code></span>을 이용하여 부모 컴포넌트의 속성을 자식 컴포넌트에 넘기고 렌더링을 위임했다고 볼 수 있다.</p>
<h2 id="slottable-사용하기"><a href="#slottable-사용하기">Slottable 사용하기</a></h2>
<p><span><code class="language-text">Slottable</code></span>을 이용하면 <strong>일부분만 위임</strong>하는 것도 가능하다. 다음 예제를 살펴보자.</p>
<span><div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">import</span> <span class="token punctuation">{</span> Slot<span class="token punctuation">,</span> Slottable <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@radix-ui/react-slot"</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">Icon</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span><span class="token plain-text">🔴</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>
<span class="token punctuation">)</span>

<span class="token keyword">const</span> <span class="token function-variable function">Button</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> asChild<span class="token punctuation">,</span> icon<span class="token punctuation">,</span> children<span class="token punctuation">,</span> <span class="token operator">...</span>props <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> Element <span class="token operator">=</span> asChild <span class="token operator">?</span> Slot <span class="token operator">:</span> <span class="token string">"button"</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Element</span></span> 
      <span class="token spread"><span class="token punctuation">{</span><span class="token operator">...</span>props<span class="token punctuation">}</span></span>
      <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
        <span class="token literal-property property">padding</span><span class="token operator">:</span> <span class="token string">"10px"</span><span class="token punctuation">,</span>
        <span class="token literal-property property">border</span><span class="token operator">:</span> <span class="token string">"1px solid #000"</span><span class="token punctuation">,</span>
        <span class="token literal-property property">borderRadius</span><span class="token operator">:</span> <span class="token string">"5px"</span><span class="token punctuation">,</span>
        <span class="token literal-property property">backgroundColor</span><span class="token operator">:</span> <span class="token string">'transparent'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">fontSize</span><span class="token operator">:</span> <span class="token number">12</span>
      <span class="token punctuation">}</span><span class="token punctuation">}</span></span>
    <span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span>icon<span class="token punctuation">}</span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Slottable</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span>children<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Slottable</span></span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Element</span></span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">App</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Button</span></span> <span class="token attr-name">icon</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Icon</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">
        This is button
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Button</span></span><span class="token punctuation">></span></span><span class="token plain-text">

      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Button</span></span> <span class="token attr-name">icon</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Icon</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">}</span></span> <span class="token attr-name">asChild</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://kciter.so<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token plain-text">This is link</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Button</span></span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div></span>
<p><span><code class="language-text">Slottable</code></span> 컴포넌트는 <span><code class="language-text">Slot</code></span> 컴포넌트로 렌더링 될 컴포넌트의 <span><code class="language-text">children</code></span>이 들어갈 곳을 정할 수 있다. 즉, 위 코드에선 <span><code class="language-text">Button</code></span>의 <span><code class="language-text">children</code></span>이 아닌 <span><code class="language-text">a</code></span> 요소의 <span><code class="language-text">children</code></span>이 <span><code class="language-text">Slottable</code></span> 컴포넌트 내부로 들어가게 된다.</p>
<figure><img src="/images/2024-02-18-render-delegation-react-component/slottable-example.png" width="50%" style="cursor:default"/><figcaption>렌더링 결과</figcaption></figure>
<p>실제로 렌더링 된 HTML을 보면 다음과 같다.</p>
<span><div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css">...</span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>🔴<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>
    This is button
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
  
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://kciter.so<span class="token punctuation">"</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css">...</span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>🔴<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>
    This is link
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></code></pre></div></span>
<p>결과적으로 <span><code class="language-text">icon</code></span> 속성은 <span><code class="language-text">Button</code></span> 컴포넌트에서 설정한 대로 따르지만, 그 외 속성은 <span><code class="language-text">asChild</code></span> 속성에 따라 위임된다. 즉, <strong>위임하고 싶은 부분만 따로 지정해서 구현하는 것</strong>이 가능하다. 이렇게 <span><code class="language-text">Slottable</code></span>을 사용하면 조금 더 풍부한 표현이 가능해진다. 참고로 <span><code class="language-text">Slot</code></span>만 사용하는 것은 <span><code class="language-text">Slot</code></span> 내부에 <span><code class="language-text">Slottable</code></span>을 최상위로 둬서 사용하는 것과 같다.</p>
<h1 id="구현하기"><a href="#구현하기">구현하기</a></h1>
<p>이제 <span><code class="language-text">Slot</code></span>과 <span><code class="language-text">Slottable</code></span> 컴포넌트가 어떻게 동작하는지 알았으니 이 두 컴포넌트를 직접 만들어보자. 여기서는 먼저 편의를 위해 JavaScript로 구현해 볼 것이다.</p>
<h2 id="slot-구현하기"><a href="#slot-구현하기">Slot 구현하기</a></h2>
<p><span><code class="language-text">Slot</code></span> 컴포넌트는 <span><code class="language-text">children</code></span>을 조금만 변형해서 렌더링하면 되기 때문에 아주 쉽게 구현할 수 있다. 다음 코드를 살펴보자.</p>
<span><div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token comment">/**
 * Slot.jsx
 */</span>

<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">Slot</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> children<span class="token punctuation">,</span> <span class="token operator">...</span>props <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>React<span class="token punctuation">.</span><span class="token function">isValidElement</span><span class="token punctuation">(</span>children<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> React<span class="token punctuation">.</span><span class="token function">cloneElement</span><span class="token punctuation">(</span>children<span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token operator">...</span>props<span class="token punctuation">,</span>
      <span class="token operator">...</span>children<span class="token punctuation">.</span>props<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 올바르지 않은 컴포넌트라면 경고 로그를 출력하고 null을 반환</span>
  console<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">"Slot component should have only one React element as a child"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div></span>
<p>위 코드에서 <span><code class="language-text">Slot</code></span> 컴포넌트는 <span><code class="language-text">children</code></span>으로 받은 JSX 요소를 렌더링한다. 만약 <span><code class="language-text">children</code></span>이 JSX 요소라면 <span><code class="language-text">props</code></span>를 합성하여 새로운 컴포넌트를 만들어 렌더링하고 그렇지 않다면 렌더링하지 않는다. 이때 <span><code class="language-text">children</code></span>이 React Element가 아니거나 여러 개 들어오는 경우엔 경고 로그를 보여주고 <span><code class="language-text">null</code></span>을 반환하도록 구현했다. 그럼 벌써 <span><code class="language-text">Slot</code></span>을 구현했다. 이전에 Radix 예제에 사용했던 코드로 테스트하면 잘 돌아가는 것을 확인할 수 있다.</p>
<span><div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token comment">/**
 * App.jsx
 */</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> Slot <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"./Slot"</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">Button</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> asChild<span class="token punctuation">,</span> <span class="token operator">...</span>props <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> Element <span class="token operator">=</span> asChild <span class="token operator">?</span> Slot <span class="token operator">:</span> <span class="token string">"button"</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Element</span></span> <span class="token spread"><span class="token punctuation">{</span><span class="token operator">...</span>props<span class="token punctuation">}</span></span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token comment">/* ... */</span><span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">App</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Button</span></span><span class="token punctuation">></span></span><span class="token plain-text">
        This is button
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Button</span></span><span class="token punctuation">></span></span><span class="token plain-text">

      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Button</span></span> <span class="token attr-name">asChild</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://kciter.so<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token plain-text">This is link</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Button</span></span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div></span>
<figure><img src="/images/2024-02-18-render-delegation-react-component/handmade-slot.png" width="70%" style="cursor:default"/><figcaption>잘 동작한다</figcaption></figure>
<h2 id="slottable-구현하기"><a href="#slottable-구현하기">Slottable 구현하기</a></h2>
<p>그럼 이번에는 <span><code class="language-text">Slottable</code></span> 개념을 구현해보자.</p>
<span><div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token comment">/**
 * Slottable.jsx
 */</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">Slottable</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> children <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">></span></span><span class="token plain-text">children</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">></span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div></span>
<p>사실 <span><code class="language-text">Slottable</code></span> 컴포넌트는 따로 하는 게 없다. 그저 스스로 <span><code class="language-text">Slottable</code></span>라는 것을 알려줄 수만 있으면 되기에 위와 같이 구현하면 된다. 대신 기존에 구현했던 Slot 컴포넌트의 로직을 변경할 필요가 있다. 이 부분이 조금 어려울 수 있다.</p>
<span><div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token comment">/**
 * Slot.jsx
 */</span>

<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Slottable <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"./Slottable"</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">Slot</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> children<span class="token punctuation">,</span> <span class="token operator">...</span>props <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> childrenArray <span class="token operator">=</span> React<span class="token punctuation">.</span>Children<span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span>children<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> slottable <span class="token operator">=</span> childrenArray<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">child</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> React<span class="token punctuation">.</span><span class="token function">isValidElement</span><span class="token punctuation">(</span>child<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> child<span class="token punctuation">.</span>type <span class="token operator">===</span> Slottable
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>slottable<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// Slottable이 있다면</span>
    <span class="token keyword">const</span> newElement <span class="token operator">=</span> slottable<span class="token punctuation">.</span>props<span class="token punctuation">.</span>children<span class="token punctuation">;</span>
    <span class="token keyword">const</span> newChildren <span class="token operator">=</span> childrenArray<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">child</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      <span class="token comment">// Slottable이 아닌 것은 그대로 반환</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>child <span class="token operator">!==</span> slottable<span class="token punctuation">)</span> <span class="token keyword">return</span> child<span class="token punctuation">;</span>

      <span class="token comment">// Slottable이라면 해당 영역을 자식 컴포넌트의 children으로 교체</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>React<span class="token punctuation">.</span><span class="token function">isValidElement</span><span class="token punctuation">(</span>newElement<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> newElement<span class="token punctuation">.</span>props<span class="token punctuation">.</span>children<span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span>
          <span class="token string">"Slot component should have only one React element as a child"</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 새로운 요소를 렌더링</span>
    <span class="token keyword">return</span> React<span class="token punctuation">.</span><span class="token function">isValidElement</span><span class="token punctuation">(</span>newElement<span class="token punctuation">)</span>
      <span class="token operator">?</span> React<span class="token punctuation">.</span><span class="token function">cloneElement</span><span class="token punctuation">(</span>
          newElement<span class="token punctuation">,</span> 
          <span class="token punctuation">{</span> <span class="token operator">...</span>props<span class="token punctuation">,</span> <span class="token operator">...</span>newElement<span class="token punctuation">.</span>props <span class="token punctuation">}</span><span class="token punctuation">,</span> 
          newChildren
        <span class="token punctuation">)</span>
      <span class="token operator">:</span> <span class="token keyword">null</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>React<span class="token punctuation">.</span><span class="token function">isValidElement</span><span class="token punctuation">(</span>children<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> React<span class="token punctuation">.</span><span class="token function">cloneElement</span><span class="token punctuation">(</span>children<span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token operator">...</span>props<span class="token punctuation">,</span>
      <span class="token operator">...</span>children<span class="token punctuation">.</span>props<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  console<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">"Slot component should have only one React element as a child"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div></span>
<p>기존 코드에서 달라진 점은 Slottable이 있는지 확인하고 있다면 이에 대해 처리해 주는 부분이다. 이 부분을 제외하면 기존 코드와 동일하다. 이렇게 만들어진 Slot과 Slottable을 이용하여 이전에 사용했던 예제로 실행해 보면 잘되는 것을 확인할 수 있다.</p>
<figure><img src="/images/2024-02-18-render-delegation-react-component/handmade-slottable.png" width="70%" style="cursor:default"/><figcaption>아주 잘 동작한다</figcaption></figure>
<h2 id="typescript-지원"><a href="#typescript-지원">TypeScript 지원</a></h2>
<p>이번에는 TypeScript으로 작성해 보자. 타입을 신경써야 해서 구현이 복잡하지 않을까 싶지만 Render Delegation 컴포넌트는 Polymorphic 컴포넌트와 다르게 변형할 컴포넌트가 코드에서 분리되기 때문에 타입 추론이 쉽다. 그래서 TypeScript로 구현하는 것은 JavaScript 구현과 크게 다르지 않다.</p>
<p>먼저 Slot 컴포넌트에 타입을 붙이면서 다시 구현해 보자.</p>
<span><div class="gatsby-highlight" data-language="tsx"><pre class="language-tsx"><code class="language-tsx"><span class="token comment">/**
 * Slot.tsx
 */</span>

<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">SlotProps</span> <span class="token keyword">extends</span> <span class="token class-name">React</span><span class="token punctuation">.</span>HTMLAttributes<span class="token operator">&lt;</span>HTMLElement<span class="token operator">></span> <span class="token punctuation">{</span>
  children<span class="token operator">:</span> React<span class="token punctuation">.</span>ReactNode<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">RenderDelegationProps<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token operator">&amp;</span> <span class="token punctuation">{</span>
  asChild<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">Slot</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> children<span class="token punctuation">,</span> <span class="token operator">...</span>props <span class="token punctuation">}</span><span class="token operator">:</span> SlotProps<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>React<span class="token punctuation">.</span><span class="token function">isValidElement</span><span class="token punctuation">(</span>children<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> React<span class="token punctuation">.</span><span class="token function">cloneElement</span><span class="token punctuation">(</span>children<span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token operator">...</span>props<span class="token punctuation">,</span>
      <span class="token operator">...</span>children<span class="token punctuation">.</span>props<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">"Slot component should have only one React element as a child"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div></span>
<p>타입을 상식적인 수준 정도로만 붙였는데 벌써 완성됐다. 코드 중 <span><code class="language-text">RenderDelegationProps</code></span>는 Render Delegation을 사용할 컴포넌트에 붙일 수 있는 타입이다. 이 타입을 이용하면 <span><code class="language-text">asChild</code></span> 속성을 사용할 수 있게 된다.</p>
<p>이어서 <span><code class="language-text">Slottable</code></span> 개념과 관련된 로직에 타입을 붙이면서 다시 구현해 보자.</p>
<span><div class="gatsby-highlight" data-language="tsx"><pre class="language-tsx"><code class="language-tsx"><span class="token comment">/**
 * Slottable.tsx
 */</span>

<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">SlottableProps</span> <span class="token punctuation">{</span>
  children<span class="token operator">:</span> React<span class="token punctuation">.</span>ReactNode<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">Slottable</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> children <span class="token punctuation">}</span><span class="token operator">:</span> SlottableProps<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">></span></span><span class="token plain-text">children</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">></span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div></span>
<p>마찬가지로 아주 간단하게 구현할 수 있다. 이제 <span><code class="language-text">Slot</code></span> 컴포넌트의 로직을 변경하면서 타입을 붙이면 된다.</p>
<span><div class="gatsby-highlight" data-language="tsx"><pre class="language-tsx"><code class="language-tsx"><span class="token comment">/**
 * Slot.tsx
 */</span>

<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Slottable<span class="token punctuation">,</span> SlottableProps <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"./Slottable"</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">SlotProps</span> <span class="token keyword">extends</span> <span class="token class-name">React</span><span class="token punctuation">.</span>HTMLAttributes<span class="token operator">&lt;</span>HTMLElement<span class="token operator">></span> <span class="token punctuation">{</span>
  children<span class="token operator">:</span> React<span class="token punctuation">.</span>ReactNode<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">AsChildProps<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token operator">&amp;</span> <span class="token punctuation">{</span>
  asChild<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">Slot</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> children<span class="token punctuation">,</span> <span class="token operator">...</span>props <span class="token punctuation">}</span><span class="token operator">:</span> SlotProps<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> childrenArray <span class="token operator">=</span> React<span class="token punctuation">.</span>Children<span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span>children<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> slottable <span class="token operator">=</span> childrenArray<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">(</span>child<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> React<span class="token punctuation">.</span><span class="token function">isValidElement</span><span class="token punctuation">(</span>child<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> child<span class="token punctuation">.</span>type <span class="token operator">===</span> Slottable<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token keyword">as</span> React<span class="token punctuation">.</span>ReactElement<span class="token operator">&lt;</span>SlottableProps<span class="token operator">></span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>slottable<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> newElement <span class="token operator">=</span> slottable<span class="token punctuation">.</span>props<span class="token punctuation">.</span>children<span class="token punctuation">;</span>
    <span class="token keyword">const</span> newChildren <span class="token operator">=</span> childrenArray<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>child<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>child <span class="token operator">!==</span> slottable<span class="token punctuation">)</span> <span class="token keyword">return</span> child<span class="token punctuation">;</span>

      <span class="token keyword">if</span> <span class="token punctuation">(</span>React<span class="token punctuation">.</span><span class="token function">isValidElement</span><span class="token punctuation">(</span>newElement<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> newElement<span class="token punctuation">.</span>props<span class="token punctuation">.</span>children<span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span>
          <span class="token string">"Slot component should have only one React element as a child"</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> React<span class="token punctuation">.</span><span class="token function">isValidElement</span><span class="token punctuation">(</span>newElement<span class="token punctuation">)</span>
      <span class="token operator">?</span> React<span class="token punctuation">.</span><span class="token function">cloneElement</span><span class="token punctuation">(</span>
          newElement<span class="token punctuation">,</span>
          <span class="token punctuation">{</span> <span class="token operator">...</span>props<span class="token punctuation">,</span> <span class="token operator">...</span>newElement<span class="token punctuation">.</span>props <span class="token punctuation">}</span><span class="token punctuation">,</span>
          newChildren
        <span class="token punctuation">)</span>
      <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>React<span class="token punctuation">.</span><span class="token function">isValidElement</span><span class="token punctuation">(</span>children<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> React<span class="token punctuation">.</span><span class="token function">cloneElement</span><span class="token punctuation">(</span>children<span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token operator">...</span>props<span class="token punctuation">,</span>
      <span class="token operator">...</span>children<span class="token punctuation">.</span>props<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">"Slot component should have only one React element as a child"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div></span>
<p>마찬가지로 기존 코드와 크게 다른 점이 없다. 딱 한 라인이 추가되었는데 이는 <span><code class="language-text">Slottable</code></span> 컴포넌트를 찾은 후 어떤 타입인지 명시해 주는 것뿐이다. 만약 TypeScript의 <a href="https://www.typescriptlang.org/docs/handbook/2/narrowing.html#using-type-predicates" rel="nofollow noopener noreferrer">사용자 정의 타입 가드 문법</a>을 사용하면 다음과 같이 작성하는 것도 가능하다.</p>
<span><div class="gatsby-highlight" data-language="tsx"><pre class="language-tsx"><code class="language-tsx"><span class="token comment">/**
 * Slot.tsx
 */</span>

<span class="token keyword">function</span> <span class="token function">isSlottable</span><span class="token punctuation">(</span>child<span class="token operator">:</span> React<span class="token punctuation">.</span>ReactNode<span class="token punctuation">)</span><span class="token operator">:</span> child <span class="token keyword">is</span> React<span class="token punctuation">.</span>ReactElement <span class="token punctuation">{</span>
  <span class="token keyword">return</span> React<span class="token punctuation">.</span><span class="token function">isValidElement</span><span class="token punctuation">(</span>child<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> child<span class="token punctuation">.</span>type <span class="token operator">===</span> Slottable<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">Slot</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> children<span class="token punctuation">,</span> <span class="token operator">...</span>props <span class="token punctuation">}</span><span class="token operator">:</span> SlotProps<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> childrenArray <span class="token operator">=</span> React<span class="token punctuation">.</span>Children<span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span>children<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> slottable <span class="token operator">=</span> childrenArray<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>isSlottable<span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span></code></pre></div></span>
<h1 id="추가-구현"><a href="#추가-구현">추가 구현</a></h1>
<p>여기까지 구현했다면 아주 기초적인 Render Delegation 컴포넌트를 완성했다고 볼 수 있다. 다만, 몇 가지 특수한 상황을 해결하기 위해 추가적인 기능을 구현할 필요가 있다.</p>
<h2 id="ref-받아오기"><a href="#ref-받아오기">ref 받아오기</a></h2>
<p>특수한 상황 중 하나는 <span><code class="language-text">ref</code></span>를 사용하는 경우다. Polymorphic 컴포넌트와 다르게 Render Delegation 컴포넌트는 어디에 <span><code class="language-text">ref</code></span>를 붙여야할지 애매할 수 있다.</p>
<span><div class="gatsby-highlight" data-language="tsx"><pre class="language-tsx"><code class="language-tsx"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Button</span></span> <span class="token attr-name">asChild</span> <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token operator">??</span><span class="token operator">?</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://kciter.so<span class="token punctuation">"</span></span> <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token operator">??</span><span class="token operator">?</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">
    Click me!
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token plain-text">
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Button</span></span><span class="token punctuation">></span></span></code></pre></div></span>
<figcaption style="margin-top:-12px">어디에 <span><code class="language-text">ref</code></span>를 넣어야할까?</figcaption>
<p>Radix에서는 어느 쪽에 붙이더라도 <span><code class="language-text">asChild</code></span>를 사용한다면 같은 결과를 얻을 수 있다. 하지만 타입 추론 문제로 인해 <span><code class="language-text">asChild</code></span>를 사용하는 경우 자식 컴포넌트에 <span><code class="language-text">ref</code></span>를 붙이고 <span><code class="language-text">asChild</code></span>를 사용하지 않으면 부모 컴포넌트에 <span><code class="language-text">ref</code></span>를 사용하게 된다. 만약 타입 추론이 필요없다면 어느 쪽에 붙여도 상관 없다.</p>
<p>아래 코드는 Radix에서 제공하는 코드를 참고한 것이다. 한 번 살펴보자.</p>
<span><div class="gatsby-highlight" data-language="tsx"><pre class="language-tsx"><code class="language-tsx"><span class="token keyword">type</span> <span class="token class-name">PossibleRef<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> React<span class="token punctuation">.</span>Ref<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span> <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>

<span class="token comment">// ref를 설정하는 함수</span>
<span class="token keyword">function</span> <span class="token generic-function"><span class="token function">setRef</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>ref<span class="token operator">:</span> PossibleRef<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">,</span> value<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> ref <span class="token operator">===</span> <span class="token string">"function"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">ref</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>ref <span class="token operator">!==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> ref <span class="token operator">!==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">(</span>ref <span class="token keyword">as</span> React<span class="token punctuation">.</span>MutableRefObject<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">.</span>current <span class="token operator">=</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// ref를 합성하는 함수</span>
<span class="token keyword">function</span> <span class="token generic-function"><span class="token function">composeRefs</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token operator">...</span>refs<span class="token operator">:</span> PossibleRef<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>node<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span> <span class="token operator">=></span> refs<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ref<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">setRef</span><span class="token punctuation">(</span>ref<span class="token punctuation">,</span> node<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div></span>
<p>위 코드를 보면 <span><code class="language-text">ref</code></span>를 설정하는 <span><code class="language-text">setRef</code></span> 함수와 여러 <span><code class="language-text">ref</code></span>를 합성하여 하나의 <span><code class="language-text">ref</code></span>를 만드는 <span><code class="language-text">composeRefs</code></span> 함수가 있다. 이제 이를 이용하여 <span><code class="language-text">Slot</code></span> 컴포넌트에 <span><code class="language-text">ref</code></span>를 설정할 수 있도록 구현해보자.</p>
<span><div class="gatsby-highlight" data-language="tsx"><pre class="language-tsx"><code class="language-tsx"><span class="token comment">/**
 * Slot.tsx
 */</span>

<span class="token comment">// forwardRef로 감싸서 ref를 받아올 수 있도록 만든다.</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> Slot <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">forwardRef</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token punctuation">,</span> SlotProps<span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>props<span class="token punctuation">,</span> ref<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> children<span class="token punctuation">,</span> <span class="token operator">...</span>slotProps <span class="token punctuation">}</span> <span class="token operator">=</span> props<span class="token punctuation">;</span>
  <span class="token keyword">const</span> childrenArray <span class="token operator">=</span> React<span class="token punctuation">.</span>Children<span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span>children<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> slottable <span class="token operator">=</span> childrenArray<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>isSlottable<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>slottable<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>

    <span class="token keyword">return</span> React<span class="token punctuation">.</span><span class="token function">isValidElement</span><span class="token punctuation">(</span>newElement<span class="token punctuation">)</span>
      <span class="token operator">?</span> React<span class="token punctuation">.</span><span class="token function">cloneElement</span><span class="token punctuation">(</span>
          newElement<span class="token punctuation">,</span>
          <span class="token punctuation">{</span>
            <span class="token operator">...</span>slotProps<span class="token punctuation">,</span>
            <span class="token operator">...</span>newElement<span class="token punctuation">.</span>props<span class="token punctuation">,</span>
            <span class="token comment">// forwardRef로 받아온 ref가 있고 자식 컴포넌트에 ref가 있다면 합성한다.</span>
            <span class="token comment">// forwardRef로 받아온 ref가 없다면 자식 컴포넌트의 ref를 넣어준다.</span>
            ref<span class="token operator">:</span> ref <span class="token operator">?</span> <span class="token function">composeRefs</span><span class="token punctuation">(</span>ref<span class="token punctuation">,</span> <span class="token punctuation">(</span>newElement <span class="token keyword">as</span> <span class="token builtin">any</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ref<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token punctuation">(</span>newElement <span class="token keyword">as</span> <span class="token builtin">any</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ref<span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          newChildren
        <span class="token punctuation">)</span>
      <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>React<span class="token punctuation">.</span><span class="token function">isValidElement</span><span class="token punctuation">(</span>children<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> React<span class="token punctuation">.</span><span class="token function">cloneElement</span><span class="token punctuation">(</span>children<span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token operator">...</span>props<span class="token punctuation">,</span>
      <span class="token operator">...</span>children<span class="token punctuation">.</span>props<span class="token punctuation">,</span>
      <span class="token comment">// 이곳에도 마찬가지로 ref를 설정한다.</span>
      ref<span class="token operator">:</span> ref <span class="token operator">?</span> <span class="token function">composeRefs</span><span class="token punctuation">(</span>ref<span class="token punctuation">,</span> <span class="token punctuation">(</span>newElement <span class="token keyword">as</span> <span class="token builtin">any</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ref<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token punctuation">(</span>newElement <span class="token keyword">as</span> <span class="token builtin">any</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ref<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">"Slot component should have only one React element as a child"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div></span>
<p>위와 같이 코드를 작성했다면 <span><code class="language-text">Button</code></span> 컴포넌트도 <span><code class="language-text">ref</code></span>를 받을 수 있게 수정해보자.</p>
<span><div class="gatsby-highlight" data-language="tsx"><pre class="language-tsx"><code class="language-tsx"><span class="token comment">/**
 * Button.tsx
 */</span>

<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> AsChildProps<span class="token punctuation">,</span> Slot <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"./Slot"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Slottable <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"./Slottable"</span><span class="token punctuation">;</span>

<span class="token keyword">interface</span> <span class="token class-name">Props</span> <span class="token punctuation">{</span>
  children<span class="token operator">:</span> React<span class="token punctuation">.</span>ReactNode<span class="token punctuation">;</span>
  icon<span class="token operator">?</span><span class="token operator">:</span> React<span class="token punctuation">.</span>ReactNode<span class="token punctuation">;</span>
  onClick<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">ButtonProps</span> <span class="token operator">=</span> AsChildProps<span class="token operator">&lt;</span>Props<span class="token operator">></span><span class="token punctuation">;</span>

                      <span class="token comment">/* 우선 ref 타입을 any로 설정했다 */</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> Button <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">forwardRef</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token punctuation">,</span> ButtonProps<span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>props<span class="token punctuation">,</span> ref<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> asChild<span class="token punctuation">,</span> children<span class="token punctuation">,</span> icon <span class="token punctuation">}</span> <span class="token operator">=</span> props<span class="token punctuation">;</span>
  <span class="token keyword">const</span> Element <span class="token operator">=</span> asChild <span class="token operator">?</span> Slot <span class="token operator">:</span> <span class="token string">"button"</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Element</span></span>
      <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>ref<span class="token punctuation">}</span></span>
      <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
        <span class="token literal-property property">padding</span><span class="token operator">:</span> <span class="token string">"10px"</span><span class="token punctuation">,</span>
        <span class="token literal-property property">border</span><span class="token operator">:</span> <span class="token string">"1px solid #000"</span><span class="token punctuation">,</span>
        <span class="token literal-property property">borderRadius</span><span class="token operator">:</span> <span class="token string">"5px"</span><span class="token punctuation">,</span>
        <span class="token literal-property property">backgroundColor</span><span class="token operator">:</span> <span class="token string">"transparent"</span><span class="token punctuation">,</span>
        <span class="token literal-property property">fontSize</span><span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">}</span></span>
    <span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span>icon<span class="token punctuation">}</span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Slottable</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span>children<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Slottable</span></span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Element</span></span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div></span>
<p>이어서 잘 돌아가는지 확인해보자.</p>
<span><div class="gatsby-highlight" data-language="tsx"><pre class="language-tsx"><code class="language-tsx"><span class="token comment">/**
 * App.tsx
 */</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> useEffect<span class="token punctuation">,</span> useRef <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Button <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"./components/Button"</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">Icon</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span><span class="token plain-text">🔴</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">App</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> buttonRef <span class="token operator">=</span> <span class="token generic-function"><span class="token function">useRef</span><span class="token generic class-name"><span class="token operator">&lt;</span>HTMLButtonElement<span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> parentRef <span class="token operator">=</span> <span class="token generic-function"><span class="token function">useRef</span><span class="token generic class-name"><span class="token operator">&lt;</span>HTMLAnchorElement<span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> childRef <span class="token operator">=</span> <span class="token generic-function"><span class="token function">useRef</span><span class="token generic class-name"><span class="token operator">&lt;</span>HTMLAnchorElement<span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>buttonRef<span class="token punctuation">.</span>current<span class="token punctuation">,</span> parentRef<span class="token punctuation">.</span>current<span class="token punctuation">,</span> childRef<span class="token punctuation">.</span>current<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>buttonRef<span class="token punctuation">.</span>current <span class="token operator">===</span> parentRef<span class="token punctuation">.</span>current<span class="token punctuation">,</span> parentRef<span class="token punctuation">.</span>current <span class="token operator">===</span> childRef<span class="token punctuation">.</span>current<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Button</span></span> <span class="token attr-name">icon</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Icon</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">}</span></span> <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>buttonRef<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">
        This is button
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Button</span></span><span class="token punctuation">></span></span><span class="token plain-text">

      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Button</span></span> <span class="token attr-name">icon</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Icon</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">}</span></span> <span class="token attr-name">asChild</span> <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>parentRef<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://kciter.so<span class="token punctuation">"</span></span> <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>childRef<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">
          This is link
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Button</span></span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> App<span class="token punctuation">;</span></code></pre></div></span>
<p>로그를 확인해보면 다음과 같이 잘 동작하는 것을 확인할 수 있다.</p>
<figure><img src="/images/2024-02-18-render-delegation-react-component/ref-log.png" style="cursor:default"/><figcaption>ref가 잘 설정된 것을 확인할 수 있다</figcaption></figure>
<p>만약 <span><code class="language-text">Button</code></span> 컴포넌트에 <span><code class="language-text">ref</code></span> 타입을 명시해준다면 부모 컴포넌트에 자식 컴포넌트 <span><code class="language-text">ref</code></span> 타입인 <span><code class="language-text">HTMLAnchorElement</code></span>을 사용할 수 없다.</p>
<span><div class="gatsby-highlight" data-language="tsx"><pre class="language-tsx"><code class="language-tsx"><span class="token comment">/**
 * Button.tsx
 */</span>

<span class="token keyword">type</span> <span class="token class-name">ButtonElement</span> <span class="token operator">=</span> React<span class="token punctuation">.</span>ElementRef<span class="token operator">&lt;</span><span class="token string">'button'</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> Button <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">forwardRef</span><span class="token generic class-name"><span class="token operator">&lt;</span>ButtonElement<span class="token punctuation">,</span> ButtonProps<span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>props<span class="token punctuation">,</span> ref<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div></span>
<figure><img src="/images/2024-02-18-render-delegation-react-component/cannot-type-inference.png" style="cursor:default"/><figcaption>위 코드와 같이 변경하면 타입 에러가 발생한다</figcaption></figure>
<h2 id="prop-병합-문제"><a href="#prop-병합-문제">prop 병합 문제</a></h2>
<p>또 다른 특수한 상황은 부모 컴포넌트와 자식 컴포넌트의 <span><code class="language-text">prop</code></span> 명칭이 같은 경우다.</p>
<span><div class="gatsby-highlight" data-language="tsx"><pre class="language-tsx"><code class="language-tsx"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Button</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>primary<span class="token punctuation">"</span></span> <span class="token attr-name">asChild</span><span class="token punctuation">></span></span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Anchor</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>underline<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://kciter.so<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token plain-text">
    Click me!
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Anchor</span></span><span class="token punctuation">></span></span><span class="token plain-text">
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Button</span></span><span class="token punctuation">></span></span></code></pre></div></span>
<p>지금까지 작성한 코드로는 무조건 자식 컴포넌트가 부모 컴포넌트의 <span><code class="language-text">prop</code></span>을 덮어쓰게 된다. 예를 들어 다음과 같은 코드를 작성했다고 가정해보자.</p>
<span><div class="gatsby-highlight" data-language="tsx"><pre class="language-tsx"><code class="language-tsx"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Button</span></span> <span class="token attr-name">icon</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Icon</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">}</span></span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"Hi!"</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span> <span class="token attr-name">asChild</span><span class="token punctuation">></span></span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"Hello!"</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span> <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>childRef<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">
    Show alert
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token plain-text">
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Button</span></span><span class="token punctuation">></span></span></code></pre></div></span>
<p>만약 위 코드에서 주입된 두 <span><code class="language-text">onClick</code></span>이 같이 실행되길 원한다면 지금까지 구현한 코드로는 불가능하다. 이처럼 어떤 <span><code class="language-text">prop</code></span>은 특별한 규칙을 가져야 할 수도 있다. 이런 경우를 위해 <span><code class="language-text">Slot</code></span> 컴포넌트에 <span><code class="language-text">prop</code></span>을 병합하는 함수을 추가해보자. 다음 코드 또한 Radix에서 사용되는 코드다. 이해를 위해 필자가 몇 가지 주석을 추가했다. 한 번 살펴보자.</p>
<span><div class="gatsby-highlight" data-language="tsx"><pre class="language-tsx"><code class="language-tsx"><span class="token keyword">type</span> <span class="token class-name">AnyProps</span> <span class="token operator">=</span> Record<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token operator">></span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">mergeProps</span><span class="token punctuation">(</span>slotProps<span class="token operator">:</span> AnyProps<span class="token punctuation">,</span> childProps<span class="token operator">:</span> AnyProps<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 우선 Child prop을 넣어준다</span>
  <span class="token keyword">const</span> overrideProps <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span>childProps <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token comment">// Child prop을 순회하면서</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> propName <span class="token keyword">in</span> childProps<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> slotPropValue <span class="token operator">=</span> slotProps<span class="token punctuation">[</span>propName<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> childPropValue <span class="token operator">=</span> childProps<span class="token punctuation">[</span>propName<span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> isHandler <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^on[A-Z]</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>propName<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// on으로 시작되는 이벤트 핸들러일 때</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>isHandler<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 둘 다 존재하는 경우 두 핸들러가 같이 실행될 수 있도록 합쳐준다</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>slotPropValue <span class="token operator">&amp;&amp;</span> childPropValue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        overrideProps<span class="token punctuation">[</span>propName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">unknown</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
          <span class="token function">childPropValue</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token function">slotPropValue</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token comment">// 만약 Slot에만 존재하면 그것만 사용한다</span>
      <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>slotPropValue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        overrideProps<span class="token punctuation">[</span>propName<span class="token punctuation">]</span> <span class="token operator">=</span> slotPropValue<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// style prop인 경우 Slot과 Child의 style을 합쳐준다</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>propName <span class="token operator">===</span> <span class="token string">'style'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      overrideProps<span class="token punctuation">[</span>propName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span>slotPropValue<span class="token punctuation">,</span> <span class="token operator">...</span>childPropValue <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// className prop도 마찬가지로 합쳐준다</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>propName <span class="token operator">===</span> <span class="token string">'className'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      overrideProps<span class="token punctuation">[</span>propName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>slotPropValue<span class="token punctuation">,</span> childPropValue<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>Boolean<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// slotProps과 앞서 만들어준 overrideProps를 합쳐준다</span>
  <span class="token comment">// Spread 연산자를 사용했기에 같은 이름이라면 overrideProps가 덮어쓴다</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token operator">...</span>slotProps<span class="token punctuation">,</span> <span class="token operator">...</span>overrideProps <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div></span>
<p>위 함수를 이용해 <span><code class="language-text">Slot</code></span> 컴포넌트를 수정해보자.</p>
<span><div class="gatsby-highlight" data-language="tsx"><pre class="language-tsx"><code class="language-tsx"><span class="token comment">/**
 * Slot.tsx
 */</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> Slot <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">forwardRef</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token punctuation">,</span> SlotProps<span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>props<span class="token punctuation">,</span> ref<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>slottable<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
    <span class="token keyword">return</span> React<span class="token punctuation">.</span><span class="token function">isValidElement</span><span class="token punctuation">(</span>newElement<span class="token punctuation">)</span>
      <span class="token operator">?</span> React<span class="token punctuation">.</span><span class="token function">cloneElement</span><span class="token punctuation">(</span>
          newElement<span class="token punctuation">,</span>
          <span class="token punctuation">{</span>
            <span class="token comment">// Slot의 prop과 자식 컴포넌트의 prop을 병합한다</span>
            <span class="token operator">...</span><span class="token function">mergeProps</span><span class="token punctuation">(</span>slotProps<span class="token punctuation">,</span> newElement<span class="token punctuation">.</span>props<span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">any</span><span class="token punctuation">,</span>
            ref<span class="token operator">:</span> ref <span class="token operator">?</span> <span class="token function">composeRefs</span><span class="token punctuation">(</span>ref<span class="token punctuation">,</span> <span class="token punctuation">(</span>newElement <span class="token keyword">as</span> <span class="token builtin">any</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ref<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token punctuation">(</span>newElement <span class="token keyword">as</span> <span class="token builtin">any</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ref<span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          newChildren
        <span class="token punctuation">)</span>
      <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>React<span class="token punctuation">.</span><span class="token function">isValidElement</span><span class="token punctuation">(</span>children<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> React<span class="token punctuation">.</span><span class="token function">cloneElement</span><span class="token punctuation">(</span>children<span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token comment">// 여기도 추가해준다</span>
      <span class="token operator">...</span><span class="token function">mergeProps</span><span class="token punctuation">(</span>slotProps<span class="token punctuation">,</span> children<span class="token punctuation">.</span>props<span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">any</span><span class="token punctuation">,</span>
      ref<span class="token operator">:</span> ref <span class="token operator">?</span> <span class="token function">composeRefs</span><span class="token punctuation">(</span>ref<span class="token punctuation">,</span> <span class="token punctuation">(</span>children <span class="token keyword">as</span> <span class="token builtin">any</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ref<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token punctuation">(</span>children <span class="token keyword">as</span> <span class="token builtin">any</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ref<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// ...</span>

  <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div></span>
<p>그리고 다음과 같은 코드로 테스트해보자.</p>
<span><div class="gatsby-highlight" data-language="tsx"><pre class="language-tsx"><code class="language-tsx"><span class="token comment">/**
 * App.tsx
 */</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> Button <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"./components/Button"</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">App</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span><span class="token comment">/* ... */</span><span class="token punctuation">}</span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Button</span></span> <span class="token attr-name">icon</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Icon</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">}</span></span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"Hi!"</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span> <span class="token attr-name">asChild</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"Hello!"</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span> <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>childRef<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">
          Show alert
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Button</span></span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> App<span class="token punctuation">;</span></code></pre></div></span>
<p>위 코드를 작성한 후 버튼을 클릭하면 두 번의 알림이 뜨는 것을 확인할 수 있다. 다만, 이러한 병합 규칙은 코드를 보는게 아니라면 알 수 없다. 따라서 이런 경우에는 만들어 둔 <strong>병합 함수의 규칙을 확실히 전파</strong>할 필요가 있다.</p>
<h1 id="polymorphic-vs-render-delegation"><a href="#polymorphic-vs-render-delegation">Polymorphic vs Render Delegation</a></h1>
<p>이전에 다룬 Polymorphic과 Render Delegation 중 어떤 것을 사용해야 할지 고민이 될 수 있다. 둘 다 해결하려는 목적은 비슷한지만 사용하는 방법이 다르고 각각 장단점이 있다.</p>
<p>가독성 측면에서 Render Delegation은 두 컴포넌트를 확실하게 분리하기 때문에 어디에 어떤 <span><code class="language-text">prop</code></span>이 사용되는지 확실하게 알 수 있다. 반면 Polymorphic은 컴포넌트를 하나로 통합하기 때문에 어떤 컴포넌트의 <span><code class="language-text">prop</code></span>인지 알기 어려운 경우가 있다. 그렇지만 컴포넌트 구성이 복잡하지 않고 완전 대체가 가능한 경우에는 Polymorphic이 더 간단하게 사용할 수 있다. 예를 들어, <span><code class="language-text">Header</code></span>라는 컴포넌트가 있고 <span><code class="language-text">as</code></span>를 사용하여 <span><code class="language-text">h1</code></span>로 변경하거나 <span><code class="language-text">h2</code></span>로 변경하는 경우에는 Polymorphic이 더 직관적일 수 있다.</p>
<p>그래서 필자가 생각하기에 Polymorphic은 <strong>컴포넌트 전체를 감싸는 것을 변경</strong>하는 경우에 적합하다. 예를 들어 버튼 컴포넌트에서 <span><code class="language-text">button</code></span>으로 사용되는 DOM을 <span><code class="language-text">a</code></span>로 변경하거나 <span><code class="language-text">input[type=submit]</code></span>으로 변경하는 것이  다. 반면 Render Delegation은 <strong>컴포넌트의 일부분을 위임</strong>하는 것에 적합하다.</p>
<p>이 외에도 몇 가지 논의할 주제가 있다. 타입 추론에 대한 성능이나 코드의 복잡도, 렌더링 속도 등이다. Polymorphic 컴포넌트는 타입 구성이 복잡하기에 투입 추론에 대한 성능이 느리다. 반면 Render Delegation은 그에 비해 간단하기 때문에 타입 추론이 빠르다. 이는 자동 완성 성능에도 영향이 있으므로 생산성에 영향을 미칠 수 있는 문제다. 이런 문제에 더 관심이 있다면 다음 링크도 한 번 살펴보면 좋다.</p>
<ul>
<li><a href="https://github.com/ariakit/ariakit/issues/1245" rel="nofollow noopener noreferrer">https://github.com/ariakit/ariakit/issues/1245</a></li>
<li><a href="https://sandroroth.com/blog/react-polymorphic-components/" rel="nofollow noopener noreferrer">https://sandroroth.com/blog/react-polymorphic-components/</a></li>
<li><a href="https://www.bekk.christmas/post/2023/01/polymorphism-in-react" rel="nofollow noopener noreferrer">https://www.bekk.christmas/post/2023/01/polymorphism-in-react</a></li>
</ul>
<h1 id="마치며"><a href="#마치며">마치며</a></h1>
<p>이전에 포스팅한 <span><code class="language-text">as</code></span>를 이용한 Polymorphic 컴포넌트와 <span><code class="language-text">asChild</code></span>를 이용하는 Slottable 컴포넌트는 각각 장단점이 있다. 따라서 무엇이 더 좋다면서 추종하는 것보단 다양한 패턴이 있음을 인지하고 상황에 따라 적절한 방법을 선택하여 사용하는 것이 중요하다. 참고로 이 포스팅을 통해 만들어진 최종적인 코드는 <a href="https://github.com/kciter/render-delegation-react-component-sample" rel="nofollow noopener noreferrer">GitHub 저장소</a>에서 확인할 수 있다.</p>
<section data-footnotes="true" class="footnotes"><h2 class="sr-only" id="footnote-label"><a href="#footnote-label">Footnotes</a></h2>
<ol>
<li id="user-content-fn-1">
<p>렌더링을 다른 컴포넌트에 맡기기 때문에 Render Delegation이라 부른다. <a href="#user-content-fnref-1" data-footnote-backref="true" class="data-footnote-backref" aria-label="Back to content">↩</a></p>
</li>
</ol>
</section></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/2024-02-18-render-delegation-react-component/";/*]]>*/</script><!-- slice-start id="_gatsby-scripts-1" -->
          <script
            id="gatsby-chunk-mapping"
          >
            window.___chunkMapping="{\"app\":[\"/app-181ef731bc215c1ed4f8.js\"],\"component---src-pages-404-tsx\":[\"/component---src-pages-404-tsx-d559859aa3bf46d4ff2f.js\"],\"component---src-pages-about-tsx\":[\"/component---src-pages-about-tsx-de78c5d21afadc2d1744.js\"],\"component---src-pages-bookshelf-tsx\":[\"/component---src-pages-bookshelf-tsx-0814feb292c7dcc38d31.js\"],\"component---src-pages-index-tsx\":[\"/component---src-pages-index-tsx-67ab7ee583730741cb77.js\"],\"component---src-pages-timeline-tsx\":[\"/component---src-pages-timeline-tsx-0c82243ce5b49f045693.js\"],\"component---src-posts-2021-02-23-first-post-md\":[\"/component---src-posts-2021-02-23-first-post-md-48eb465458c807d1f8f3.js\"],\"component---src-posts-2021-02-25-about-mongodb-mdx\":[\"/component---src-posts-2021-02-25-about-mongodb-mdx-73dcf3d38462c818db8f.js\"],\"component---src-posts-2021-02-28-basic-web-hacking-mdx\":[\"/component---src-posts-2021-02-28-basic-web-hacking-mdx-c95cd69a76b18fa59a84.js\"],\"component---src-posts-2021-03-14-effective-atomic-design-mdx\":[\"/component---src-posts-2021-03-14-effective-atomic-design-mdx-a02c682165922232446e.js\"],\"component---src-posts-2021-03-20-deep-dive-into-datetime-mdx\":[\"/component---src-posts-2021-03-20-deep-dive-into-datetime-mdx-ea81a7a99cf2af767ecd.js\"],\"component---src-posts-2022-08-05-programmers-brain-book-report-mdx\":[\"/component---src-posts-2022-08-05-programmers-brain-book-report-mdx-61eb2ece73f2ac9408d0.js\"],\"component---src-posts-2022-08-16-polymorphic-react-component-mdx\":[\"/component---src-posts-2022-08-16-polymorphic-react-component-mdx-29d95a3ef79142e4de0e.js\"],\"component---src-posts-2022-08-31-the-nature-of-software-development-book-report-mdx\":[\"/component---src-posts-2022-08-31-the-nature-of-software-development-book-report-mdx-e95d26fff582319f321a.js\"],\"component---src-posts-2022-09-08-software-master-book-report-mdx\":[\"/component---src-posts-2022-09-08-software-master-book-report-mdx-412dbbd939dd92f9ff73.js\"],\"component---src-posts-2022-09-18-crafting-esolang-mdx\":[\"/component---src-posts-2022-09-18-crafting-esolang-mdx-8905aeb2c2fd55a4e83f.js\"],\"component---src-posts-2023-05-03-spring-multi-module-architecture-mdx\":[\"/component---src-posts-2023-05-03-spring-multi-module-architecture-mdx-6bc8e5db7c8c7a08d607.js\"],\"component---src-posts-2023-07-10-effective-work-mdx\":[\"/component---src-posts-2023-07-10-effective-work-mdx-c9763d957eddcb676d52.js\"],\"component---src-posts-2023-07-17-railway-oriented-programming-mdx\":[\"/component---src-posts-2023-07-17-railway-oriented-programming-mdx-5f24bc7fce8afefa3084.js\"],\"component---src-posts-2023-07-24-functional-data-structure-mdx\":[\"/component---src-posts-2023-07-24-functional-data-structure-mdx-9b0cf0d9b37156ee9b93.js\"],\"component---src-posts-2023-11-08-retrace-my-life-mdx\":[\"/component---src-posts-2023-11-08-retrace-my-life-mdx-5e9f0513b80617047d15.js\"],\"component---src-posts-2023-12-05-what-is-beautiful-code-mdx\":[\"/component---src-posts-2023-12-05-what-is-beautiful-code-mdx-5a0b59beaf443f2022d6.js\"],\"component---src-posts-2023-12-24-developers-learning-and-growth-mdx\":[\"/component---src-posts-2023-12-24-developers-learning-and-growth-mdx-977f09483c7d9f764d38.js\"],\"component---src-posts-2024-01-21-type-driven-development-mdx\":[\"/component---src-posts-2024-01-21-type-driven-development-mdx-8545361e202375845c78.js\"],\"component---src-posts-2024-01-23-linear-method-mdx\":[\"/component---src-posts-2024-01-23-linear-method-mdx-ffdef13bb9294a5f8865.js\"],\"component---src-posts-2024-02-18-render-delegation-react-component-mdx\":[\"/component---src-posts-2024-02-18-render-delegation-react-component-mdx-1b3855fd7b0b2f1f48c3.js\"],\"component---src-posts-2024-03-03-ascii-3-d-renderer-mdx\":[\"/component---src-posts-2024-03-03-ascii-3-d-renderer-mdx-4592afe171ada690448e.js\"],\"component---src-posts-2024-03-16-principles-of-debugging-mdx\":[\"/component---src-posts-2024-03-16-principles-of-debugging-mdx-329d9e914c829ff63246.js\"],\"component---src-posts-2024-04-14-encrypted-vault-system-mdx\":[\"/component---src-posts-2024-04-14-encrypted-vault-system-mdx-02638d702d18c9275383.js\"],\"component---src-posts-2024-04-26-living-with-ai-mdx\":[\"/component---src-posts-2024-04-26-living-with-ai-mdx-870de1cb0ab975853f1a.js\"],\"component---src-posts-2024-05-10-the-shortcut-mdx\":[\"/component---src-posts-2024-05-10-the-shortcut-mdx-a5971875fe54c4c3c235.js\"],\"component---src-posts-2024-05-17-warp-and-weft-mdx\":[\"/component---src-posts-2024-05-17-warp-and-weft-mdx-5fde2887bc6ba8f1d270.js\"],\"component---src-posts-2024-06-08-log-1-mdx\":[\"/component---src-posts-2024-06-08-log-1-mdx-83b6b6ee17ee8e2bc5b3.js\"],\"component---src-posts-2024-06-09-log-2-mdx\":[\"/component---src-posts-2024-06-09-log-2-mdx-91c9dfefd6233d926fa2.js\"],\"component---src-posts-2024-06-10-log-3-mdx\":[\"/component---src-posts-2024-06-10-log-3-mdx-b6eabc8b35de919dde13.js\"],\"component---src-posts-2024-06-11-log-4-mdx\":[\"/component---src-posts-2024-06-11-log-4-mdx-b066912871a9696eafd7.js\"],\"component---src-posts-2024-06-12-log-5-mdx\":[\"/component---src-posts-2024-06-12-log-5-mdx-f1a084d83398731ce52e.js\"],\"component---src-posts-2024-06-13-log-6-mdx\":[\"/component---src-posts-2024-06-13-log-6-mdx-443cc3308084cb697dec.js\"],\"component---src-posts-2024-06-15-log-7-mdx\":[\"/component---src-posts-2024-06-15-log-7-mdx-8504b656bcff012e2410.js\"],\"component---src-posts-2024-06-18-log-8-mdx\":[\"/component---src-posts-2024-06-18-log-8-mdx-26d3dfcd3593af040100.js\"],\"component---src-posts-2024-07-09-best-prompt-engineering-lesson-mdx\":[\"/component---src-posts-2024-07-09-best-prompt-engineering-lesson-mdx-9023607897e44c8b1ea0.js\"],\"component---src-posts-2024-07-11-log-9-mdx\":[\"/component---src-posts-2024-07-11-log-9-mdx-b9473fbea253ade3a8dd.js\"],\"component---src-posts-2024-07-27-tidy-first-mdx\":[\"/component---src-posts-2024-07-27-tidy-first-mdx-2bc81ec7ade0a9e5a0f8.js\"],\"component---src-posts-2024-07-29-copybook-mdx\":[\"/component---src-posts-2024-07-29-copybook-mdx-10cf12236ead1cf089e5.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2021-02-23-first-post-md\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2021-02-23-first-post-md-3eb6de56dc6383bb7690.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2021-02-25-about-mongodb-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2021-02-25-about-mongodb-mdx-cc668e1a0ea77bbf7c6d.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2021-02-28-basic-web-hacking-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2021-02-28-basic-web-hacking-mdx-cf8da8239990b2132963.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2021-03-14-effective-atomic-design-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2021-03-14-effective-atomic-design-mdx-6dc07e7d9f16cd9ab769.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2021-03-20-deep-dive-into-datetime-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2021-03-20-deep-dive-into-datetime-mdx-27c2b6e238ad0f23abca.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2022-08-05-programmers-brain-book-report-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2022-08-05-programmers-brain-book-report-mdx-5890b0172ad575907f56.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2022-08-16-polymorphic-react-component-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2022-08-16-polymorphic-react-component-mdx-23b5e1e4d7ca7a24e997.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2022-08-31-the-nature-of-software-development-book-report-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2022-08-31-the-nature-of-software-development-book-report-mdx-77e457232a69d382ffe4.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2022-09-08-software-master-book-report-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2022-09-08-software-master-book-report-mdx-af99f7083770fe1baab7.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2022-09-18-crafting-esolang-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2022-09-18-crafting-esolang-mdx-c2f0f2fa6c6a2393dfce.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2023-05-03-spring-multi-module-architecture-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2023-05-03-spring-multi-module-architecture-mdx-9adc186507f823523c30.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2023-07-10-effective-work-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2023-07-10-effective-work-mdx-1910a8e3c61f02f5f1ea.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2023-07-17-railway-oriented-programming-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2023-07-17-railway-oriented-programming-mdx-9f6934347f2c3a44deba.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2023-07-24-functional-data-structure-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2023-07-24-functional-data-structure-mdx-119d137a207f43ab8d03.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2023-11-08-retrace-my-life-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2023-11-08-retrace-my-life-mdx-369019c18bfc2c055293.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2023-12-05-what-is-beautiful-code-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2023-12-05-what-is-beautiful-code-mdx-696a401e93825c3e3101.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2023-12-24-developers-learning-and-growth-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2023-12-24-developers-learning-and-growth-mdx-ded3f4f814ad0f5b28c3.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2024-01-21-type-driven-development-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2024-01-21-type-driven-development-mdx-3262ea7f6e4232f76a2d.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2024-01-23-linear-method-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2024-01-23-linear-method-mdx-679a2a154b0a448ad8b5.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2024-02-18-render-delegation-react-component-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2024-02-18-render-delegation-react-component-mdx-60976e5b2aabcf313dd3.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2024-03-03-ascii-3-d-renderer-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2024-03-03-ascii-3-d-renderer-mdx-f4b4804bce4a888eb598.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2024-03-16-principles-of-debugging-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2024-03-16-principles-of-debugging-mdx-1baed8ca8a1644a9b2fa.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2024-04-14-encrypted-vault-system-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2024-04-14-encrypted-vault-system-mdx-aaa2215d1f5ef7a79f95.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2024-04-26-living-with-ai-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2024-04-26-living-with-ai-mdx-c9490af3242a45b06ab2.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2024-05-10-the-shortcut-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2024-05-10-the-shortcut-mdx-0b94e15fb46ff90ec092.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2024-05-17-warp-and-weft-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2024-05-17-warp-and-weft-mdx-814c7d44392778698eb5.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2024-06-08-log-1-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2024-06-08-log-1-mdx-295c51d307ff95131737.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2024-06-09-log-2-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2024-06-09-log-2-mdx-8a4a5f02be3c66451007.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2024-06-10-log-3-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2024-06-10-log-3-mdx-a36928e6293089e25cee.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2024-06-11-log-4-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2024-06-11-log-4-mdx-08670079b3ef4a714da0.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2024-06-12-log-5-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2024-06-12-log-5-mdx-6186308ab97526497f5e.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2024-06-13-log-6-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2024-06-13-log-6-mdx-57222ec7d7fbf3c3e4e3.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2024-06-15-log-7-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2024-06-15-log-7-mdx-e373656cb70e03326e04.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2024-06-18-log-8-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2024-06-18-log-8-mdx-9cfe74e01f53022d76bd.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2024-07-09-best-prompt-engineering-lesson-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2024-07-09-best-prompt-engineering-lesson-mdx-be136b794d81fbbc3cb9.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2024-07-11-log-9-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2024-07-11-log-9-mdx-284456ea10bd2c3ffabf.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2024-07-27-tidy-first-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2024-07-27-tidy-first-mdx-18df134191fbaf5dbe17.js\"],\"component---src-templates-post-tsx-content-file-path-src-posts-2024-07-29-copybook-mdx\":[\"/component---src-templates-post-tsx-content-file-path-src-posts-2024-07-29-copybook-mdx-579b0b7a8c28ada0bfee.js\"]}";
          </script>
        <script>window.___webpackCompilationHash="26dc746f575bc3217c84";</script><script src="/webpack-runtime-955c70d3bd54e4c4c0b4.js" async></script><script src="/app-181ef731bc215c1ed4f8.js" async></script><!-- slice-end id="_gatsby-scripts-1" --></body></html>