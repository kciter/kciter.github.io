<!DOCTYPE html><html lang="ko"> <head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="robots" content="index,follow"><meta name="googlebot" content="index,follow"><meta name="color-scheme" content="light"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="manifest" href="/manifest.webmanifest"><link rel="alternate" type="application/rss+xml" title="kciter.so" href="/feed.xml"><title>모델링 시리즈: 측도 | kciter.so</title><meta name="description" content="들어가며 소프트웨어는 다양한 데이터를 다루는 복잡한 시스템이다. 이러한 데이터는 단순히 숫자나 문자열로 표현되는 것이 아니라, 그 자체로 의미를 가지며, 이를 잘 이해하고 활용하는 것이 소프트웨어 개발의 핵심이다. 이번 글에서는 이러한 데이터의…"><meta name="author" content="Lee Sun-Hyoup"><!-- Open Graph --><meta property="og:title" content="모델링 시리즈: 측도 | kciter.so"><meta property="og:description" content="들어가며 소프트웨어는 다양한 데이터를 다루는 복잡한 시스템이다. 이러한 데이터는 단순히 숫자나 문자열로 표현되는 것이 아니라, 그 자체로 의미를 가지며, 이를 잘 이해하고 활용하는 것이 소프트웨어 개발의 핵심이다. 이번 글에서는 이러한 데이터의…"><meta property="og:type" content="website"><meta property="og:site_name" content="kciter.so"><meta property="og:locale" content="ko_KR"><meta property="og:image" content="https://kciter.so/images/2025-05-02-modeling-series-measure/thumbnail.png"><meta property="og:url" content="https://kciter.so/posts/modeling-series-measure/"><link rel="canonical" href="https://kciter.so/posts/modeling-series-measure/"><!-- Twitter --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="Sunhyoup Lee"><meta name="twitter:title" content="모델링 시리즈: 측도 | kciter.so"><meta name="twitter:description" content="들어가며 소프트웨어는 다양한 데이터를 다루는 복잡한 시스템이다. 이러한 데이터는 단순히 숫자나 문자열로 표현되는 것이 아니라, 그 자체로 의미를 가지며, 이를 잘 이해하고 활용하는 것이 소프트웨어 개발의 핵심이다. 이번 글에서는 이러한 데이터의…"><meta name="twitter:image" content="https://kciter.so/images/2025-05-02-modeling-series-measure/thumbnail.png"><!-- Additional meta from props --><meta name="article:published_time" content="2025-05-02T00:00:00+09:00"><meta name="image" content="https://kciter.so/images/2025-05-02-modeling-series-measure/thumbnail.png"><meta property="og:image" content="https://kciter.so/images/2025-05-02-modeling-series-measure/thumbnail.png"><meta property="og:image:secure_url" content="https://kciter.so/images/2025-05-02-modeling-series-measure/thumbnail.png"><!-- Fonts --><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=PT+Serif:ital,wght@0,400;0,700;1,400&family=PT+Sans:wght@400&family=Source+Code+Pro&family=Quattrocento+Sans&display=swap"><!-- Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-7M8K7EBEDX"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag('js', new Date());
      gtag('config', 'G-7M8K7EBEDX');
    </script> <script type="application/ld+json">{"headline":"모델링 시리즈: 측도","dateModified":"2025-05-02T00:00:00+09:00","datePublished":"2025-05-02T00:00:00+09:00","image":"https://kciter.so/images/2025-05-02-modeling-series-measure/thumbnail.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://kciter.so/posts/modeling-series-measure/"},"author":{"@type":"Person","name":"Lee Sun-Hyoup"},"description":"들어가며 소프트웨어는 다양한 데이터를 다루는 복잡한 시스템이다. 이러한 데이터는 단순히 숫자나 문자열로 표현되는 것이 아니라, 그 자체로 의미를 가지며, 이를 잘 이해하고 활용하는 것이 소프트웨어 개발의 핵심이다. 이번 글에서는 이러한 데이터의…","url":"https://kciter.so/posts/modeling-series-measure/","@type":"BlogPosting","@context":"https://schema.org"}</script> <link rel="stylesheet" href="/_astro/_slug_.CNFATi3L.css">
<style>.name-gradient[data-astro-cid-k7qsseos]{background:linear-gradient(to right,#191335,#191335 33.33333%,#00ab6c 66.66666%,#00cb8c);background-clip:text;-webkit-text-fill-color:transparent;transition:all .3s ease;background-size:300% 100%;background-position:top left}.name-gradient[data-astro-cid-k7qsseos]:hover{background-position:top left 100%}@media(max-width:30rem){.sponsors[data-astro-cid-4kgnabjz] a:not(:first-of-type){margin-left:-16px}}.related-post[data-astro-cid-llggujpl]{position:relative;transform:scaleZ(1)}.related-post[data-astro-cid-llggujpl]:after{position:absolute;top:0;left:0;width:100%;height:100%;border-radius:8px;transform:scale(1.06);transition:opacity 2s cubic-bezier(.165,.84,.44,1);box-shadow:0 8px 17px #0003,0 6px 20px #00000026;content:"";opacity:0;z-index:-1}.related-post[data-astro-cid-llggujpl]:hover{transform:scale3d(1.006,1.006,1)}.related-post[data-astro-cid-llggujpl]:hover:after{opacity:1}
</style></head> <body> <div class="mx-auto w-[715px] pt-4 max-md:w-[90vw]"> <div class="relative z-10 mb-10 -mx-4 rounded-xl bg-white/40 px-4 py-2.5 font-['Quattrocento_Sans',sans-serif] backdrop-blur-[44px] max-md:-mx-4 max-md:-mt-4 max-md:mb-8 max-md:rounded-none max-md:bg-transparent max-md:backdrop-blur-none" data-astro-cid-3ef6ksr2> <div class="mt-2 w-full" data-astro-cid-3ef6ksr2> <a href="/" class="site-title text-[32px] font-black" style="line-height: 1.15; text-decoration: none; margin-right: 5px;" data-astro-cid-3ef6ksr2>kciter.so</a> <small class="text-[#999]" data-astro-cid-3ef6ksr2>devlog</small> </div> <nav class="flex w-full justify-between pt-2" data-astro-cid-3ef6ksr2> <div class="flex items-center" data-astro-cid-3ef6ksr2> <a href="/timeline/" class="menu-item updated" data-astro-cid-3ef6ksr2>
Timeline
</a> <div class="dropdown" data-astro-cid-3ef6ksr2> <span class="menu-item dropdown-trigger" id="posts-trigger" data-astro-cid-3ef6ksr2>
Posts <span class="chevron" data-astro-cid-3ef6ksr2>&#9662;</span> </span> <div class="dropdown-menu" data-astro-cid-3ef6ksr2> <a href="/articles/" class="dropdown-item" data-astro-cid-3ef6ksr2>Articles</a> <a href="/bookshelf/" class="dropdown-item" data-astro-cid-3ef6ksr2>Bookshelf</a> <a href="/thought/" class="dropdown-item" data-astro-cid-3ef6ksr2>Thoughts</a> </div> </div> <a href="https://kciter.so/talks/" class="menu-item" data-astro-cid-3ef6ksr2>Talks</a> <a href="/about/" class="menu-item" data-astro-cid-3ef6ksr2>About</a> </div> <div class="flex items-center gap-3" data-astro-cid-3ef6ksr2> <button id="search-btn" class="search-btn" aria-label="Search" data-astro-cid-3ef6ksr2> <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-astro-cid-3ef6ksr2> <circle cx="11" cy="11" r="8" data-astro-cid-3ef6ksr2></circle> <line x1="21" y1="21" x2="16.65" y2="16.65" data-astro-cid-3ef6ksr2></line> </svg> </button> <div class="max-md:hidden" data-astro-cid-3ef6ksr2> <a href="https://github.com/kciter" target="_blank" rel="noopener noreferrer" class="social-icon inline-block p-[5px] no-underline" aria-label="GitHub" style="--hover-color: #343434; transition: color .5s; margin-right: 5px;" data-astro-cid-yxtifmrq><svg class="inline-block h-4 w-4" viewBox="0 0 24 24" fill="currentColor" data-astro-cid-yxtifmrq><path d="M12 0C5.37 0 0 5.37 0 12c0 5.3 3.44 9.8 8.2 11.38.6.12.83-.26.83-.57v-2.2c-3.34.73-4.04-1.44-4.04-1.44-.55-1.38-1.33-1.75-1.33-1.75-1.09-.74.08-.73.08-.73 1.2.09 1.84 1.24 1.84 1.24 1.07 1.83 2.8 1.3 3.49 1 .1-.78.42-1.3.76-1.6-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.13-.3-.54-1.52.12-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6.02 0c2.28-1.55 3.28-1.23 3.28-1.23.66 1.66.25 2.88.12 3.18.77.84 1.24 1.91 1.24 3.22 0 4.61-2.81 5.63-5.48 5.92.43.37.81 1.1.81 2.22v3.29c0 .31.22.7.83.57C20.57 21.8 24 17.3 24 12c0-6.63-5.37-12-12-12z"/></svg></a><a href="https://www.facebook.com/sunhyoup.lee" target="_blank" rel="noopener noreferrer" class="social-icon inline-block p-[5px] no-underline" aria-label="Facebook" style="--hover-color: #3d5b99; transition: color .5s; margin-right: 5px;" data-astro-cid-yxtifmrq><svg class="inline-block h-4 w-4" viewBox="0 0 24 24" fill="currentColor" data-astro-cid-yxtifmrq><path d="M24 12.07C24 5.41 18.63 0 12 0S0 5.41 0 12.07c0 6.02 4.39 11.02 10.13 11.93v-8.44H7.08v-3.49h3.04V9.41c0-3.02 1.79-4.68 4.53-4.68 1.31 0 2.68.24 2.68.24v2.97h-1.51c-1.49 0-1.95.93-1.95 1.88v2.26h3.33l-.53 3.49h-2.8v8.44C19.61 23.09 24 18.09 24 12.07z"/></svg></a><a href="https://www.linkedin.com/in/kciter" target="_blank" rel="noopener noreferrer" class="social-icon inline-block p-[5px] no-underline" aria-label="LinkedIn" style="--hover-color: #0073a4; transition: color .5s; margin-right: 5px;" data-astro-cid-yxtifmrq><svg class="inline-block h-4 w-4" viewBox="0 0 24 24" fill="currentColor" data-astro-cid-yxtifmrq><path d="M20.45 20.45h-3.55v-5.57c0-1.33-.02-3.04-1.85-3.04-1.85 0-2.14 1.45-2.14 2.94v5.67H9.36V9h3.41v1.56h.05c.48-.9 1.64-1.85 3.37-1.85 3.6 0 4.27 2.37 4.27 5.46v6.28zM5.34 7.43a2.06 2.06 0 1 1 0-4.12 2.06 2.06 0 0 1 0 4.12zM7.12 20.45H3.56V9h3.56v11.45zM22.22 0H1.77C.79 0 0 .77 0 1.72v20.56C0 23.23.79 24 1.77 24h20.45C23.2 24 24 23.23 24 22.28V1.72C24 .77 23.2 0 22.22 0z"/></svg></a><a href="https://twitter.com/kciter" target="_blank" rel="noopener noreferrer" class="social-icon inline-block p-[5px] no-underline" aria-label="X (Twitter)" style="--hover-color: #343434; transition: color .5s; margin-right: 5px;" data-astro-cid-yxtifmrq><svg class="inline-block h-4 w-4" viewBox="0 0 24 24" fill="currentColor" data-astro-cid-yxtifmrq><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg></a><a href="/feed.xml" target="_blank" rel="noopener noreferrer" class="social-icon inline-block p-[5px] no-underline" aria-label="RSS Feed" style="--hover-color: #ff6600; transition: color .5s;" data-astro-cid-yxtifmrq><svg class="inline-block h-4 w-4" viewBox="0 0 24 24" fill="currentColor" data-astro-cid-yxtifmrq><path d="M6.18 15.64a2.18 2.18 0 1 1 0 4.36 2.18 2.18 0 0 1 0-4.36zM4 4.44v3.57A12.01 12.01 0 0 1 15.99 20h3.57A15.57 15.57 0 0 0 4 4.44zM4 10.1v3.57c3.5 0 6.33 2.84 6.33 6.33h3.57c0-5.47-4.43-9.9-9.9-9.9z"/></svg></a> </div> </div> </nav> <!-- Mobile sub-tab (hidden by default) --> <div class="mobile-tabs" id="mobile-tabs" data-astro-cid-3ef6ksr2> <a href="/articles/" class="mobile-tab" data-astro-cid-3ef6ksr2>Articles</a> <a href="/bookshelf/" class="mobile-tab" data-astro-cid-3ef6ksr2>Bookshelf</a> <a href="/thought/" class="mobile-tab" data-astro-cid-3ef6ksr2>Thoughts</a> </div> </div> <!-- Search Modal --> <div id="search-modal" class="search-modal" data-astro-cid-3ef6ksr2> <div class="search-backdrop" data-astro-cid-3ef6ksr2></div> <div class="search-container" data-astro-cid-3ef6ksr2> <div class="search-input-wrap" data-astro-cid-3ef6ksr2> <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#999" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-astro-cid-3ef6ksr2> <circle cx="11" cy="11" r="8" data-astro-cid-3ef6ksr2></circle> <line x1="21" y1="21" x2="16.65" y2="16.65" data-astro-cid-3ef6ksr2></line> </svg> <input id="search-input" type="text" placeholder="Search posts..." autocomplete="off" data-astro-cid-3ef6ksr2> <kbd class="search-kbd" data-astro-cid-3ef6ksr2>ESC</kbd> </div> <div id="search-results" class="search-results" data-astro-cid-3ef6ksr2></div> </div> </div>  <script type="module">const o=document.getElementById("posts-trigger"),l=document.getElementById("mobile-tabs");if(o&&l){const e=o.querySelector(".chevron");o.addEventListener("click",t=>{window.innerWidth<=768&&(t.preventDefault(),l.classList.toggle("open"),e?.classList.toggle("open"))});const i=window.location.pathname;l.querySelectorAll(".mobile-tab").forEach(t=>{i.startsWith(t.getAttribute("href")||"")&&t.classList.add("active")})}let s=null;async function m(){if(s)return s;try{s=await import(new URL("/pagefind/pagefind.js",window.location.origin).href),await s.init()}catch{console.warn("Pagefind not available (run build first)")}return s}const c=document.getElementById("search-modal"),r=document.getElementById("search-input"),a=document.getElementById("search-results"),p=document.getElementById("search-btn"),v=c.querySelector(".search-backdrop");function f(){c.classList.add("open"),r.value="",a.innerHTML="",setTimeout(()=>r.focus(),50),m()}function d(){c.classList.remove("open")}p.addEventListener("click",f);v.addEventListener("click",d);document.addEventListener("keydown",e=>{(e.metaKey||e.ctrlKey)&&e.key==="k"&&(e.preventDefault(),c.classList.contains("open")?d():f()),e.key==="Escape"&&d()});let u;r.addEventListener("input",()=>{clearTimeout(u),u=setTimeout(()=>g(r.value),200)});async function g(e){if(!e.trim()){a.innerHTML="";return}const i=await m();if(!i){a.innerHTML='<div class="search-no-results">Search is not available in dev mode.</div>';return}const t=await i.search(e);if(t.results.length===0){a.innerHTML='<div class="search-no-results">No results found.</div>';return}const h=await Promise.all(t.results.slice(0,10).map(n=>n.data()));a.innerHTML=h.map(n=>`
        <a href="${n.url}" class="search-result-item">
          <div class="search-result-title">${n.meta?.title||n.url}</div>
          <div class="search-result-excerpt">${n.excerpt}</div>
        </a>
      `).join("")}</script> <div class="post-container">   <h1 class="post-title">모델링 시리즈: 측도</h1> <span class="post-date">Written on May 2, 2025</span> <img src="/images/2025-05-02-modeling-series-measure/thumbnail.png" alt="모델링 시리즈: 측도" style="width: 100%;"><div class="toc" data-margin-top="50"><ul class="toc-list"><li><a href="#들어가며">들어가며</a></li><li><a href="#추상화된-것을-구체화하기">추상화된 것을 구체화하기</a></li><li><a href="#측도-모델링">측도 모델링</a><ul class="toc-list"><li><a href="#값과-단위">값과 단위</a></li><li><a href="#수량">수량</a></li><li><a href="#화폐">화폐</a></li></ul></li><li><a href="#수학적-측도">수학적 측도</a></li><li><a href="#복합-측도와-파생-측도">복합 측도와 파생 측도</a><ul class="toc-list"><li><a href="#복합-측도">복합 측도</a></li><li><a href="#파생-측도">파생 측도</a></li></ul></li><li><a href="#마치며">마치며</a></li></ul></div><div class="mt-2 box-border w-full rounded-lg bg-[#f8f9fa] p-4"> <div class="mb-2 text-xl font-bold">모델링 시리즈</div> <ul style="margin: 0; padding: 0; padding-left: 24px;"> <li style> <a href="/posts/modeling-series-foreword/" style="text-decoration: none; color: #333;"> 모델링 시리즈: 서문 </a> </li><li style> <a href="/posts/modeling-series-view-model/" style="text-decoration: none; color: #333;"> 모델링 시리즈: 뷰모델 </a> </li><li style> <a href="/posts/modeling-series-conditional-tree/" style="text-decoration: none; color: #333;"> 모델링 시리즈: 조건 트리 </a> </li><li style="color: #00a962;"> <a href="/posts/modeling-series-measure/" style="text-decoration: none; color: #333; font-weight: bold;"> 모델링 시리즈: 측도 </a> </li><li style> <a href="/posts/modeling-series-temporal/" style="text-decoration: none; color: #333;"> 모델링 시리즈: 시간 </a> </li> </ul> </div><div class="post-content" data-pagefind-body>  <h1 id="들어가며"><a href="#들어가며">들어가며</a></h1>
<p>소프트웨어는 다양한 데이터를 다루는 복잡한 시스템이다. 이러한 데이터는 단순히 숫자나 문자열로 표현되는 것이 아니라, 그 자체로 의미를 가지며, 이를 잘 이해하고 활용하는 것이 소프트웨어 개발의 핵심이다. 이번 글에서는 이러한 데이터의 양이나 크기를 정량적으로 표현하는 방법인 측도(Measure)에 대해 알아보겠다.</p>
<p>먼저 측도라는 단어가 생소하게 느껴질 수 있다. 측도는 데이터의 양이나 크기를 정량적으로 표현하는 방법을 말한다. 수학적으로는 개수, 길이, 넓이, 부피 등의 개념을 추상화한 것을 말한다. 예를 들어, 마리, 권, 그루, 다스와 같은 수량 개념부터 cm, kg, mL와 같은 단위, 달러나 엔과 같은 화폐까지 모두 측도의 일종이다. 좀 더 나아간다면 바퀴, 번과 같은 횟수 개념도 측도로 볼 수 있다.</p>
<p>이러한 측도는 비즈니스 관점에서 중요하다. 물건을 판매한다면 가격과 수량을 표현해야 하고, 글로벌 서비스를 한다면 다양한 화폐 단위를 다룰 수 있어야 한다. 또한, 단위 변환과 연산에 대한 고려도 필요하다. 예를 들어, 미국에서 판매되는 제품의 가격을 한국 원화로 변환해야 하거나, 세금이나 수수료 등을 고려하여 계산해줄 수도 있다.</p>
<h1 id="추상화된-것을-구체화하기"><a href="#추상화된-것을-구체화하기">추상화된 것을 구체화하기</a></h1>
<p>우리는 숫자를 코드로 표현하고 싶을 때 <code>Int</code>나 <code>Float</code>와 같은 기본 자료형을 사용한다. 하지만 이러한 기본 자료형은 단순히 숫자일 뿐, 그 자체로 의미를 가지지 않는다. 예를 들어, <code>100</code>이라는 숫자는 단순한 정수일 뿐이라 무게인지 길이인지 알 수 없다. 그래서 보통 다음과 같이 변수명에 의존하여 의미를 부여한다.</p>
<pre class="astro-code github-light" style="background-color:#fff;color:#24292e;overflow-x:auto" tabindex="0" data-language="kotlin"><code><span class="line"><span style="color:#D73A49">val</span><span style="color:#24292E"> weight: </span><span style="color:#6F42C1">Int</span><span style="color:#D73A49"> =</span><span style="color:#005CC5"> 100</span><span style="color:#6A737D"> // 무게</span></span>
<span class="line"><span style="color:#D73A49">val</span><span style="color:#24292E"> length: </span><span style="color:#6F42C1">Int</span><span style="color:#D73A49"> =</span><span style="color:#005CC5"> 100</span><span style="color:#6A737D"> // 길이</span></span></code></pre>
<p>하지만 이러한 방식은 실수할 여지가 많다. <code>Int</code>라는 타입은 아무 숫자나 받을 수 있기 때문에, 잘못된 값을 넣을 수도 있다. 이를 방지하기 위해서 코드 리뷰나 테스트를 통해 확인할 수 있지만, 이런 단순한 문제로 생산성을 떨어뜨리는 것은 바람직하지 않다. 따라서 실수를 방지하기 위해 별도 타입을 만들 수 있다. 예를 들어, 무게를 표현하기 위해 <code>Weight</code>라는 클래스를 만들고, 이를 사용하여 무게를 표현할 수 있다.</p>
<pre class="astro-code github-light" style="background-color:#fff;color:#24292e;overflow-x:auto" tabindex="0" data-language="kotlin"><code><span class="line"><span style="color:#D73A49">class</span><span style="color:#6F42C1"> Weight</span><span style="color:#24292E">(</span><span style="color:#D73A49">val</span><span style="color:#D73A49"> value</span><span style="color:#24292E">: </span><span style="color:#6F42C1">Int</span><span style="color:#24292E">) {</span></span>
<span class="line"><span style="color:#D73A49">  init</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#6F42C1">    require</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#D73A49"> &gt;=</span><span style="color:#005CC5"> 0</span><span style="color:#24292E">) { </span><span style="color:#032F62">&quot;Weight must be positive&quot;</span><span style="color:#24292E"> }</span></span>
<span class="line"><span style="color:#24292E">  }</span></span>
<span class="line"><span style="color:#24292E">}</span></span>
<span class="line"><span style="color:#D73A49">val</span><span style="color:#24292E"> weight </span><span style="color:#D73A49">=</span><span style="color:#6F42C1"> Weight</span><span style="color:#24292E">(</span><span style="color:#005CC5">100</span><span style="color:#24292E">) </span><span style="color:#6A737D">// 무게</span></span></code></pre>
<p>위와 같이 <code>Weight</code>라는 클래스를 만들면, 무게를 표현할 때는 항상 <code>Weight</code> 타입을 사용해야 하므로 실수를 방지할 수 있다. 또한, 클래스에 다양한 연산을 추가하여 무게에 대한 연산을 쉽게 수행할 수 있다.</p>
<pre class="astro-code github-light" style="background-color:#fff;color:#24292e;overflow-x:auto" tabindex="0" data-language="kotlin"><code><span class="line"><span style="color:#D73A49">class</span><span style="color:#6F42C1"> Weight</span><span style="color:#24292E">(</span><span style="color:#D73A49">val</span><span style="color:#D73A49"> value</span><span style="color:#24292E">: </span><span style="color:#6F42C1">Int</span><span style="color:#24292E">) {</span></span>
<span class="line"><span style="color:#D73A49">  init</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#6F42C1">    require</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#D73A49"> &gt;=</span><span style="color:#005CC5"> 0</span><span style="color:#24292E">) { </span><span style="color:#032F62">&quot;Weight must be positive&quot;</span><span style="color:#24292E"> }</span></span>
<span class="line"><span style="color:#24292E">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">  operator</span><span style="color:#D73A49"> fun</span><span style="color:#6F42C1"> plus</span><span style="color:#24292E">(other: </span><span style="color:#6F42C1">Weight</span><span style="color:#24292E">): </span><span style="color:#6F42C1">Weight</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#D73A49">    return</span><span style="color:#6F42C1"> Weight</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#D73A49"> +</span><span style="color:#24292E"> other.</span><span style="color:#D73A49">value</span><span style="color:#24292E">)</span></span>
<span class="line"><span style="color:#24292E">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">  operator</span><span style="color:#D73A49"> fun</span><span style="color:#6F42C1"> minus</span><span style="color:#24292E">(other: </span><span style="color:#6F42C1">Weight</span><span style="color:#24292E">): </span><span style="color:#6F42C1">Weight</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#D73A49">    return</span><span style="color:#6F42C1"> Weight</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#D73A49"> -</span><span style="color:#24292E"> other.</span><span style="color:#D73A49">value</span><span style="color:#24292E">)</span></span>
<span class="line"><span style="color:#24292E">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">  operator</span><span style="color:#D73A49"> fun</span><span style="color:#6F42C1"> times</span><span style="color:#24292E">(scalar: </span><span style="color:#6F42C1">Int</span><span style="color:#24292E">): </span><span style="color:#6F42C1">Weight</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#D73A49">    return</span><span style="color:#6F42C1"> Weight</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#D73A49"> *</span><span style="color:#24292E"> scalar)</span></span>
<span class="line"><span style="color:#24292E">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">  operator</span><span style="color:#D73A49"> fun</span><span style="color:#6F42C1"> div</span><span style="color:#24292E">(scalar: </span><span style="color:#6F42C1">Int</span><span style="color:#24292E">): </span><span style="color:#6F42C1">Weight</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#D73A49">    return</span><span style="color:#6F42C1"> Weight</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#D73A49"> /</span><span style="color:#24292E"> scalar)</span></span>
<span class="line"><span style="color:#24292E">  }</span></span>
<span class="line"><span style="color:#24292E">}</span></span>
<span class="line"><span style="color:#D73A49">val</span><span style="color:#24292E"> weight1 </span><span style="color:#D73A49">=</span><span style="color:#6F42C1"> Weight</span><span style="color:#24292E">(</span><span style="color:#005CC5">100</span><span style="color:#24292E">)</span></span>
<span class="line"><span style="color:#D73A49">val</span><span style="color:#24292E"> weight2 </span><span style="color:#D73A49">=</span><span style="color:#6F42C1"> Weight</span><span style="color:#24292E">(</span><span style="color:#005CC5">200</span><span style="color:#24292E">)</span></span>
<span class="line"><span style="color:#D73A49">val</span><span style="color:#24292E"> totalWeight </span><span style="color:#D73A49">=</span><span style="color:#24292E"> weight1 </span><span style="color:#D73A49">+</span><span style="color:#24292E"> weight2 </span><span style="color:#6A737D">// 300</span></span>
<span class="line"><span style="color:#D73A49">val</span><span style="color:#24292E"> halfWeight </span><span style="color:#D73A49">=</span><span style="color:#24292E"> weight1 </span><span style="color:#D73A49">/</span><span style="color:#005CC5"> 2</span><span style="color:#6A737D"> // 50</span></span></code></pre>
<p>이러한 객체를 DDD(도메인 주도 설계)에서는 값 객체(Value Object)라고 부른다. 값 객체는 단순히 숫자나 문자열을 감싸는 것이 아니라, 그 자체로 의미를 가지는 객체를 말한다.</p>
<p>측도에 대한 모델링은 이런 개념에서 시작된다. 추상화된 값을 구체화하여 의미를 부여하고, 이를 통해 코드의 가독성을 높이고 실수를 방지하며, 비즈니스에 필요한 다양한 연산을 추가할 수 있다.</p>
<h1 id="측도-모델링"><a href="#측도-모델링">측도 모델링</a></h1>
<p>앞서 구현한 값 객체를 이용할 수도 있지만, 조금 더 범용적으로 모델을 만드는 것도 가능하다. 단순히 무게나 길이와 같은 개별 타입을 만드는 것이 아니라, 모든 측도에 공통으로 적용할 수 있는 추상화된 모델을 구현해보자.</p>
<h2 id="값과-단위"><a href="#값과-단위">값과 단위</a></h2>
<p>측도 시스템을 구현할 때 가장 기본이 되는 것은 ‘값(Value)‘과 ‘단위(Unit)‘의 개념이다. 모든 측도는 값과 단위의 조합으로 표현할 수 있다. 예를 들어 “5kg”는 값이 5이고 단위가 킬로그램인 측도이다.</p>
<p>그리고 단위는 연관성이 있는 단위들끼리 변환이 가능하다. 예를 들어 킬로그램(kg)과 그램(g)은 서로 변환이 가능하다. 이러한 단위 간의 변환을 지원하기 위해서는 별도로 단위계를 정의할 수 있어야 한다. 이와 같은 요구사항을 기반으로 다음과 같이 다이어그램을 그려볼 수 있다.</p>
<figure><img src="/images/2025-05-02-modeling-series-measure/measure-diagram.png" alt="" loading="lazy" width="100%" style="cursor:default;max-width:340px;margin:0 auto;display:block"/></figure>
<p>우리는 전체 측도 모델에 대한 기본 구조를 위와 같이 정의할 것이다. <code>Measure</code>는 모든 측도를 표현하는 모델이며, <code>Unit</code>은 단위를 표현하는 모델이다. 그리고 <code>UnitSystem</code>은 특정 종류의 측도에 사용할 수 있는 모든 단위들의 집합을 관리하는 시스템이다. 이 구조를 기반으로 측도 모델을 구현해보자.</p>
<pre class="astro-code github-light" style="background-color:#fff;color:#24292e;overflow-x:auto" tabindex="0" data-language="kotlin"><code><span class="line"><span style="color:#D73A49">interface</span><span style="color:#6F42C1"> Measure</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">T</span><span style="color:#24292E"> : </span><span style="color:#6F42C1">Measure</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">T</span><span style="color:#24292E">&gt;&gt; : </span><span style="color:#6F42C1">Comparable</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">T</span><span style="color:#24292E">&gt; {</span></span>
<span class="line"><span style="color:#D73A49">  val</span><span style="color:#D73A49"> value</span><span style="color:#24292E">: </span><span style="color:#6F42C1">BigDecimal</span></span>
<span class="line"><span style="color:#D73A49">  val</span><span style="color:#24292E"> unit: </span><span style="color:#6F42C1">MeasurementUnit</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">T</span><span style="color:#24292E">&gt;</span></span>
<span class="line"><span style="color:#24292E">  </span></span>
<span class="line"><span style="color:#D73A49">  fun</span><span style="color:#6F42C1"> convertTo</span><span style="color:#24292E">(targetUnit: </span><span style="color:#6F42C1">MeasurementUnit</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">T</span><span style="color:#24292E">&gt;): </span><span style="color:#6F42C1">T</span></span>
<span class="line"><span style="color:#D73A49">  fun</span><span style="color:#6F42C1"> add</span><span style="color:#24292E">(other: </span><span style="color:#6F42C1">T</span><span style="color:#24292E">): </span><span style="color:#6F42C1">T</span></span>
<span class="line"><span style="color:#D73A49">  fun</span><span style="color:#6F42C1"> subtract</span><span style="color:#24292E">(other: </span><span style="color:#6F42C1">T</span><span style="color:#24292E">): </span><span style="color:#6F42C1">T</span></span>
<span class="line"><span style="color:#D73A49">  fun</span><span style="color:#6F42C1"> multiply</span><span style="color:#24292E">(factor: </span><span style="color:#6F42C1">BigDecimal</span><span style="color:#24292E">): </span><span style="color:#6F42C1">T</span></span>
<span class="line"><span style="color:#D73A49">  fun</span><span style="color:#6F42C1"> divide</span><span style="color:#24292E">(divisor: </span><span style="color:#6F42C1">BigDecimal</span><span style="color:#24292E">): </span><span style="color:#6F42C1">T</span></span>
<span class="line"><span style="color:#24292E">}</span></span></code></pre>
<p>위 코드에서 <code>Measure</code> 인터페이스는 <code>T</code>라는 제네릭 타입을 사용하며, 이는 자기 자신의 타입을 참조한다. 이러한 설계는 F-bounded polymorphism 패턴으로, 자기 자신의 타입을 참조하여 타입 안전성을 보장한다. 예를 들어 <code>Weight</code>라는 클래스가 <code>Measure&lt;Weight&gt;</code>를 구현한다면, <code>add</code> 메서드는 <code>Weight</code> 타입만 받을 수 있다.</p>
<p>또한 모든 측도는 <code>Comparable</code>을 구현하여 비교 가능하도록 했다. 예를 들어 “5kg”과 “3kg”를 비교하여 어느 것이 더 무거운지 판단할 수 있다.</p>
<p>다음으로 단위를 표현하는 인터페이스를 살펴보자.</p>
<pre class="astro-code github-light" style="background-color:#fff;color:#24292e;overflow-x:auto" tabindex="0" data-language="kotlin"><code><span class="line"><span style="color:#D73A49">interface</span><span style="color:#6F42C1"> Unit</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">T</span><span style="color:#24292E"> : </span><span style="color:#6F42C1">Measure</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">T</span><span style="color:#24292E">&gt;&gt; {</span></span>
<span class="line"><span style="color:#D73A49">  val</span><span style="color:#24292E"> symbol: </span><span style="color:#6F42C1">String</span></span>
<span class="line"><span style="color:#D73A49">  val</span><span style="color:#24292E"> name: </span><span style="color:#6F42C1">String</span></span>
<span class="line"><span style="color:#24292E">  </span></span>
<span class="line"><span style="color:#D73A49">  fun</span><span style="color:#6F42C1"> convert</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">: </span><span style="color:#6F42C1">BigDecimal</span><span style="color:#24292E">, toUnit: </span><span style="color:#6F42C1">Unit</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">T</span><span style="color:#24292E">&gt;): </span><span style="color:#6F42C1">BigDecimal</span></span>
<span class="line"><span style="color:#D73A49">  fun</span><span style="color:#6F42C1"> create</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">: </span><span style="color:#6F42C1">BigDecimal</span><span style="color:#24292E">): </span><span style="color:#6F42C1">T</span></span>
<span class="line"><span style="color:#24292E">}</span></span></code></pre>
<p><code>Unit</code> 인터페이스는 단위의 기호(symbol)와 이름(name)을 가지며, 단위 간 변환(convert)과 새로운 측도 생성(create) 기능을 제공한다. 예를 들어 킬로그램(kg)에서 파운드(lb)로 변환하거나, 5kg의 새로운 무게 객체를 생성할 수 있다.</p>
<p>마지막으로, 특정 종류의 측도에 사용할 수 있는 모든 단위들의 집합을 관리하는 시스템 인터페이스를 정의한다.</p>
<pre class="astro-code github-light" style="background-color:#fff;color:#24292e;overflow-x:auto" tabindex="0" data-language="kotlin"><code><span class="line"><span style="color:#D73A49">interface</span><span style="color:#6F42C1"> UnitSystem</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">T</span><span style="color:#24292E"> : </span><span style="color:#6F42C1">Measure</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">T</span><span style="color:#24292E">&gt;&gt; {</span></span>
<span class="line"><span style="color:#D73A49">  val</span><span style="color:#24292E"> baseUnit: </span><span style="color:#6F42C1">MeasurementUnit</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">T</span><span style="color:#24292E">&gt;</span></span>
<span class="line"><span style="color:#D73A49">  val</span><span style="color:#24292E"> availableUnits: </span><span style="color:#6F42C1">Set</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">MeasurementUnit</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">T</span><span style="color:#24292E">&gt;&gt;</span></span>
<span class="line"><span style="color:#24292E">  </span></span>
<span class="line"><span style="color:#D73A49">  fun</span><span style="color:#6F42C1"> getUnitBySymbol</span><span style="color:#24292E">(symbol: </span><span style="color:#6F42C1">String</span><span style="color:#24292E">): </span><span style="color:#6F42C1">MeasurementUnit</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">T</span><span style="color:#24292E">&gt;?</span></span>
<span class="line"><span style="color:#D73A49">  fun</span><span style="color:#6F42C1"> getUnitByName</span><span style="color:#24292E">(name: </span><span style="color:#6F42C1">String</span><span style="color:#24292E">): </span><span style="color:#6F42C1">MeasurementUnit</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">T</span><span style="color:#24292E">&gt;?</span></span>
<span class="line"><span style="color:#24292E">}</span></span></code></pre>
<p><code>UnitSystem</code>은 모든 변환의 기준이 되는 기본 단위(baseUnit)와 사용 가능한 모든 단위들(availableUnits)을 관리한다. 또한 기호나 이름으로 단위를 찾는 메서드도 제공한다.</p>
<p>위에서 정의한 인터페이스를 기반으로 추상 클래스를 구현해보자. 추상 클래스는 인터페이스의 공통 기능을 구현하여 중복 코드를 줄이고, 향후 구현할 구체적인 측도 클래스에서 필요한 기능만 구현할 수 있도록 한다.</p>
<pre class="astro-code github-light" style="background-color:#fff;color:#24292e;overflow-x:auto" tabindex="0" data-language="kotlin"><code><span class="line"><span style="color:#D73A49">abstract</span><span style="color:#D73A49"> class</span><span style="color:#6F42C1"> AbstractMeasure</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">T</span><span style="color:#24292E"> : </span><span style="color:#6F42C1">Measure</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">T</span><span style="color:#24292E">&gt;&gt;(</span></span>
<span class="line"><span style="color:#D73A49">  override</span><span style="color:#D73A49"> val</span><span style="color:#D73A49"> value</span><span style="color:#24292E">: </span><span style="color:#6F42C1">BigDecimal</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#D73A49">  override</span><span style="color:#D73A49"> val</span><span style="color:#24292E"> unit: </span><span style="color:#6F42C1">MeasurementUnit</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">T</span><span style="color:#24292E">&gt;</span></span>
<span class="line"><span style="color:#24292E">) : </span><span style="color:#6F42C1">Measure</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">T</span><span style="color:#24292E">&gt; {</span></span>
<span class="line"><span style="color:#D73A49">  override</span><span style="color:#D73A49"> fun</span><span style="color:#6F42C1"> convertTo</span><span style="color:#24292E">(targetUnit: </span><span style="color:#6F42C1">MeasurementUnit</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">T</span><span style="color:#24292E">&gt;): </span><span style="color:#6F42C1">T</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#D73A49">      if</span><span style="color:#24292E"> (unit </span><span style="color:#D73A49">==</span><span style="color:#24292E"> targetUnit) {</span></span>
<span class="line"><span style="color:#6F42C1">        @Suppress</span><span style="color:#24292E">(</span><span style="color:#032F62">&quot;UNCHECKED_CAST&quot;</span><span style="color:#24292E">)</span></span>
<span class="line"><span style="color:#D73A49">        return</span><span style="color:#005CC5"> this</span><span style="color:#D73A49"> as</span><span style="color:#24292E"> T</span></span>
<span class="line"><span style="color:#24292E">      }</span></span>
<span class="line"><span style="color:#24292E">      </span></span>
<span class="line"><span style="color:#D73A49">      val</span><span style="color:#24292E"> convertedValue </span><span style="color:#D73A49">=</span><span style="color:#24292E"> unit.</span><span style="color:#6F42C1">convert</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">, targetUnit)</span></span>
<span class="line"><span style="color:#D73A49">      return</span><span style="color:#24292E"> targetUnit.</span><span style="color:#6F42C1">create</span><span style="color:#24292E">(convertedValue)</span></span>
<span class="line"><span style="color:#24292E">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">  override</span><span style="color:#D73A49"> fun</span><span style="color:#6F42C1"> compareTo</span><span style="color:#24292E">(other: </span><span style="color:#6F42C1">T</span><span style="color:#24292E">): </span><span style="color:#6F42C1">Int</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#D73A49">      val</span><span style="color:#24292E"> baseValue </span><span style="color:#D73A49">=</span><span style="color:#24292E"> unit.</span><span style="color:#6F42C1">convert</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">, </span><span style="color:#6F42C1">getUnitSystem</span><span style="color:#24292E">().baseUnit)</span></span>
<span class="line"><span style="color:#D73A49">      val</span><span style="color:#24292E"> otherBaseValue </span><span style="color:#D73A49">=</span><span style="color:#24292E"> other.unit.</span><span style="color:#6F42C1">convert</span><span style="color:#24292E">(other.</span><span style="color:#D73A49">value</span><span style="color:#24292E">, </span><span style="color:#6F42C1">getUnitSystem</span><span style="color:#24292E">().baseUnit)</span></span>
<span class="line"><span style="color:#D73A49">      return</span><span style="color:#24292E"> baseValue.</span><span style="color:#6F42C1">compareTo</span><span style="color:#24292E">(otherBaseValue)</span></span>
<span class="line"><span style="color:#24292E">  }</span></span>
<span class="line"><span style="color:#24292E">  </span></span>
<span class="line"><span style="color:#6A737D">  // 다른 연산 메서드들...</span></span>
<span class="line"><span style="color:#24292E">  </span></span>
<span class="line"><span style="color:#D73A49">  abstract</span><span style="color:#D73A49"> fun</span><span style="color:#6F42C1"> getUnitSystem</span><span style="color:#24292E">(): </span><span style="color:#6F42C1">UnitSystem</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">T</span><span style="color:#24292E">&gt;</span></span>
<span class="line"><span style="color:#24292E">}</span></span></code></pre>
<p><code>AbstractMeasure</code> 클래스는 <code>convertTo</code> 메서드를 구현하여 다른 단위로 변환할 수 있게 하고, <code>compareTo</code> 메서드를 구현하여 서로 다른 단위의 측도도 비교할 수 있게 한다. 예를 들어 kg과 lb 단위의 무게를 비교할 수 있다.</p>
<h2 id="수량"><a href="#수량">수량</a></h2>
<p>이제 측도의 값과 단위에 대한 기본 인터페이스를 정의했으니, 이를 활용하여 실제로 수량(Quantity)을 어떻게 표현할 수 있는지 알아볼 것이다.</p>
<p>측도 모델에 기반한 수량 모델은 값과 단위의 개념을 기반으로, 실제 세계의 다양한 측정값을 프로그래밍적으로 표현할 수 있게 해준다. 보통 이러한 수량 모델은 변환에 있어 공식이 정해져 있는 물리적 수량(개수, 무게, 길이, 부피 등)에 사용된다.</p>
<p>수량을 구현하기 위해 <code>Measure</code> 인터페이스를 구현하는 추상 클래스인 <code>Quantity</code>를 먼저 살펴보자. 이 클래스는 모든 종류의 물리적 수량(무게, 길이, 부피 등)의 공통 기능을 제공한다.</p>
<pre class="astro-code github-light" style="background-color:#fff;color:#24292e;overflow-x:auto" tabindex="0" data-language="kotlin"><code><span class="line"><span style="color:#D73A49">abstract</span><span style="color:#D73A49"> class</span><span style="color:#6F42C1"> Quantity</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">T</span><span style="color:#24292E"> : </span><span style="color:#6F42C1">Measure</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">T</span><span style="color:#24292E">&gt;&gt;(</span></span>
<span class="line"><span style="color:#D73A49">  override</span><span style="color:#D73A49"> val</span><span style="color:#D73A49"> value</span><span style="color:#24292E">: </span><span style="color:#6F42C1">BigDecimal</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#D73A49">  override</span><span style="color:#D73A49"> val</span><span style="color:#24292E"> unit: </span><span style="color:#6F42C1">Unit</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">T</span><span style="color:#24292E">&gt;</span></span>
<span class="line"><span style="color:#24292E">) : </span><span style="color:#6F42C1">AbstractMeasure</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">T</span><span style="color:#24292E">&gt;(</span><span style="color:#6F42C1">value</span><span style="color:#24292E">, </span><span style="color:#6F42C1">unit</span><span style="color:#24292E">) {</span></span>
<span class="line"><span style="color:#6A737D">  // 포맷팅을 위한 메서드</span></span>
<span class="line"><span style="color:#D73A49">  fun</span><span style="color:#6F42C1"> format</span><span style="color:#24292E">(precision: </span><span style="color:#6F42C1">Int</span><span style="color:#D73A49"> =</span><span style="color:#005CC5"> 2</span><span style="color:#24292E">): </span><span style="color:#6F42C1">String</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#D73A49">    val</span><span style="color:#24292E"> roundedValue </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> value</span><span style="color:#24292E">.</span><span style="color:#6F42C1">setScale</span><span style="color:#24292E">(precision, RoundingMode.HALF_UP)</span></span>
<span class="line"><span style="color:#D73A49">    return</span><span style="color:#032F62"> &quot;</span><span style="color:#005CC5">$roundedValue</span><span style="color:#032F62"> ${unit.symbol}&quot;</span></span>
<span class="line"><span style="color:#24292E">  }</span></span>
<span class="line"><span style="color:#24292E">  </span></span>
<span class="line"><span style="color:#6A737D">  // toString 재정의</span></span>
<span class="line"><span style="color:#D73A49">  override</span><span style="color:#D73A49"> fun</span><span style="color:#6F42C1"> toString</span><span style="color:#24292E">(): </span><span style="color:#6F42C1">String</span><span style="color:#D73A49"> =</span><span style="color:#032F62"> &quot;${</span><span style="color:#D73A49">value</span><span style="color:#032F62">} ${unit.symbol}&quot;</span></span>
<span class="line"><span style="color:#24292E">  </span></span>
<span class="line"><span style="color:#6A737D">  // 동등성 비교</span></span>
<span class="line"><span style="color:#D73A49">  override</span><span style="color:#D73A49"> fun</span><span style="color:#6F42C1"> equals</span><span style="color:#24292E">(other: </span><span style="color:#6F42C1">Any</span><span style="color:#24292E">?): </span><span style="color:#6F42C1">Boolean</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#D73A49">    if</span><span style="color:#24292E"> (</span><span style="color:#005CC5">this</span><span style="color:#D73A49"> ===</span><span style="color:#24292E"> other) </span><span style="color:#D73A49">return</span><span style="color:#005CC5"> true</span></span>
<span class="line"><span style="color:#D73A49">    if</span><span style="color:#24292E"> (other </span><span style="color:#D73A49">!is</span><span style="color:#24292E"> Measure</span><span style="color:#D73A49">&lt;*&gt;</span><span style="color:#24292E">) </span><span style="color:#D73A49">return</span><span style="color:#005CC5"> false</span></span>
<span class="line"><span style="color:#24292E">    </span></span>
<span class="line"><span style="color:#6F42C1">    @Suppress</span><span style="color:#24292E">(</span><span style="color:#032F62">&quot;UNCHECKED_CAST&quot;</span><span style="color:#24292E">)</span></span>
<span class="line"><span style="color:#24292E">    other </span><span style="color:#D73A49">as</span><span style="color:#24292E"> T</span></span>
<span class="line"><span style="color:#24292E">    </span></span>
<span class="line"><span style="color:#D73A49">    return</span><span style="color:#D73A49"> try</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#6F42C1">      compareTo</span><span style="color:#24292E">(other) </span><span style="color:#D73A49">==</span><span style="color:#005CC5"> 0</span></span>
<span class="line"><span style="color:#24292E">    } </span><span style="color:#D73A49">catch</span><span style="color:#24292E"> (e: </span><span style="color:#6F42C1">ClassCastException</span><span style="color:#24292E">) {</span></span>
<span class="line"><span style="color:#005CC5">      false</span></span>
<span class="line"><span style="color:#24292E">    }</span></span>
<span class="line"><span style="color:#24292E">  }</span></span>
<span class="line"><span style="color:#24292E">    </span></span>
<span class="line"><span style="color:#6A737D">  // 해시코드 생성</span></span>
<span class="line"><span style="color:#D73A49">  override</span><span style="color:#D73A49"> fun</span><span style="color:#6F42C1"> hashCode</span><span style="color:#24292E">(): </span><span style="color:#6F42C1">Int</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#D73A49">    val</span><span style="color:#24292E"> baseValue </span><span style="color:#D73A49">=</span><span style="color:#24292E"> unit.</span><span style="color:#6F42C1">convert</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">, </span><span style="color:#6F42C1">getUnitSystem</span><span style="color:#24292E">().baseUnit)</span></span>
<span class="line"><span style="color:#D73A49">    return</span><span style="color:#24292E"> baseValue.</span><span style="color:#6F42C1">hashCode</span><span style="color:#24292E">()</span></span>
<span class="line"><span style="color:#24292E">  }</span></span>
<span class="line"><span style="color:#24292E">}</span></span></code></pre>
<p>이제 이 추상 클래스를 바탕으로 구체적인 수량 타입들을 구현할 수 있다. 여기서는 무게(Weight)를 예로 들어보자.</p>
<pre class="astro-code github-light" style="background-color:#fff;color:#24292e;overflow-x:auto" tabindex="0" data-language="kotlin"><code><span class="line"><span style="color:#D73A49">class</span><span style="color:#6F42C1"> Weight</span><span style="color:#D73A49"> private</span><span style="color:#6F42C1"> constructor</span><span style="color:#24292E">(</span></span>
<span class="line"><span style="color:#D73A49">  value</span><span style="color:#24292E">: </span><span style="color:#6F42C1">BigDecimal</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#24292E">  unit: </span><span style="color:#6F42C1">WeightUnit</span></span>
<span class="line"><span style="color:#24292E">) : </span><span style="color:#6F42C1">Quantity</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">Weight</span><span style="color:#24292E">&gt;(</span><span style="color:#6F42C1">value</span><span style="color:#24292E">, </span><span style="color:#6F42C1">unit</span><span style="color:#24292E">) {</span></span>
<span class="line"><span style="color:#D73A49">  companion</span><span style="color:#D73A49"> object</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#6A737D">    // 팩토리 메서드: 기본 생성</span></span>
<span class="line"><span style="color:#D73A49">    fun</span><span style="color:#6F42C1"> of</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">: </span><span style="color:#6F42C1">BigDecimal</span><span style="color:#24292E">, unit: </span><span style="color:#6F42C1">WeightUnit</span><span style="color:#24292E">): </span><span style="color:#6F42C1">Weight</span><span style="color:#D73A49"> =</span><span style="color:#6F42C1"> Weight</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">, unit)</span></span>
<span class="line"><span style="color:#D73A49">    fun</span><span style="color:#6F42C1"> of</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">: </span><span style="color:#6F42C1">Double</span><span style="color:#24292E">, unit: </span><span style="color:#6F42C1">WeightUnit</span><span style="color:#24292E">): </span><span style="color:#6F42C1">Weight</span><span style="color:#D73A49"> =</span><span style="color:#6F42C1"> of</span><span style="color:#24292E">(BigDecimal.</span><span style="color:#6F42C1">valueOf</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">), unit)</span></span>
<span class="line"><span style="color:#D73A49">    fun</span><span style="color:#6F42C1"> of</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">: </span><span style="color:#6F42C1">Int</span><span style="color:#24292E">, unit: </span><span style="color:#6F42C1">WeightUnit</span><span style="color:#24292E">): </span><span style="color:#6F42C1">Weight</span><span style="color:#D73A49"> =</span><span style="color:#6F42C1"> of</span><span style="color:#24292E">(BigDecimal.</span><span style="color:#6F42C1">valueOf</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">.</span><span style="color:#6F42C1">toLong</span><span style="color:#24292E">()), unit)</span></span>
<span class="line"><span style="color:#24292E">    </span></span>
<span class="line"><span style="color:#6A737D">    // 편의 메서드: 특정 단위로 생성</span></span>
<span class="line"><span style="color:#D73A49">    fun</span><span style="color:#6F42C1"> kilograms</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">: </span><span style="color:#6F42C1">Double</span><span style="color:#24292E">): </span><span style="color:#6F42C1">Weight</span><span style="color:#D73A49"> =</span><span style="color:#6F42C1"> of</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">, WeightSystem.KILOGRAM)</span></span>
<span class="line"><span style="color:#D73A49">    fun</span><span style="color:#6F42C1"> grams</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">: </span><span style="color:#6F42C1">Double</span><span style="color:#24292E">): </span><span style="color:#6F42C1">Weight</span><span style="color:#D73A49"> =</span><span style="color:#6F42C1"> of</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">, WeightSystem.GRAM)</span></span>
<span class="line"><span style="color:#D73A49">    fun</span><span style="color:#6F42C1"> pounds</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">: </span><span style="color:#6F42C1">Double</span><span style="color:#24292E">): </span><span style="color:#6F42C1">Weight</span><span style="color:#D73A49"> =</span><span style="color:#6F42C1"> of</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">, WeightSystem.POUND)</span></span>
<span class="line"><span style="color:#D73A49">    fun</span><span style="color:#6F42C1"> ounces</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">: </span><span style="color:#6F42C1">Double</span><span style="color:#24292E">): </span><span style="color:#6F42C1">Weight</span><span style="color:#D73A49"> =</span><span style="color:#6F42C1"> of</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">, WeightSystem.OUNCE)</span></span>
<span class="line"><span style="color:#24292E">  }</span></span>
<span class="line"><span style="color:#24292E">  </span></span>
<span class="line"><span style="color:#D73A49">  override</span><span style="color:#D73A49"> fun</span><span style="color:#6F42C1"> getUnitSystem</span><span style="color:#24292E">(): </span><span style="color:#6F42C1">UnitSystem</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">Weight</span><span style="color:#24292E">&gt; </span><span style="color:#D73A49">=</span><span style="color:#24292E"> WeightSystem</span></span>
<span class="line"><span style="color:#24292E">}</span></span></code></pre>
<p>앞서 정의한 <code>Quantity</code> 클래스를 상속받아 <code>Weight</code> 클래스를 구현했다. 이후 편의를 위해 팩토리 메서드를 구현해 다양한 단위로 무게를 생성할 수 있도록 했다. 예를 들어 <code>Weight.kilograms(5.0)</code>은 5kg의 무게 객체를 생성한다.</p>
<p>이어서 무게 단위를 정의하는 <code>WeightUnit</code> 클래스를 구현해보자.</p>
<pre class="astro-code github-light" style="background-color:#fff;color:#24292e;overflow-x:auto" tabindex="0" data-language="kotlin"><code><span class="line"><span style="color:#D73A49">class</span><span style="color:#6F42C1"> WeightUnit</span><span style="color:#24292E">(</span></span>
<span class="line"><span style="color:#D73A49">  override</span><span style="color:#D73A49"> val</span><span style="color:#24292E"> symbol: </span><span style="color:#6F42C1">String</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#D73A49">  override</span><span style="color:#D73A49"> val</span><span style="color:#24292E"> name: </span><span style="color:#6F42C1">String</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#D73A49">  private</span><span style="color:#D73A49"> val</span><span style="color:#24292E"> conversionFactor: </span><span style="color:#6F42C1">BigDecimal</span><span style="color:#6A737D"> // 기본 단위(kg)에 대한 변환 계수</span></span>
<span class="line"><span style="color:#24292E">) : </span><span style="color:#6F42C1">Unit</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">Weight</span><span style="color:#24292E">&gt; {</span></span>
<span class="line"><span style="color:#D73A49">  override</span><span style="color:#D73A49"> fun</span><span style="color:#6F42C1"> convert</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">: </span><span style="color:#6F42C1">BigDecimal</span><span style="color:#24292E">, toUnit: </span><span style="color:#6F42C1">Unit</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">Weight</span><span style="color:#24292E">&gt;): </span><span style="color:#6F42C1">BigDecimal</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#D73A49">    return</span><span style="color:#D73A49"> value</span><span style="color:#24292E">.</span><span style="color:#6F42C1">multiply</span><span style="color:#24292E">(conversionFactor).</span><span style="color:#6F42C1">divide</span><span style="color:#24292E">(toUnit.conversionFactor)</span></span>
<span class="line"><span style="color:#24292E">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">  override</span><span style="color:#D73A49"> fun</span><span style="color:#6F42C1"> create</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">: </span><span style="color:#6F42C1">BigDecimal</span><span style="color:#24292E">): </span><span style="color:#6F42C1">Weight</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#D73A49">    return</span><span style="color:#6F42C1"> Weight</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">, </span><span style="color:#005CC5">this</span><span style="color:#24292E">)</span></span>
<span class="line"><span style="color:#24292E">  }</span></span>
<span class="line"><span style="color:#24292E">}</span></span></code></pre>
<p>여기서 <code>conversionFactor</code>는 해당 단위를 기본 단위(킬로그램)로 변환할 때 곱하는 계수이다. 예를 들어 그램은 킬로그램의 1/1000이므로, 그램의 conversionFactor는 0.001이 된다.</p>
<p>마지막으로 무게 단위계를 구현해보자.</p>
<pre class="astro-code github-light" style="background-color:#fff;color:#24292e;overflow-x:auto" tabindex="0" data-language="kotlin"><code><span class="line"><span style="color:#D73A49">object</span><span style="color:#6F42C1"> WeightSystem</span><span style="color:#24292E"> : </span><span style="color:#6F42C1">UnitSystem</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">Weight</span><span style="color:#24292E">&gt; {</span></span>
<span class="line"><span style="color:#D73A49">  val</span><span style="color:#24292E"> KILOGRAM </span><span style="color:#D73A49">=</span><span style="color:#6F42C1"> WeightUnit</span><span style="color:#24292E">(</span><span style="color:#032F62">&quot;kg&quot;</span><span style="color:#24292E">, </span><span style="color:#032F62">&quot;Kilogram&quot;</span><span style="color:#24292E">, BigDecimal.ONE)</span></span>
<span class="line"><span style="color:#D73A49">  val</span><span style="color:#24292E"> GRAM </span><span style="color:#D73A49">=</span><span style="color:#6F42C1"> WeightUnit</span><span style="color:#24292E">(</span><span style="color:#032F62">&quot;g&quot;</span><span style="color:#24292E">, </span><span style="color:#032F62">&quot;Gram&quot;</span><span style="color:#24292E">, </span><span style="color:#6F42C1">BigDecimal</span><span style="color:#24292E">(</span><span style="color:#005CC5">0.001</span><span style="color:#24292E">))</span></span>
<span class="line"><span style="color:#D73A49">  val</span><span style="color:#24292E"> MILLIGRAM </span><span style="color:#D73A49">=</span><span style="color:#6F42C1"> WeightUnit</span><span style="color:#24292E">(</span><span style="color:#032F62">&quot;mg&quot;</span><span style="color:#24292E">, </span><span style="color:#032F62">&quot;Milligram&quot;</span><span style="color:#24292E">, </span><span style="color:#6F42C1">BigDecimal</span><span style="color:#24292E">(</span><span style="color:#005CC5">0.000001</span><span style="color:#24292E">))</span></span>
<span class="line"><span style="color:#D73A49">  val</span><span style="color:#24292E"> TON </span><span style="color:#D73A49">=</span><span style="color:#6F42C1"> WeightUnit</span><span style="color:#24292E">(</span><span style="color:#032F62">&quot;t&quot;</span><span style="color:#24292E">, </span><span style="color:#032F62">&quot;Ton&quot;</span><span style="color:#24292E">, </span><span style="color:#6F42C1">BigDecimal</span><span style="color:#24292E">(</span><span style="color:#005CC5">1000</span><span style="color:#24292E">))</span></span>
<span class="line"><span style="color:#D73A49">  val</span><span style="color:#24292E"> POUND </span><span style="color:#D73A49">=</span><span style="color:#6F42C1"> WeightUnit</span><span style="color:#24292E">(</span><span style="color:#032F62">&quot;lb&quot;</span><span style="color:#24292E">, </span><span style="color:#032F62">&quot;Pound&quot;</span><span style="color:#24292E">, </span><span style="color:#6F42C1">BigDecimal</span><span style="color:#24292E">(</span><span style="color:#005CC5">0.45359237</span><span style="color:#24292E">))</span></span>
<span class="line"><span style="color:#D73A49">  val</span><span style="color:#24292E"> OUNCE </span><span style="color:#D73A49">=</span><span style="color:#6F42C1"> WeightUnit</span><span style="color:#24292E">(</span><span style="color:#032F62">&quot;oz&quot;</span><span style="color:#24292E">, </span><span style="color:#032F62">&quot;OUNCE&quot;</span><span style="color:#24292E">, </span><span style="color:#6F42C1">BigDecimal</span><span style="color:#24292E">(</span><span style="color:#005CC5">0.028349523125</span><span style="color:#24292E">))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">  override</span><span style="color:#D73A49"> val</span><span style="color:#24292E"> baseUnit: </span><span style="color:#6F42C1">Unit</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">Weight</span><span style="color:#24292E">&gt; </span><span style="color:#D73A49">=</span><span style="color:#24292E"> KILOGRAM</span></span>
<span class="line"><span style="color:#D73A49">  override</span><span style="color:#D73A49"> val</span><span style="color:#24292E"> availableUnits: </span><span style="color:#6F42C1">Set</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">Unit</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">Weight</span><span style="color:#24292E">&gt;&gt; </span><span style="color:#D73A49">=</span><span style="color:#6F42C1"> setOf</span><span style="color:#24292E">(KILOGRAM, GRAM, POUND, OUNCE)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">  override</span><span style="color:#D73A49"> fun</span><span style="color:#6F42C1"> getUnitBySymbol</span><span style="color:#24292E">(symbol: </span><span style="color:#6F42C1">String</span><span style="color:#24292E">): </span><span style="color:#6F42C1">Unit</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">Weight</span><span style="color:#24292E">&gt;? {</span></span>
<span class="line"><span style="color:#D73A49">    return</span><span style="color:#24292E"> availableUnits.</span><span style="color:#6F42C1">find</span><span style="color:#24292E"> { it.symbol </span><span style="color:#D73A49">==</span><span style="color:#24292E"> symbol }</span></span>
<span class="line"><span style="color:#24292E">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">  override</span><span style="color:#D73A49"> fun</span><span style="color:#6F42C1"> getUnitByName</span><span style="color:#24292E">(name: </span><span style="color:#6F42C1">String</span><span style="color:#24292E">): </span><span style="color:#6F42C1">Unit</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">Weight</span><span style="color:#24292E">&gt;? {</span></span>
<span class="line"><span style="color:#D73A49">    return</span><span style="color:#24292E"> availableUnits.</span><span style="color:#6F42C1">find</span><span style="color:#24292E"> { it.name </span><span style="color:#D73A49">==</span><span style="color:#24292E"> name }</span></span>
<span class="line"><span style="color:#24292E">  }</span></span>
<span class="line"><span style="color:#24292E">}</span></span></code></pre>
<p><code>WeightSystem</code>은 싱글톤 객체로 구현해서 애플리케이션 전체에서 단 하나의 인스턴스만 존재하도록 만들었다. 이를 통해 단위 정의의 일관성을 보장하고 메모리 사용을 최적화할 수 있다. 이제 이를 사용한 예제 코드를 살펴보자.</p>
<pre class="astro-code github-light" style="background-color:#fff;color:#24292e;overflow-x:auto" tabindex="0" data-language="kotlin"><code><span class="line"><span style="color:#6A737D">// 무게 생성</span></span>
<span class="line"><span style="color:#D73A49">val</span><span style="color:#24292E"> weight1 </span><span style="color:#D73A49">=</span><span style="color:#24292E"> Weight.</span><span style="color:#6F42C1">kilograms</span><span style="color:#24292E">(</span><span style="color:#005CC5">75.5</span><span style="color:#24292E">)</span></span>
<span class="line"><span style="color:#D73A49">val</span><span style="color:#24292E"> weight2 </span><span style="color:#D73A49">=</span><span style="color:#24292E"> Weight.</span><span style="color:#6F42C1">pounds</span><span style="color:#24292E">(</span><span style="color:#005CC5">150.0</span><span style="color:#24292E">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">// 단위 변환</span></span>
<span class="line"><span style="color:#D73A49">val</span><span style="color:#24292E"> weight2InKg </span><span style="color:#D73A49">=</span><span style="color:#24292E"> weight2.</span><span style="color:#6F42C1">convertTo</span><span style="color:#24292E">(WeightSystem.KILOGRAM)</span></span>
<span class="line"><span style="color:#6F42C1">println</span><span style="color:#24292E">(</span><span style="color:#032F62">&quot;150 pounds = ${weight2InKg}&quot;</span><span style="color:#24292E">) </span><span style="color:#6A737D">// &quot;150 pounds = 68.0388555 kg&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">// 무게 덧셈</span></span>
<span class="line"><span style="color:#D73A49">val</span><span style="color:#24292E"> totalWeight </span><span style="color:#D73A49">=</span><span style="color:#24292E"> weight1.</span><span style="color:#6F42C1">add</span><span style="color:#24292E">(weight2)</span></span>
<span class="line"><span style="color:#6F42C1">println</span><span style="color:#24292E">(</span><span style="color:#032F62">&quot;Total weight: </span><span style="color:#005CC5">$totalWeight</span><span style="color:#032F62">&quot;</span><span style="color:#24292E">) </span><span style="color:#6A737D">// &quot;Total weight: 143.5388555 kg&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">// 무게 비교</span></span>
<span class="line"><span style="color:#D73A49">val</span><span style="color:#24292E"> isHeavier </span><span style="color:#D73A49">=</span><span style="color:#24292E"> weight1 </span><span style="color:#D73A49">&gt;</span><span style="color:#24292E"> weight2</span></span>
<span class="line"><span style="color:#6F42C1">println</span><span style="color:#24292E">(</span><span style="color:#032F62">&quot;Is 75.5 kg heavier than 150 pounds? </span><span style="color:#005CC5">$isHeavier</span><span style="color:#032F62">&quot;</span><span style="color:#24292E">) </span><span style="color:#6A737D">// true</span></span></code></pre>
<p>이와 같은 방식으로 무게 외에도 다양한 측도를 구현할 수 있다. 예를 들어 거리를 표현하는 <code>Distance</code> 클래스, 부피를 표현하는 <code>Volume</code> 클래스 등을 구현할 수 있다. 각 클래스는 <code>Measure</code> 인터페이스를 구현하고, 단위와 단위계도 각각 정의하면 된다.</p>
<p>각 수량 타입은 고유한 단위 시스템과 단위 간 변환 규칙을 가지지만, 기본적인 구조와 연산 방식은 동일하게 유지된다. 이는 객체지향 설계의 다형성과 상속을 잘 활용한 예시이다.</p>
<h2 id="화폐"><a href="#화폐">화폐</a></h2>
<p>앞서 구현한 수량 모델으로 해결할 수 없는 단위도 있다. 그 중 하나가 화폐이다. 화폐는 단순히 수량과 단위의 조합인 동시에, 환율이라는 특수한 변환 관계를 가지고 있다. 또한 비즈니스 애플리케이션에서 가장 많이 사용되는 측도 중 하나이다. 이번에는 앞서 구현한 측도 시스템을 바탕으로 화폐를 어떻게 모델링할 수 있는지 살펴보자.</p>
<p>먼저 화폐는 일반적인 물리적 수량과 달리 몇 가지 고유한 특성을 가지고 있다. ISO 표준 코드가 존재하고, 환율이 있으므로 변환이 고정되어 있지 않다. 이를 고려하여 화폐 모델을 구현해보자. 먼저 화폐를 표현하는 <code>Money</code> 클래스를 정의해보자.</p>
<pre class="astro-code github-light" style="background-color:#fff;color:#24292e;overflow-x:auto" tabindex="0" data-language="kotlin"><code><span class="line"><span style="color:#D73A49">class</span><span style="color:#6F42C1"> Money</span><span style="color:#D73A49"> private</span><span style="color:#6F42C1"> constructor</span><span style="color:#24292E">(</span></span>
<span class="line"><span style="color:#D73A49">  value</span><span style="color:#24292E">: </span><span style="color:#6F42C1">BigDecimal</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#24292E">  unit: </span><span style="color:#6F42C1">CurrencyUnit</span></span>
<span class="line"><span style="color:#24292E">) : </span><span style="color:#6F42C1">AbstractMeasure</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">Money</span><span style="color:#24292E">&gt;(</span><span style="color:#6F42C1">value</span><span style="color:#24292E">, </span><span style="color:#6F42C1">unit</span><span style="color:#24292E">) {</span></span>
<span class="line"><span style="color:#D73A49">  companion</span><span style="color:#D73A49"> object</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#6A737D">    // 팩토리 메서드</span></span>
<span class="line"><span style="color:#D73A49">    fun</span><span style="color:#6F42C1"> of</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">: </span><span style="color:#6F42C1">BigDecimal</span><span style="color:#24292E">, currency: </span><span style="color:#6F42C1">CurrencyUnit</span><span style="color:#24292E">): </span><span style="color:#6F42C1">Money</span><span style="color:#D73A49"> =</span><span style="color:#6F42C1"> Money</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">, currency)</span></span>
<span class="line"><span style="color:#D73A49">    fun</span><span style="color:#6F42C1"> of</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">: </span><span style="color:#6F42C1">Double</span><span style="color:#24292E">, currency: </span><span style="color:#6F42C1">CurrencyUnit</span><span style="color:#24292E">): </span><span style="color:#6F42C1">Money</span><span style="color:#D73A49"> =</span><span style="color:#6F42C1"> of</span><span style="color:#24292E">(BigDecimal.</span><span style="color:#6F42C1">valueOf</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">), currency)</span></span>
<span class="line"><span style="color:#D73A49">    fun</span><span style="color:#6F42C1"> of</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">: </span><span style="color:#6F42C1">Int</span><span style="color:#24292E">, currency: </span><span style="color:#6F42C1">CurrencyUnit</span><span style="color:#24292E">): </span><span style="color:#6F42C1">Money</span><span style="color:#D73A49"> =</span><span style="color:#6F42C1"> of</span><span style="color:#24292E">(BigDecimal.</span><span style="color:#6F42C1">valueOf</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">.</span><span style="color:#6F42C1">toLong</span><span style="color:#24292E">()), currency)</span></span>
<span class="line"><span style="color:#24292E">    </span></span>
<span class="line"><span style="color:#6A737D">    // 주요 통화별 편의 메서드</span></span>
<span class="line"><span style="color:#D73A49">    fun</span><span style="color:#6F42C1"> usd</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">: </span><span style="color:#6F42C1">Double</span><span style="color:#24292E">): </span><span style="color:#6F42C1">Money</span><span style="color:#D73A49"> =</span><span style="color:#6F42C1"> of</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">, CurrencySystem.USD)</span></span>
<span class="line"><span style="color:#D73A49">    fun</span><span style="color:#6F42C1"> eur</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">: </span><span style="color:#6F42C1">Double</span><span style="color:#24292E">): </span><span style="color:#6F42C1">Money</span><span style="color:#D73A49"> =</span><span style="color:#6F42C1"> of</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">, CurrencySystem.EUR)</span></span>
<span class="line"><span style="color:#D73A49">    fun</span><span style="color:#6F42C1"> jpy</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">: </span><span style="color:#6F42C1">Double</span><span style="color:#24292E">): </span><span style="color:#6F42C1">Money</span><span style="color:#D73A49"> =</span><span style="color:#6F42C1"> of</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">, CurrencySystem.JPY)</span></span>
<span class="line"><span style="color:#D73A49">    fun</span><span style="color:#6F42C1"> krw</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">: </span><span style="color:#6F42C1">Double</span><span style="color:#24292E">): </span><span style="color:#6F42C1">Money</span><span style="color:#D73A49"> =</span><span style="color:#6F42C1"> of</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">, CurrencySystem.KRW)</span></span>
<span class="line"><span style="color:#24292E">  }</span></span>
<span class="line"><span style="color:#24292E">  </span></span>
<span class="line"><span style="color:#6A737D">  // 통화 단위에 더 직관적으로 접근하기 위한 속성</span></span>
<span class="line"><span style="color:#D73A49">  val</span><span style="color:#24292E"> currency: </span><span style="color:#6F42C1">CurrencyUnit</span></span>
<span class="line"><span style="color:#D73A49">    get</span><span style="color:#24292E">() </span><span style="color:#D73A49">=</span><span style="color:#24292E"> unit </span><span style="color:#D73A49">as</span><span style="color:#24292E"> CurrencyUnit</span></span>
<span class="line"><span style="color:#24292E">  </span></span>
<span class="line"><span style="color:#6A737D">  // 화폐 포맷팅</span></span>
<span class="line"><span style="color:#D73A49">  fun</span><span style="color:#6F42C1"> format</span><span style="color:#24292E">(locale: </span><span style="color:#6F42C1">Locale</span><span style="color:#D73A49"> =</span><span style="color:#24292E"> Locale.</span><span style="color:#6F42C1">getDefault</span><span style="color:#24292E">()): </span><span style="color:#6F42C1">String</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#D73A49">    val</span><span style="color:#24292E"> formatter </span><span style="color:#D73A49">=</span><span style="color:#24292E"> NumberFormat.</span><span style="color:#6F42C1">getCurrencyInstance</span><span style="color:#24292E">(locale).</span><span style="color:#6F42C1">apply</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">      currency </span><span style="color:#D73A49">=</span><span style="color:#24292E"> java.util.Currency.</span><span style="color:#6F42C1">getInstance</span><span style="color:#24292E">(</span><span style="color:#005CC5">this@Money</span><span style="color:#24292E">.currency.code)</span></span>
<span class="line"><span style="color:#24292E">    }</span></span>
<span class="line"><span style="color:#D73A49">    return</span><span style="color:#24292E"> formatter.</span><span style="color:#6F42C1">format</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">)</span></span>
<span class="line"><span style="color:#24292E">  }</span></span>
<span class="line"><span style="color:#24292E">  </span></span>
<span class="line"><span style="color:#6A737D">  // 간단한 포맷팅</span></span>
<span class="line"><span style="color:#D73A49">  fun</span><span style="color:#6F42C1"> formatSimple</span><span style="color:#24292E">(): </span><span style="color:#6F42C1">String</span><span style="color:#D73A49"> =</span><span style="color:#032F62"> &quot;${currency.symbol}</span><span style="color:#005CC5">$value</span><span style="color:#032F62">&quot;</span></span>
<span class="line"><span style="color:#24292E">  </span></span>
<span class="line"><span style="color:#D73A49">  override</span><span style="color:#D73A49"> fun</span><span style="color:#6F42C1"> getUnitSystem</span><span style="color:#24292E">(): </span><span style="color:#6F42C1">UnitSystem</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">Money</span><span style="color:#24292E">&gt; </span><span style="color:#D73A49">=</span><span style="color:#24292E"> CurrencySystem</span></span>
<span class="line"><span style="color:#24292E">  </span></span>
<span class="line"><span style="color:#6A737D">  // 화폐 연산에 특화된 메서드들</span></span>
<span class="line"><span style="color:#D73A49">  fun</span><span style="color:#6F42C1"> percentage</span><span style="color:#24292E">(percent: </span><span style="color:#6F42C1">Double</span><span style="color:#24292E">): </span><span style="color:#6F42C1">Money</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#D73A49">    val</span><span style="color:#24292E"> factor </span><span style="color:#D73A49">=</span><span style="color:#24292E"> BigDecimal.</span><span style="color:#6F42C1">valueOf</span><span style="color:#24292E">(percent).</span><span style="color:#6F42C1">divide</span><span style="color:#24292E">(</span><span style="color:#6F42C1">BigDecimal</span><span style="color:#24292E">(</span><span style="color:#032F62">&quot;100&quot;</span><span style="color:#24292E">), </span><span style="color:#005CC5">10</span><span style="color:#24292E">, RoundingMode.HALF_UP)</span></span>
<span class="line"><span style="color:#D73A49">    return</span><span style="color:#6F42C1"> multiply</span><span style="color:#24292E">(factor)</span></span>
<span class="line"><span style="color:#24292E">  }</span></span>
<span class="line"><span style="color:#24292E">  </span></span>
<span class="line"><span style="color:#D73A49">  fun</span><span style="color:#6F42C1"> addPercentage</span><span style="color:#24292E">(percent: </span><span style="color:#6F42C1">Double</span><span style="color:#24292E">): </span><span style="color:#6F42C1">Money</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#D73A49">    val</span><span style="color:#24292E"> factor </span><span style="color:#D73A49">=</span><span style="color:#24292E"> BigDecimal.ONE.</span><span style="color:#6F42C1">add</span><span style="color:#24292E">(BigDecimal.</span><span style="color:#6F42C1">valueOf</span><span style="color:#24292E">(percent).</span><span style="color:#6F42C1">divide</span><span style="color:#24292E">(</span><span style="color:#6F42C1">BigDecimal</span><span style="color:#24292E">(</span><span style="color:#032F62">&quot;100&quot;</span><span style="color:#24292E">), </span><span style="color:#005CC5">10</span><span style="color:#24292E">, RoundingMode.HALF_UP))</span></span>
<span class="line"><span style="color:#D73A49">    return</span><span style="color:#6F42C1"> multiply</span><span style="color:#24292E">(factor)</span></span>
<span class="line"><span style="color:#24292E">  }</span></span>
<span class="line"><span style="color:#24292E">}</span></span></code></pre>
<p><code>Money</code> 클래스를 구현하며 기본적인 측도 기능을 상속받으면서 화폐에 특화된 기능을 추가했다. 먼저 <code>currency</code> 필드를 통해 확장된 <code>Unit</code> 타입인 <code>CurrencyUnit</code>에 접근할 수 있도록 했다. 그리고 <code>format</code> 메서드를 통해 지역화된 화폐 포맷팅을 지원하며, 세금이나 할인율과 같은 퍼센트 기반 연산을 쉽게 수행할 수 있는 메서드를 제공했다.</p>
<p>다음으로 화폐 단위를 정의하는 <code>CurrencyUnit</code> 클래스를 구현해보자.</p>
<pre class="astro-code github-light" style="background-color:#fff;color:#24292e;overflow-x:auto" tabindex="0" data-language="kotlin"><code><span class="line"><span style="color:#D73A49">class</span><span style="color:#6F42C1"> CurrencyUnit</span><span style="color:#24292E">(</span></span>
<span class="line"><span style="color:#D73A49">  override</span><span style="color:#D73A49"> val</span><span style="color:#24292E"> symbol: </span><span style="color:#6F42C1">String</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#D73A49">  override</span><span style="color:#D73A49"> val</span><span style="color:#24292E"> name: </span><span style="color:#6F42C1">String</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#D73A49">  val</span><span style="color:#24292E"> code: </span><span style="color:#6F42C1">String</span><span style="color:#24292E">, </span><span style="color:#6A737D">// ISO 통화 코드 (예: USD, EUR)</span></span>
<span class="line"><span style="color:#D73A49">  var</span><span style="color:#24292E"> exchangeRate: </span><span style="color:#6F42C1">BigDecimal</span><span style="color:#6A737D"> // 기준 통화(예: USD)에 대한 환율, 변할 수 있음</span></span>
<span class="line"><span style="color:#24292E">) : </span><span style="color:#6F42C1">Unit</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">Money</span><span style="color:#24292E">&gt; {</span></span>
<span class="line"><span style="color:#D73A49">  override</span><span style="color:#D73A49"> fun</span><span style="color:#6F42C1"> convert</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">: </span><span style="color:#6F42C1">BigDecimal</span><span style="color:#24292E">, toUnit: </span><span style="color:#6F42C1">Unit</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">Money</span><span style="color:#24292E">&gt;): </span><span style="color:#6F42C1">BigDecimal</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">    toUnit </span><span style="color:#D73A49">as</span><span style="color:#24292E"> CurrencyUnit</span></span>
<span class="line"><span style="color:#24292E">    </span></span>
<span class="line"><span style="color:#6A737D">    // 기본 통화로 변환 후 대상 통화로 변환</span></span>
<span class="line"><span style="color:#D73A49">    val</span><span style="color:#24292E"> valueInBaseUnit </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> value</span><span style="color:#24292E">.</span><span style="color:#6F42C1">divide</span><span style="color:#24292E">(exchangeRate, </span><span style="color:#005CC5">10</span><span style="color:#24292E">, RoundingMode.HALF_UP)</span></span>
<span class="line"><span style="color:#D73A49">    return</span><span style="color:#24292E"> valueInBaseUnit.</span><span style="color:#6F42C1">multiply</span><span style="color:#24292E">(toUnit.exchangeRate)</span></span>
<span class="line"><span style="color:#24292E">  }</span></span>
<span class="line"><span style="color:#24292E">  </span></span>
<span class="line"><span style="color:#D73A49">  override</span><span style="color:#D73A49"> fun</span><span style="color:#6F42C1"> create</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">: </span><span style="color:#6F42C1">BigDecimal</span><span style="color:#24292E">): </span><span style="color:#6F42C1">Money</span><span style="color:#D73A49"> =</span><span style="color:#24292E"> Money.</span><span style="color:#6F42C1">of</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">, </span><span style="color:#005CC5">this</span><span style="color:#24292E">)</span></span>
<span class="line"><span style="color:#24292E">}</span></span></code></pre>
<p><code>CurrencyUnit</code>은 일반적인 단위 정보(기호, 이름) 외에도 ISO 통화 코드와 환율을 추가로 저장한다. 그리고 <code>convert</code> 메서드에서는 일반적인 물리적 단위와 달리, 직접적인 변환이 아닌 USD와 같은 기준 통화를 경유한 변환을 수행한다. 이는 금융 시스템에서 일반적으로 사용되는 방식으로, 모든 통화 쌍에 대한 환율을 개별적으로 관리하지 않고, 기준 통화에 대한 환율만 관리하는 방식이다.</p>
<p>마지막으로 통화 단위들을 관리하는 <code>CurrencySystem</code>을 구현해보자.</p>
<pre class="astro-code github-light" style="background-color:#fff;color:#24292e;overflow-x:auto" tabindex="0" data-language="kotlin"><code><span class="line"><span style="color:#D73A49">object</span><span style="color:#6F42C1"> CurrencySystem</span><span style="color:#24292E"> : </span><span style="color:#6F42C1">AbstractUnitSystem</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">Money</span><span style="color:#24292E">&gt;() {</span></span>
<span class="line"><span style="color:#6A737D">  // 주요 통화 정의</span></span>
<span class="line"><span style="color:#D73A49">  val</span><span style="color:#24292E"> USD </span><span style="color:#D73A49">=</span><span style="color:#6F42C1"> CurrencyUnit</span><span style="color:#24292E">(</span><span style="color:#032F62">&quot;$&quot;</span><span style="color:#24292E">, </span><span style="color:#032F62">&quot;US Dollar&quot;</span><span style="color:#24292E">, </span><span style="color:#032F62">&quot;USD&quot;</span><span style="color:#24292E">, BigDecimal.ONE)</span></span>
<span class="line"><span style="color:#D73A49">  val</span><span style="color:#24292E"> EUR </span><span style="color:#D73A49">=</span><span style="color:#6F42C1"> CurrencyUnit</span><span style="color:#24292E">(</span><span style="color:#032F62">&quot;€&quot;</span><span style="color:#24292E">, </span><span style="color:#032F62">&quot;Euro&quot;</span><span style="color:#24292E">, </span><span style="color:#032F62">&quot;EUR&quot;</span><span style="color:#24292E">, </span><span style="color:#6F42C1">BigDecimal</span><span style="color:#24292E">(</span><span style="color:#032F62">&quot;1.09&quot;</span><span style="color:#24292E">))</span></span>
<span class="line"><span style="color:#D73A49">  val</span><span style="color:#24292E"> GBP </span><span style="color:#D73A49">=</span><span style="color:#6F42C1"> CurrencyUnit</span><span style="color:#24292E">(</span><span style="color:#032F62">&quot;£&quot;</span><span style="color:#24292E">, </span><span style="color:#032F62">&quot;British Pound&quot;</span><span style="color:#24292E">, </span><span style="color:#032F62">&quot;GBP&quot;</span><span style="color:#24292E">, </span><span style="color:#6F42C1">BigDecimal</span><span style="color:#24292E">(</span><span style="color:#032F62">&quot;1.27&quot;</span><span style="color:#24292E">))</span></span>
<span class="line"><span style="color:#D73A49">  val</span><span style="color:#24292E"> JPY </span><span style="color:#D73A49">=</span><span style="color:#6F42C1"> CurrencyUnit</span><span style="color:#24292E">(</span><span style="color:#032F62">&quot;¥&quot;</span><span style="color:#24292E">, </span><span style="color:#032F62">&quot;Japanese Yen&quot;</span><span style="color:#24292E">, </span><span style="color:#032F62">&quot;JPY&quot;</span><span style="color:#24292E">, </span><span style="color:#6F42C1">BigDecimal</span><span style="color:#24292E">(</span><span style="color:#032F62">&quot;0.0067&quot;</span><span style="color:#24292E">))</span></span>
<span class="line"><span style="color:#D73A49">  val</span><span style="color:#24292E"> KRW </span><span style="color:#D73A49">=</span><span style="color:#6F42C1"> CurrencyUnit</span><span style="color:#24292E">(</span><span style="color:#032F62">&quot;₩&quot;</span><span style="color:#24292E">, </span><span style="color:#032F62">&quot;Korean Won&quot;</span><span style="color:#24292E">, </span><span style="color:#032F62">&quot;KRW&quot;</span><span style="color:#24292E">, </span><span style="color:#6F42C1">BigDecimal</span><span style="color:#24292E">(</span><span style="color:#032F62">&quot;0.00074&quot;</span><span style="color:#24292E">))</span></span>
<span class="line"><span style="color:#24292E">  </span></span>
<span class="line"><span style="color:#D73A49">  override</span><span style="color:#D73A49"> val</span><span style="color:#24292E"> baseUnit: </span><span style="color:#6F42C1">Unit</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">Money</span><span style="color:#24292E">&gt; </span><span style="color:#D73A49">=</span><span style="color:#24292E"> USD  </span><span style="color:#6A737D">// 기준 통화: USD</span></span>
<span class="line"><span style="color:#24292E">  </span></span>
<span class="line"><span style="color:#D73A49">  override</span><span style="color:#D73A49"> val</span><span style="color:#24292E"> availableUnits: </span><span style="color:#6F42C1">Set</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">Unit</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">Money</span><span style="color:#24292E">&gt;&gt; </span><span style="color:#D73A49">=</span><span style="color:#6F42C1"> setOf</span><span style="color:#24292E">(</span></span>
<span class="line"><span style="color:#24292E">    USD, EUR, GBP, JPY, KRW</span></span>
<span class="line"><span style="color:#24292E">  )</span></span>
<span class="line"><span style="color:#24292E">  </span></span>
<span class="line"><span style="color:#6A737D">  // 통화 코드로 통화 단위 찾기</span></span>
<span class="line"><span style="color:#D73A49">  fun</span><span style="color:#6F42C1"> getUnitByCode</span><span style="color:#24292E">(code: </span><span style="color:#6F42C1">String</span><span style="color:#24292E">): </span><span style="color:#6F42C1">CurrencyUnit</span><span style="color:#24292E">? {</span></span>
<span class="line"><span style="color:#D73A49">    return</span><span style="color:#24292E"> availableUnits.</span><span style="color:#6F42C1">find</span><span style="color:#24292E"> { </span></span>
<span class="line"><span style="color:#24292E">      (it </span><span style="color:#D73A49">as</span><span style="color:#24292E"> CurrencyUnit).code.</span><span style="color:#6F42C1">equals</span><span style="color:#24292E">(code, ignoreCase </span><span style="color:#D73A49">=</span><span style="color:#005CC5"> true</span><span style="color:#24292E">)</span></span>
<span class="line"><span style="color:#24292E">    } </span><span style="color:#D73A49">as</span><span style="color:#24292E"> CurrencyUnit?</span></span>
<span class="line"><span style="color:#24292E">  }</span></span>
<span class="line"><span style="color:#24292E">  </span></span>
<span class="line"><span style="color:#6A737D">  // 환율 업데이트</span></span>
<span class="line"><span style="color:#D73A49">  fun</span><span style="color:#6F42C1"> updateExchangeRate</span><span style="color:#24292E">(currencyCode: </span><span style="color:#6F42C1">String</span><span style="color:#24292E">, newRate: </span><span style="color:#6F42C1">BigDecimal</span><span style="color:#24292E">) {</span></span>
<span class="line"><span style="color:#D73A49">    val</span><span style="color:#24292E"> currency </span><span style="color:#D73A49">=</span><span style="color:#6F42C1"> getUnitByCode</span><span style="color:#24292E">(currencyCode) ?: </span></span>
<span class="line"><span style="color:#D73A49">      throw</span><span style="color:#6F42C1"> IllegalArgumentException</span><span style="color:#24292E">(</span><span style="color:#032F62">&quot;Unknown currency code: </span><span style="color:#005CC5">$currencyCode</span><span style="color:#032F62">&quot;</span><span style="color:#24292E">)</span></span>
<span class="line"><span style="color:#24292E">        </span></span>
<span class="line"><span style="color:#24292E">    currency.exchangeRate </span><span style="color:#D73A49">=</span><span style="color:#24292E"> newRate</span></span>
<span class="line"><span style="color:#24292E">  }</span></span>
<span class="line"><span style="color:#24292E">}</span></span></code></pre>
<p><code>CurrencySystem</code>은 주요 통화들을 정의하고, 기준 통화와 사용 가능한 통화 단위들을 관리한다. 또한 통화 코드로 단위를 찾는 메서드와 환율을 업데이트하는 메서드를 제공한다.  여기서는 단순화를 위해 환율 정보를 하드코딩된 값으로 사용했지만, 실제 애플리케이션에서는 외부 API를 통해 실시간으로 가져와서 최신 환율을 반영해야 한다. 예를 들어, <a href="https://openexchangerates.org/" rel="noopener noreferrer" target="_blank">Open Exchange Rates</a>와 같은 서비스를 사용하여 환율 정보를 가져올 수 있다. 여기서 환율 정보를 가져오는 구현은 생략한다.</p>
<p>이제 <code>Money</code> 클래스를 사용하여 화폐를 표현하고, 다양한 연산을 수행할 수 있다. 예를 들어, 다음과 같이 화폐 객체를 생성하고 연산을 수행할 수 있다.</p>
<pre class="astro-code github-light" style="background-color:#fff;color:#24292e;overflow-x:auto" tabindex="0" data-language="kotlin"><code><span class="line"><span style="color:#6A737D">// 화폐 생성</span></span>
<span class="line"><span style="color:#D73A49">val</span><span style="color:#24292E"> usd100 </span><span style="color:#D73A49">=</span><span style="color:#24292E"> Money.</span><span style="color:#6F42C1">usd</span><span style="color:#24292E">(</span><span style="color:#005CC5">100.0</span><span style="color:#24292E">)</span></span>
<span class="line"><span style="color:#D73A49">val</span><span style="color:#24292E"> eur50 </span><span style="color:#D73A49">=</span><span style="color:#24292E"> Money.</span><span style="color:#6F42C1">eur</span><span style="color:#24292E">(</span><span style="color:#005CC5">50.0</span><span style="color:#24292E">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">// 간단한 포맷팅</span></span>
<span class="line"><span style="color:#6F42C1">println</span><span style="color:#24292E">(</span><span style="color:#032F62">&quot;USD amount: ${usd100.</span><span style="color:#6F42C1">formatSimple</span><span style="color:#032F62">()}&quot;</span><span style="color:#24292E">)  </span><span style="color:#6A737D">// &quot;USD amount: $100.0&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">// 지역화된 포맷팅</span></span>
<span class="line"><span style="color:#6F42C1">println</span><span style="color:#24292E">(</span><span style="color:#032F62">&quot;EUR amount in US format: ${eur50.</span><span style="color:#6F42C1">format</span><span style="color:#032F62">(Locale.US)}&quot;</span><span style="color:#24292E">)  </span><span style="color:#6A737D">// &quot;EUR amount in US format: €50.00&quot;</span></span>
<span class="line"><span style="color:#6F42C1">println</span><span style="color:#24292E">(</span><span style="color:#032F62">&quot;EUR amount in German format: ${eur50.</span><span style="color:#6F42C1">format</span><span style="color:#032F62">(Locale.GERMANY)}&quot;</span><span style="color:#24292E">)  </span><span style="color:#6A737D">// &quot;EUR amount in German format: 50,00 €&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">// 통화 변환</span></span>
<span class="line"><span style="color:#D73A49">val</span><span style="color:#24292E"> eurToUsd </span><span style="color:#D73A49">=</span><span style="color:#24292E"> eur50.</span><span style="color:#6F42C1">convertTo</span><span style="color:#24292E">(CurrencySystem.USD)</span></span>
<span class="line"><span style="color:#6F42C1">println</span><span style="color:#24292E">(</span><span style="color:#032F62">&quot;50 EUR = ${eurToUsd.</span><span style="color:#6F42C1">formatSimple</span><span style="color:#032F62">()}&quot;</span><span style="color:#24292E">)  </span><span style="color:#6A737D">// &quot;50 EUR = $54.5&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">// 화폐 연산</span></span>
<span class="line"><span style="color:#D73A49">val</span><span style="color:#24292E"> total </span><span style="color:#D73A49">=</span><span style="color:#24292E"> usd100.</span><span style="color:#6F42C1">add</span><span style="color:#24292E">(eur50.</span><span style="color:#6F42C1">convertTo</span><span style="color:#24292E">(CurrencySystem.USD))</span></span>
<span class="line"><span style="color:#6F42C1">println</span><span style="color:#24292E">(</span><span style="color:#032F62">&quot;Total: ${total.</span><span style="color:#6F42C1">formatSimple</span><span style="color:#032F62">()}&quot;</span><span style="color:#24292E">)  </span><span style="color:#6A737D">// &quot;Total: $154.5&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">// 퍼센트 계산 (세금, 할인 등)</span></span>
<span class="line"><span style="color:#D73A49">val</span><span style="color:#24292E"> tax </span><span style="color:#D73A49">=</span><span style="color:#24292E"> usd100.</span><span style="color:#6F42C1">percentage</span><span style="color:#24292E">(</span><span style="color:#005CC5">8.0</span><span style="color:#24292E">)  </span><span style="color:#6A737D">// 8% 세금</span></span>
<span class="line"><span style="color:#6F42C1">println</span><span style="color:#24292E">(</span><span style="color:#032F62">&quot;8% tax on </span><span style="color:#005CC5">$100</span><span style="color:#032F62">: ${tax.</span><span style="color:#6F42C1">formatSimple</span><span style="color:#032F62">()}&quot;</span><span style="color:#24292E">)  </span><span style="color:#6A737D">// &quot;8% tax on $100: $8.0&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">val</span><span style="color:#24292E"> withTax </span><span style="color:#D73A49">=</span><span style="color:#24292E"> usd100.</span><span style="color:#6F42C1">addPercentage</span><span style="color:#24292E">(</span><span style="color:#005CC5">8.0</span><span style="color:#24292E">)  </span><span style="color:#6A737D">// 세금 포함 금액</span></span>
<span class="line"><span style="color:#6F42C1">println</span><span style="color:#24292E">(</span><span style="color:#032F62">&quot;</span><span style="color:#005CC5">$100</span><span style="color:#032F62"> with 8% tax: ${withTax.</span><span style="color:#6F42C1">formatSimple</span><span style="color:#032F62">()}&quot;</span><span style="color:#24292E">)  </span><span style="color:#6A737D">// &quot;$100 with 8% tax: $108.0&quot;</span></span></code></pre>
<p>이런 방식을 통해 수량 모델과는 다르게, 화폐라는 특수한 모델에 대해서도 대응이 가능하다. 보통 특수한 측도는 다음과 같은 특성을 가진다.</p>
<ul>
<li>비선형 변환: 단순한 곱셈/나눗셈이 아닌 복잡한 변환 공식이 필요하다.</li>
<li>특별한 의미론: 덧셈, 뺄셈 등 연산의 의미가 일반 측도와 다를 수 있다.</li>
<li>도메인 특화 로직: 각 도메인에 특화된 추가 기능이 필요하다.</li>
<li>문화적/지역적 차이: 같은 측도도 문화권이나 지역에 따라 다른 표현 방식을 가질 수 있다.</li>
</ul>
<p>화폐 외에도 데이터 크기(KB, MB, GB 등), 시간, 온도, 주파수 등은 일반적인 물리적 수량과는 다른 변환 관계나 연산을 가지므로, 수량 모델이 아닌 별도의 모델이 필요하다.</p>
<h1 id="수학적-측도"><a href="#수학적-측도">수학적 측도</a></h1>
<p>앞서 다룬 일상적인 단위 외에 수학적 측도는 물리적 수량과는 다른 개념으로, 비율(Ratio)이나 각도(Angle), 지수(Exponent) 등과 같은 수학적 개념을 표현하는 데 사용된다.</p>
<p>수학적 측도는 기존 측도를 이용하여 연산 후 결과를 표현하는 데 사용된다. 예를 들어, 비율은 두 수량 간의 관계를 나타내며, 각도는 회전이나 기울기를 나타낸다. 이러한 측도는 일반적으로 물리적 수량과는 다른 연산 규칙을 가지므로, 별도의 모델로 구현하는 것이 좋다.</p>
<p>먼저 비율을 살펴보자. 비율은 두 수량 간의 관계를 나타내는 값으로, 일반적으로 분수 형태로 표현된다. 이를 표현할 수 있는 <code>Ratio</code>를 구현해보자.</p>
<pre class="astro-code github-light" style="background-color:#fff;color:#24292e;overflow-x:auto" tabindex="0" data-language="kotlin"><code><span class="line"><span style="color:#D73A49">class</span><span style="color:#6F42C1"> RatioUnit</span><span style="color:#24292E">(</span></span>
<span class="line"><span style="color:#D73A49">    override</span><span style="color:#D73A49"> val</span><span style="color:#24292E"> symbol: </span><span style="color:#6F42C1">String</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#D73A49">    override</span><span style="color:#D73A49"> val</span><span style="color:#24292E"> name: </span><span style="color:#6F42C1">String</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#D73A49">    val</span><span style="color:#24292E"> conversionFactor: </span><span style="color:#6F42C1">BigDecimal</span><span style="color:#6A737D">  // 십진수(decimal) 기준 변환 계수</span></span>
<span class="line"><span style="color:#24292E">) : </span><span style="color:#6F42C1">Unit</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">Ratio</span><span style="color:#24292E">&gt; {</span></span>
<span class="line"><span style="color:#D73A49">  override</span><span style="color:#D73A49"> fun</span><span style="color:#6F42C1"> convert</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">: </span><span style="color:#6F42C1">BigDecimal</span><span style="color:#24292E">, toUnit: </span><span style="color:#6F42C1">Unit</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">Ratio</span><span style="color:#24292E">&gt;): </span><span style="color:#6F42C1">BigDecimal</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">    toUnit </span><span style="color:#D73A49">as</span><span style="color:#24292E"> RatioUnit</span></span>
<span class="line"><span style="color:#24292E">    </span></span>
<span class="line"><span style="color:#6A737D">    // 기본 단위(십진수)로 변환 후 목표 단위로 변환</span></span>
<span class="line"><span style="color:#D73A49">    val</span><span style="color:#24292E"> valueInDecimal </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> value</span><span style="color:#24292E">.</span><span style="color:#6F42C1">multiply</span><span style="color:#24292E">(conversionFactor)</span></span>
<span class="line"><span style="color:#D73A49">    return</span><span style="color:#24292E"> valueInDecimal.</span><span style="color:#6F42C1">divide</span><span style="color:#24292E">(toUnit.conversionFactor, </span><span style="color:#005CC5">10</span><span style="color:#24292E">, RoundingMode.HALF_UP)</span></span>
<span class="line"><span style="color:#24292E">  }</span></span>
<span class="line"><span style="color:#24292E">  </span></span>
<span class="line"><span style="color:#D73A49">  override</span><span style="color:#D73A49"> fun</span><span style="color:#6F42C1"> create</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">: </span><span style="color:#6F42C1">BigDecimal</span><span style="color:#24292E">): </span><span style="color:#6F42C1">Ratio</span><span style="color:#D73A49"> =</span><span style="color:#24292E"> Ratio.</span><span style="color:#6F42C1">of</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">, </span><span style="color:#005CC5">this</span><span style="color:#24292E">)</span></span>
<span class="line"><span style="color:#24292E">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">class</span><span style="color:#6F42C1"> Ratio</span><span style="color:#D73A49"> private</span><span style="color:#6F42C1"> constructor</span><span style="color:#24292E">(</span></span>
<span class="line"><span style="color:#D73A49">  value</span><span style="color:#24292E">: </span><span style="color:#6F42C1">BigDecimal</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#24292E">  unit: </span><span style="color:#6F42C1">RatioUnit</span></span>
<span class="line"><span style="color:#24292E">) : </span><span style="color:#6F42C1">AbstractMeasure</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">Ratio</span><span style="color:#24292E">&gt;(</span><span style="color:#6F42C1">value</span><span style="color:#24292E">, </span><span style="color:#6F42C1">unit</span><span style="color:#24292E">) {</span></span>
<span class="line"><span style="color:#D73A49">  companion</span><span style="color:#D73A49"> object</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#D73A49">    fun</span><span style="color:#6F42C1"> of</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">: </span><span style="color:#6F42C1">BigDecimal</span><span style="color:#24292E">, unit: </span><span style="color:#6F42C1">RatioUnit</span><span style="color:#24292E">): </span><span style="color:#6F42C1">Ratio</span><span style="color:#D73A49"> =</span><span style="color:#6F42C1"> Ratio</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">, unit)</span></span>
<span class="line"><span style="color:#D73A49">    fun</span><span style="color:#6F42C1"> of</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">: </span><span style="color:#6F42C1">Double</span><span style="color:#24292E">, unit: </span><span style="color:#6F42C1">RatioUnit</span><span style="color:#24292E">): </span><span style="color:#6F42C1">Ratio</span><span style="color:#D73A49"> =</span><span style="color:#6F42C1"> of</span><span style="color:#24292E">(BigDecimal.</span><span style="color:#6F42C1">valueOf</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">), unit)</span></span>
<span class="line"><span style="color:#24292E">    </span></span>
<span class="line"><span style="color:#6A737D">    // 편의 메서드</span></span>
<span class="line"><span style="color:#D73A49">    fun</span><span style="color:#6F42C1"> decimal</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">: </span><span style="color:#6F42C1">Double</span><span style="color:#24292E">): </span><span style="color:#6F42C1">Ratio</span><span style="color:#D73A49"> =</span><span style="color:#6F42C1"> of</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">, RatioSystem.DECIMAL)</span></span>
<span class="line"><span style="color:#D73A49">    fun</span><span style="color:#6F42C1"> percentage</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">: </span><span style="color:#6F42C1">Double</span><span style="color:#24292E">): </span><span style="color:#6F42C1">Ratio</span><span style="color:#D73A49"> =</span><span style="color:#6F42C1"> of</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">, RatioSystem.PERCENTAGE)</span></span>
<span class="line"><span style="color:#D73A49">    fun</span><span style="color:#6F42C1"> permille</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">: </span><span style="color:#6F42C1">Double</span><span style="color:#24292E">): </span><span style="color:#6F42C1">Ratio</span><span style="color:#D73A49"> =</span><span style="color:#6F42C1"> of</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">, RatioSystem.PERMILLE)</span></span>
<span class="line"><span style="color:#D73A49">    fun</span><span style="color:#6F42C1"> fraction</span><span style="color:#24292E">(numerator: </span><span style="color:#6F42C1">Int</span><span style="color:#24292E">, denominator: </span><span style="color:#6F42C1">Int</span><span style="color:#24292E">): </span><span style="color:#6F42C1">Ratio</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#D73A49">        val</span><span style="color:#D73A49"> value</span><span style="color:#D73A49"> =</span><span style="color:#24292E"> BigDecimal.</span><span style="color:#6F42C1">valueOf</span><span style="color:#24292E">(numerator.</span><span style="color:#6F42C1">toLong</span><span style="color:#24292E">())</span></span>
<span class="line"><span style="color:#24292E">            .</span><span style="color:#6F42C1">divide</span><span style="color:#24292E">(BigDecimal.</span><span style="color:#6F42C1">valueOf</span><span style="color:#24292E">(denominator.</span><span style="color:#6F42C1">toLong</span><span style="color:#24292E">()), </span><span style="color:#005CC5">10</span><span style="color:#24292E">, RoundingMode.HALF_UP)</span></span>
<span class="line"><span style="color:#D73A49">        return</span><span style="color:#6F42C1"> decimal</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">.</span><span style="color:#6F42C1">toDouble</span><span style="color:#24292E">())</span></span>
<span class="line"><span style="color:#24292E">    }</span></span>
<span class="line"><span style="color:#24292E">  }</span></span>
<span class="line"><span style="color:#24292E">    </span></span>
<span class="line"><span style="color:#D73A49">  override</span><span style="color:#D73A49"> fun</span><span style="color:#6F42C1"> getUnitSystem</span><span style="color:#24292E">(): </span><span style="color:#6F42C1">UnitSystem</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">Ratio</span><span style="color:#24292E">&gt; </span><span style="color:#D73A49">=</span><span style="color:#24292E"> RatioSystem</span></span>
<span class="line"><span style="color:#24292E">  </span></span>
<span class="line"><span style="color:#6A737D">  // 편의 변환 메서드</span></span>
<span class="line"><span style="color:#D73A49">  fun</span><span style="color:#6F42C1"> toPercentage</span><span style="color:#24292E">(): </span><span style="color:#6F42C1">Ratio</span><span style="color:#D73A49"> =</span><span style="color:#6F42C1"> convertTo</span><span style="color:#24292E">(RatioSystem.PERCENTAGE)</span></span>
<span class="line"><span style="color:#D73A49">  fun</span><span style="color:#6F42C1"> toDecimal</span><span style="color:#24292E">(): </span><span style="color:#6F42C1">Ratio</span><span style="color:#D73A49"> =</span><span style="color:#6F42C1"> convertTo</span><span style="color:#24292E">(RatioSystem.DECIMAL)</span></span>
<span class="line"><span style="color:#24292E">  </span></span>
<span class="line"><span style="color:#6A737D">  // 두 측도의 비율 계산을 위한 정적 메서드</span></span>
<span class="line"><span style="color:#D73A49">  companion</span><span style="color:#D73A49"> object</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#D73A49">    fun</span><span style="color:#24292E"> &lt;</span><span style="color:#6F42C1">T</span><span style="color:#24292E"> : </span><span style="color:#6F42C1">Measure</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">T</span><span style="color:#24292E">&gt;&gt; </span><span style="color:#6F42C1">between</span><span style="color:#24292E">(value1: </span><span style="color:#6F42C1">T</span><span style="color:#24292E">, value2: </span><span style="color:#6F42C1">T</span><span style="color:#24292E">): </span><span style="color:#6F42C1">Ratio</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#D73A49">      if</span><span style="color:#24292E"> (value1.unit </span><span style="color:#D73A49">!=</span><span style="color:#24292E"> value2.unit) {</span></span>
<span class="line"><span style="color:#D73A49">        throw</span><span style="color:#6F42C1"> IllegalArgumentException</span><span style="color:#24292E">(</span><span style="color:#032F62">&quot;Cannot compute ratio between different units without conversion&quot;</span><span style="color:#24292E">)</span></span>
<span class="line"><span style="color:#24292E">      }</span></span>
<span class="line"><span style="color:#24292E">      </span></span>
<span class="line"><span style="color:#D73A49">      val</span><span style="color:#24292E"> ratio </span><span style="color:#D73A49">=</span><span style="color:#24292E"> value1.</span><span style="color:#D73A49">value</span><span style="color:#24292E">.</span><span style="color:#6F42C1">divide</span><span style="color:#24292E">(value2.</span><span style="color:#D73A49">value</span><span style="color:#24292E">, </span><span style="color:#005CC5">10</span><span style="color:#24292E">, RoundingMode.HALF_UP)</span></span>
<span class="line"><span style="color:#D73A49">      return</span><span style="color:#6F42C1"> decimal</span><span style="color:#24292E">(ratio.</span><span style="color:#6F42C1">toDouble</span><span style="color:#24292E">())</span></span>
<span class="line"><span style="color:#24292E">    }</span></span>
<span class="line"><span style="color:#24292E">    </span></span>
<span class="line"><span style="color:#6A737D">    // 측도의 변화율 계산</span></span>
<span class="line"><span style="color:#D73A49">    fun</span><span style="color:#24292E"> &lt;</span><span style="color:#6F42C1">T</span><span style="color:#24292E"> : </span><span style="color:#6F42C1">Measure</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">T</span><span style="color:#24292E">&gt;&gt; </span><span style="color:#6F42C1">changeRate</span><span style="color:#24292E">(oldValue: </span><span style="color:#6F42C1">T</span><span style="color:#24292E">, newValue: </span><span style="color:#6F42C1">T</span><span style="color:#24292E">): </span><span style="color:#6F42C1">Ratio</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#D73A49">      val</span><span style="color:#24292E"> convertedNew </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> if</span><span style="color:#24292E"> (oldValue.unit </span><span style="color:#D73A49">!=</span><span style="color:#24292E"> newValue.unit) {</span></span>
<span class="line"><span style="color:#24292E">        newValue.</span><span style="color:#6F42C1">convertTo</span><span style="color:#24292E">(oldValue.unit </span><span style="color:#D73A49">as</span><span style="color:#24292E"> Unit</span><span style="color:#D73A49">&lt;</span><span style="color:#24292E">T</span><span style="color:#D73A49">&gt;</span><span style="color:#24292E">)</span></span>
<span class="line"><span style="color:#24292E">      } </span><span style="color:#D73A49">else</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">        newValue</span></span>
<span class="line"><span style="color:#24292E">      }</span></span>
<span class="line"><span style="color:#24292E">      </span></span>
<span class="line"><span style="color:#D73A49">      val</span><span style="color:#24292E"> change </span><span style="color:#D73A49">=</span><span style="color:#24292E"> convertedNew.</span><span style="color:#D73A49">value</span><span style="color:#24292E">.</span><span style="color:#6F42C1">subtract</span><span style="color:#24292E">(oldValue.</span><span style="color:#D73A49">value</span><span style="color:#24292E">)</span></span>
<span class="line"><span style="color:#D73A49">      val</span><span style="color:#24292E"> rate </span><span style="color:#D73A49">=</span><span style="color:#24292E"> change.</span><span style="color:#6F42C1">divide</span><span style="color:#24292E">(oldValue.</span><span style="color:#D73A49">value</span><span style="color:#24292E">, </span><span style="color:#005CC5">10</span><span style="color:#24292E">, RoundingMode.HALF_UP)</span></span>
<span class="line"><span style="color:#24292E">      </span></span>
<span class="line"><span style="color:#D73A49">      return</span><span style="color:#6F42C1"> decimal</span><span style="color:#24292E">(rate.</span><span style="color:#6F42C1">toDouble</span><span style="color:#24292E">())</span></span>
<span class="line"><span style="color:#24292E">    }</span></span>
<span class="line"><span style="color:#24292E">  }</span></span>
<span class="line"><span style="color:#24292E">  </span></span>
<span class="line"><span style="color:#6A737D">  // 비율 연산</span></span>
<span class="line"><span style="color:#D73A49">  fun</span><span style="color:#6F42C1"> add</span><span style="color:#24292E">(other: </span><span style="color:#6F42C1">Ratio</span><span style="color:#24292E">): </span><span style="color:#6F42C1">Ratio</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#D73A49">    val</span><span style="color:#24292E"> convertedOther </span><span style="color:#D73A49">=</span><span style="color:#24292E"> other.</span><span style="color:#6F42C1">convertTo</span><span style="color:#24292E">(unit </span><span style="color:#D73A49">as</span><span style="color:#24292E"> RatioUnit)</span></span>
<span class="line"><span style="color:#D73A49">    val</span><span style="color:#24292E"> sum </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> value</span><span style="color:#24292E">.</span><span style="color:#6F42C1">add</span><span style="color:#24292E">(convertedOther.</span><span style="color:#D73A49">value</span><span style="color:#24292E">)</span></span>
<span class="line"><span style="color:#D73A49">    return</span><span style="color:#24292E"> Ratio.</span><span style="color:#6F42C1">of</span><span style="color:#24292E">(sum, unit </span><span style="color:#D73A49">as</span><span style="color:#24292E"> RatioUnit)</span></span>
<span class="line"><span style="color:#24292E">  }</span></span>
<span class="line"><span style="color:#24292E">  </span></span>
<span class="line"><span style="color:#D73A49">  operator</span><span style="color:#D73A49"> fun</span><span style="color:#6F42C1"> plus</span><span style="color:#24292E">(other: </span><span style="color:#6F42C1">Ratio</span><span style="color:#24292E">): </span><span style="color:#6F42C1">Ratio</span><span style="color:#D73A49"> =</span><span style="color:#6F42C1"> add</span><span style="color:#24292E">(other)</span></span>
<span class="line"><span style="color:#24292E">  </span></span>
<span class="line"><span style="color:#6A737D">  // 측도에 비율 적용</span></span>
<span class="line"><span style="color:#D73A49">  fun</span><span style="color:#24292E"> &lt;</span><span style="color:#6F42C1">T</span><span style="color:#24292E"> : </span><span style="color:#6F42C1">Measure</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">T</span><span style="color:#24292E">&gt;&gt; </span><span style="color:#6F42C1">applyTo</span><span style="color:#24292E">(measure: </span><span style="color:#6F42C1">T</span><span style="color:#24292E">): </span><span style="color:#6F42C1">T</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#D73A49">    val</span><span style="color:#24292E"> decimalRatio </span><span style="color:#D73A49">=</span><span style="color:#005CC5"> this</span><span style="color:#24292E">.</span><span style="color:#6F42C1">convertTo</span><span style="color:#24292E">(RatioSystem.DECIMAL)</span></span>
<span class="line"><span style="color:#D73A49">    return</span><span style="color:#24292E"> measure.</span><span style="color:#6F42C1">multiply</span><span style="color:#24292E">(decimalRatio.</span><span style="color:#D73A49">value</span><span style="color:#24292E">)</span></span>
<span class="line"><span style="color:#24292E">  }</span></span>
<span class="line"><span style="color:#24292E">  </span></span>
<span class="line"><span style="color:#6A737D">  // 증가율 적용 (1 + rate)</span></span>
<span class="line"><span style="color:#D73A49">  fun</span><span style="color:#24292E"> &lt;</span><span style="color:#6F42C1">T</span><span style="color:#24292E"> : </span><span style="color:#6F42C1">Measure</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">T</span><span style="color:#24292E">&gt;&gt; </span><span style="color:#6F42C1">increase</span><span style="color:#24292E">(measure: </span><span style="color:#6F42C1">T</span><span style="color:#24292E">): </span><span style="color:#6F42C1">T</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#D73A49">    val</span><span style="color:#24292E"> decimalRatio </span><span style="color:#D73A49">=</span><span style="color:#005CC5"> this</span><span style="color:#24292E">.</span><span style="color:#6F42C1">convertTo</span><span style="color:#24292E">(RatioSystem.DECIMAL)</span></span>
<span class="line"><span style="color:#D73A49">    val</span><span style="color:#24292E"> factor </span><span style="color:#D73A49">=</span><span style="color:#24292E"> BigDecimal.ONE.</span><span style="color:#6F42C1">add</span><span style="color:#24292E">(decimalRatio.</span><span style="color:#D73A49">value</span><span style="color:#24292E">)</span></span>
<span class="line"><span style="color:#D73A49">    return</span><span style="color:#24292E"> measure.</span><span style="color:#6F42C1">multiply</span><span style="color:#24292E">(factor)</span></span>
<span class="line"><span style="color:#24292E">  }</span></span>
<span class="line"><span style="color:#24292E">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">object</span><span style="color:#6F42C1"> RatioSystem</span><span style="color:#24292E"> : </span><span style="color:#6F42C1">AbstractUnitSystem</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">Ratio</span><span style="color:#24292E">&gt;() {</span></span>
<span class="line"><span style="color:#D73A49">  val</span><span style="color:#24292E"> DECIMAL </span><span style="color:#D73A49">=</span><span style="color:#6F42C1"> RatioUnit</span><span style="color:#24292E">(</span><span style="color:#032F62">&quot;&quot;</span><span style="color:#24292E">, </span><span style="color:#032F62">&quot;decimal&quot;</span><span style="color:#24292E">, BigDecimal.ONE)</span></span>
<span class="line"><span style="color:#D73A49">  val</span><span style="color:#24292E"> PERCENTAGE </span><span style="color:#D73A49">=</span><span style="color:#6F42C1"> RatioUnit</span><span style="color:#24292E">(</span><span style="color:#032F62">&quot;%&quot;</span><span style="color:#24292E">, </span><span style="color:#032F62">&quot;percentage&quot;</span><span style="color:#24292E">, </span><span style="color:#6F42C1">BigDecimal</span><span style="color:#24292E">(</span><span style="color:#032F62">&quot;0.01&quot;</span><span style="color:#24292E">))</span></span>
<span class="line"><span style="color:#D73A49">  val</span><span style="color:#24292E"> PERMILLE </span><span style="color:#D73A49">=</span><span style="color:#6F42C1"> RatioUnit</span><span style="color:#24292E">(</span><span style="color:#032F62">&quot;‰&quot;</span><span style="color:#24292E">, </span><span style="color:#032F62">&quot;permille&quot;</span><span style="color:#24292E">, </span><span style="color:#6F42C1">BigDecimal</span><span style="color:#24292E">(</span><span style="color:#032F62">&quot;0.001&quot;</span><span style="color:#24292E">))</span></span>
<span class="line"><span style="color:#D73A49">  val</span><span style="color:#24292E"> BASIS_POINT </span><span style="color:#D73A49">=</span><span style="color:#6F42C1"> RatioUnit</span><span style="color:#24292E">(</span><span style="color:#032F62">&quot;bp&quot;</span><span style="color:#24292E">, </span><span style="color:#032F62">&quot;basis point&quot;</span><span style="color:#24292E">, </span><span style="color:#6F42C1">BigDecimal</span><span style="color:#24292E">(</span><span style="color:#032F62">&quot;0.0001&quot;</span><span style="color:#24292E">))</span></span>
<span class="line"><span style="color:#24292E">  </span></span>
<span class="line"><span style="color:#D73A49">  override</span><span style="color:#D73A49"> val</span><span style="color:#24292E"> baseUnit: </span><span style="color:#6F42C1">Unit</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">Ratio</span><span style="color:#24292E">&gt; </span><span style="color:#D73A49">=</span><span style="color:#24292E"> DECIMAL</span></span>
<span class="line"><span style="color:#24292E">  </span></span>
<span class="line"><span style="color:#D73A49">  override</span><span style="color:#D73A49"> val</span><span style="color:#24292E"> availableUnits: </span><span style="color:#6F42C1">Set</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">Unit</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">Ratio</span><span style="color:#24292E">&gt;&gt; </span><span style="color:#D73A49">=</span><span style="color:#6F42C1"> setOf</span><span style="color:#24292E">(</span></span>
<span class="line"><span style="color:#24292E">    DECIMAL, PERCENTAGE, PERMILLE, BASIS_POINT</span></span>
<span class="line"><span style="color:#24292E">  )</span></span>
<span class="line"><span style="color:#24292E">}</span></span></code></pre>
<p>위와 같이 <code>Ratio</code>를 구현하면, 두 수량 간의 비율을 쉽게 계산할 수 있다. 예를 들어, 두 무게 간의 비율을 계산할 때는 다음과 같이 사용할 수 있다.</p>
<pre class="astro-code github-light" style="background-color:#fff;color:#24292e;overflow-x:auto" tabindex="0" data-language="kotlin"><code><span class="line"><span style="color:#D73A49">val</span><span style="color:#24292E"> weight1 </span><span style="color:#D73A49">=</span><span style="color:#24292E"> Weight.</span><span style="color:#6F42C1">kilograms</span><span style="color:#24292E">(</span><span style="color:#005CC5">50.0</span><span style="color:#24292E">)</span></span>
<span class="line"><span style="color:#D73A49">val</span><span style="color:#24292E"> weight2 </span><span style="color:#D73A49">=</span><span style="color:#24292E"> Weight.</span><span style="color:#6F42C1">kilograms</span><span style="color:#24292E">(</span><span style="color:#005CC5">25.0</span><span style="color:#24292E">)</span></span>
<span class="line"><span style="color:#D73A49">val</span><span style="color:#24292E"> ratio </span><span style="color:#D73A49">=</span><span style="color:#24292E"> Ratio.</span><span style="color:#6F42C1">between</span><span style="color:#24292E">(weight1, weight2)</span></span>
<span class="line"><span style="color:#6F42C1">println</span><span style="color:#24292E">(</span><span style="color:#032F62">&quot;Ratio of weight1 to weight2: ${ratio}&quot;</span><span style="color:#24292E">)  </span><span style="color:#6A737D">// &quot;Ratio of weight1 to weight2: 2.0&quot;</span></span></code></pre>
<p>혹은 이자와 같은 금융 비율을 계산할 때도 사용할 수 있다.</p>
<pre class="astro-code github-light" style="background-color:#fff;color:#24292e;overflow-x:auto" tabindex="0" data-language="kotlin"><code><span class="line"><span style="color:#D73A49">val</span><span style="color:#24292E"> interestRate </span><span style="color:#D73A49">=</span><span style="color:#24292E"> Ratio.</span><span style="color:#6F42C1">percentage</span><span style="color:#24292E">(</span><span style="color:#005CC5">5.0</span><span style="color:#24292E">)  </span><span style="color:#6A737D">// 5%</span></span>
<span class="line"><span style="color:#D73A49">val</span><span style="color:#24292E"> principal </span><span style="color:#D73A49">=</span><span style="color:#24292E"> Money.</span><span style="color:#6F42C1">usd</span><span style="color:#24292E">(</span><span style="color:#005CC5">1000.0</span><span style="color:#24292E">)</span></span>
<span class="line"><span style="color:#D73A49">val</span><span style="color:#24292E"> interest </span><span style="color:#D73A49">=</span><span style="color:#24292E"> interestRate.</span><span style="color:#6F42C1">applyTo</span><span style="color:#24292E">(principal)</span></span>
<span class="line"><span style="color:#6F42C1">println</span><span style="color:#24292E">(</span><span style="color:#032F62">&quot;Interest on </span><span style="color:#005CC5">$1000</span><span style="color:#032F62"> at 5%: ${interest.</span><span style="color:#6F42C1">formatSimple</span><span style="color:#032F62">()}&quot;</span><span style="color:#24292E">)  </span><span style="color:#6A737D">// &quot;Interest on $1000 at 5%: $50.0&quot;</span></span></code></pre>
<p>이렇게 수학적 측도를 구현하면, 다양한 수량 간의 관계를 표현하고 계산할 수 있다. 외에도 다양한 수학적 측도를 구현할 수 있으며, 각 측도에 맞는 단위와 변환 규칙을 정의하면 된다.</p>
<h1 id="복합-측도와-파생-측도"><a href="#복합-측도와-파생-측도">복합 측도와 파생 측도</a></h1>
<p>앞서 살펴본 기본 측도(수량)와 특수 측도(화폐 등)를 넘어, 현실 세계에서는 여러 측도가 결합되거나 파생되는 경우가 많다. 이러한 복합 측도와 파생 측도를 모델링하는 방법을 알아보자.</p>
<h2 id="복합-측도"><a href="#복합-측도">복합 측도</a></h2>
<p>복합 측도는 두 개 이상의 기본 측도가 결합된 형태를 말한다. 예를 들어 속도는 거리와 시간의 비율(km/h)로, 밀도는 질량과 부피의 비율(kg/m³)로 표현된다.</p>
<p>복합 측도를 모델링할 때는 기존 측도를 조합하여 새로운 측도를 생성하는 방식으로 구현할 수 있다. 예를 들어 속도를 표현하는 <code>Velocity</code>를 구현해보자.</p>
<p>먼저 속도에 대한 단위를 정의하는 <code>VelocityUnit</code> 클래스를 구현한다. 이 클래스는 거리 단위와 시간 단위를 조합하여 속도를 표현한다.</p>
<pre class="astro-code github-light" style="background-color:#fff;color:#24292e;overflow-x:auto" tabindex="0" data-language="kotlin"><code><span class="line"><span style="color:#D73A49">class</span><span style="color:#6F42C1"> VelocityUnit</span><span style="color:#24292E">(</span></span>
<span class="line"><span style="color:#D73A49">  override</span><span style="color:#D73A49"> val</span><span style="color:#24292E"> symbol: </span><span style="color:#6F42C1">String</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#D73A49">  override</span><span style="color:#D73A49"> val</span><span style="color:#24292E"> name: </span><span style="color:#6F42C1">String</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#6A737D">  // 거리 단위와 시간 단위를 조합</span></span>
<span class="line"><span style="color:#D73A49">  val</span><span style="color:#24292E"> distanceUnit: </span><span style="color:#6F42C1">Unit</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">Distance</span><span style="color:#24292E">&gt;,</span></span>
<span class="line"><span style="color:#D73A49">  val</span><span style="color:#24292E"> timeUnit: </span><span style="color:#6F42C1">Unit</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">Time</span><span style="color:#24292E">&gt;</span></span>
<span class="line"><span style="color:#24292E">) : </span><span style="color:#6F42C1">AbstractUnit</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">Velocity</span><span style="color:#24292E">&gt;() {</span></span>
<span class="line"><span style="color:#D73A49">  override</span><span style="color:#D73A49"> fun</span><span style="color:#6F42C1"> convert</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">: </span><span style="color:#6F42C1">BigDecimal</span><span style="color:#24292E">, toUnit: </span><span style="color:#6F42C1">Unit</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">Velocity</span><span style="color:#24292E">&gt;): </span><span style="color:#6F42C1">BigDecimal</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">    toUnit </span><span style="color:#D73A49">as</span><span style="color:#24292E"> VelocityUnit</span></span>
<span class="line"><span style="color:#24292E">    </span></span>
<span class="line"><span style="color:#6A737D">    // 거리 단위 변환 계수</span></span>
<span class="line"><span style="color:#D73A49">    val</span><span style="color:#24292E"> distanceFactor </span><span style="color:#D73A49">=</span><span style="color:#24292E"> distanceUnit.</span><span style="color:#6F42C1">convert</span><span style="color:#24292E">(</span></span>
<span class="line"><span style="color:#24292E">      BigDecimal.ONE, </span></span>
<span class="line"><span style="color:#24292E">      toUnit.distanceUnit</span></span>
<span class="line"><span style="color:#24292E">    )</span></span>
<span class="line"><span style="color:#24292E">    </span></span>
<span class="line"><span style="color:#6A737D">    // 시간 단위 변환 계수</span></span>
<span class="line"><span style="color:#D73A49">    val</span><span style="color:#24292E"> timeFactor </span><span style="color:#D73A49">=</span><span style="color:#24292E"> timeUnit.</span><span style="color:#6F42C1">convert</span><span style="color:#24292E">(</span></span>
<span class="line"><span style="color:#24292E">      BigDecimal.ONE,</span></span>
<span class="line"><span style="color:#24292E">      toUnit.timeUnit</span></span>
<span class="line"><span style="color:#24292E">    )</span></span>
<span class="line"><span style="color:#24292E">    </span></span>
<span class="line"><span style="color:#6A737D">    // 속도 변환: (거리 변환 / 시간 변환) * 원래 값</span></span>
<span class="line"><span style="color:#D73A49">    return</span><span style="color:#D73A49"> value</span><span style="color:#24292E">.</span><span style="color:#6F42C1">multiply</span><span style="color:#24292E">(distanceFactor).</span><span style="color:#6F42C1">divide</span><span style="color:#24292E">(timeFactor, </span><span style="color:#005CC5">10</span><span style="color:#24292E">, RoundingMode.HALF_UP)</span></span>
<span class="line"><span style="color:#24292E">  }</span></span>
<span class="line"><span style="color:#24292E">  </span></span>
<span class="line"><span style="color:#D73A49">  override</span><span style="color:#D73A49"> fun</span><span style="color:#6F42C1"> create</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">: </span><span style="color:#6F42C1">BigDecimal</span><span style="color:#24292E">): </span><span style="color:#6F42C1">Velocity</span><span style="color:#D73A49"> =</span><span style="color:#24292E"> Velocity.</span><span style="color:#6F42C1">of</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">, </span><span style="color:#005CC5">this</span><span style="color:#24292E">)</span></span>
<span class="line"><span style="color:#24292E">}</span></span></code></pre>
<p>위 코드를 보면 <code>VelocityUnit</code> 클래스는 거리 단위와 시간 단위를 조합하여 속도를 표현한다. <code>convert</code> 메서드는 거리 단위와 시간 단위를 각각 변환한 후, 속도 변환을 수행한다. 예를 들어 60km/h를 m/s로 변환할 때, 거리 단위는 km에서 m로, 시간 단위는 h에서 s로 변환하여 최종 속도를 계산한다.</p>
<p>다음으로 속도를 표현하는 <code>Velocity</code> 클래스를 구현해보자.</p>
<pre class="astro-code github-light" style="background-color:#fff;color:#24292e;overflow-x:auto" tabindex="0" data-language="kotlin"><code><span class="line"><span style="color:#D73A49">class</span><span style="color:#6F42C1"> Velocity</span><span style="color:#D73A49"> private</span><span style="color:#6F42C1"> constructor</span><span style="color:#24292E">(</span></span>
<span class="line"><span style="color:#D73A49">  value</span><span style="color:#24292E">: </span><span style="color:#6F42C1">BigDecimal</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#24292E">  unit: </span><span style="color:#6F42C1">VelocityUnit</span></span>
<span class="line"><span style="color:#24292E">) : </span><span style="color:#6F42C1">AbstractMeasure</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">Velocity</span><span style="color:#24292E">&gt;(</span><span style="color:#6F42C1">value</span><span style="color:#24292E">, </span><span style="color:#6F42C1">unit</span><span style="color:#24292E">) {</span></span>
<span class="line"><span style="color:#D73A49">  companion</span><span style="color:#D73A49"> object</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#D73A49">    fun</span><span style="color:#6F42C1"> of</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">: </span><span style="color:#6F42C1">BigDecimal</span><span style="color:#24292E">, unit: </span><span style="color:#6F42C1">VelocityUnit</span><span style="color:#24292E">): </span><span style="color:#6F42C1">Velocity</span><span style="color:#D73A49"> =</span><span style="color:#6F42C1"> Velocity</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">, unit)</span></span>
<span class="line"><span style="color:#D73A49">    fun</span><span style="color:#6F42C1"> of</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">: </span><span style="color:#6F42C1">Double</span><span style="color:#24292E">, unit: </span><span style="color:#6F42C1">VelocityUnit</span><span style="color:#24292E">): </span><span style="color:#6F42C1">Velocity</span><span style="color:#D73A49"> =</span><span style="color:#6F42C1"> of</span><span style="color:#24292E">(BigDecimal.</span><span style="color:#6F42C1">valueOf</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">), unit)</span></span>
<span class="line"><span style="color:#24292E">    </span></span>
<span class="line"><span style="color:#6A737D">    // 편의 메서드</span></span>
<span class="line"><span style="color:#D73A49">    fun</span><span style="color:#6F42C1"> metersPerSecond</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">: </span><span style="color:#6F42C1">Double</span><span style="color:#24292E">): </span><span style="color:#6F42C1">Velocity</span><span style="color:#D73A49"> =</span><span style="color:#6F42C1"> of</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">, VelocitySystem.METERS_PER_SECOND)</span></span>
<span class="line"><span style="color:#D73A49">    fun</span><span style="color:#6F42C1"> kilometersPerHour</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">: </span><span style="color:#6F42C1">Double</span><span style="color:#24292E">): </span><span style="color:#6F42C1">Velocity</span><span style="color:#D73A49"> =</span><span style="color:#6F42C1"> of</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">, VelocitySystem.KILOMETERS_PER_HOUR)</span></span>
<span class="line"><span style="color:#D73A49">    fun</span><span style="color:#6F42C1"> milesPerHour</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">: </span><span style="color:#6F42C1">Double</span><span style="color:#24292E">): </span><span style="color:#6F42C1">Velocity</span><span style="color:#D73A49"> =</span><span style="color:#6F42C1"> of</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">, VelocitySystem.MILES_PER_HOUR)</span></span>
<span class="line"><span style="color:#24292E">  }</span></span>
<span class="line"><span style="color:#24292E">  </span></span>
<span class="line"><span style="color:#D73A49">  override</span><span style="color:#D73A49"> fun</span><span style="color:#6F42C1"> getUnitSystem</span><span style="color:#24292E">(): </span><span style="color:#6F42C1">UnitSystem</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">Velocity</span><span style="color:#24292E">&gt; </span><span style="color:#D73A49">=</span><span style="color:#24292E"> VelocitySystem</span></span>
<span class="line"><span style="color:#24292E">  </span></span>
<span class="line"><span style="color:#6A737D">  // 거리 계산 (속도 × 시간)</span></span>
<span class="line"><span style="color:#D73A49">  fun</span><span style="color:#6F42C1"> multiply</span><span style="color:#24292E">(time: </span><span style="color:#6F42C1">Time</span><span style="color:#24292E">): </span><span style="color:#6F42C1">Distance</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#D73A49">    val</span><span style="color:#24292E"> velocityUnit </span><span style="color:#D73A49">=</span><span style="color:#24292E"> unit </span><span style="color:#D73A49">as</span><span style="color:#24292E"> VelocityUnit</span></span>
<span class="line"><span style="color:#D73A49">    val</span><span style="color:#24292E"> convertedTime </span><span style="color:#D73A49">=</span><span style="color:#24292E"> time.</span><span style="color:#6F42C1">convertTo</span><span style="color:#24292E">(velocityUnit.timeUnit)</span></span>
<span class="line"><span style="color:#24292E">    </span></span>
<span class="line"><span style="color:#D73A49">    val</span><span style="color:#24292E"> distanceValue </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> value</span><span style="color:#24292E">.</span><span style="color:#6F42C1">multiply</span><span style="color:#24292E">(convertedTime.</span><span style="color:#D73A49">value</span><span style="color:#24292E">)</span></span>
<span class="line"><span style="color:#D73A49">    return</span><span style="color:#24292E"> Distance.</span><span style="color:#6F42C1">of</span><span style="color:#24292E">(distanceValue, velocityUnit.distanceUnit </span><span style="color:#D73A49">as</span><span style="color:#24292E"> DistanceUnit)</span></span>
<span class="line"><span style="color:#24292E">  }</span></span>
<span class="line"><span style="color:#24292E">  </span></span>
<span class="line"><span style="color:#6A737D">  // 시간 계산 (거리 ÷ 속도)</span></span>
<span class="line"><span style="color:#D73A49">  fun</span><span style="color:#6F42C1"> timeToTravel</span><span style="color:#24292E">(distance: </span><span style="color:#6F42C1">Distance</span><span style="color:#24292E">): </span><span style="color:#6F42C1">Time</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#D73A49">    val</span><span style="color:#24292E"> velocityUnit </span><span style="color:#D73A49">=</span><span style="color:#24292E"> unit </span><span style="color:#D73A49">as</span><span style="color:#24292E"> VelocityUnit</span></span>
<span class="line"><span style="color:#D73A49">    val</span><span style="color:#24292E"> convertedDistance </span><span style="color:#D73A49">=</span><span style="color:#24292E"> distance.</span><span style="color:#6F42C1">convertTo</span><span style="color:#24292E">(velocityUnit.distanceUnit </span><span style="color:#D73A49">as</span><span style="color:#24292E"> DistanceUnit)</span></span>
<span class="line"><span style="color:#24292E">    </span></span>
<span class="line"><span style="color:#D73A49">    val</span><span style="color:#24292E"> timeValue </span><span style="color:#D73A49">=</span><span style="color:#24292E"> convertedDistance.</span><span style="color:#D73A49">value</span><span style="color:#24292E">.</span><span style="color:#6F42C1">divide</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">, </span><span style="color:#005CC5">10</span><span style="color:#24292E">, RoundingMode.HALF_UP)</span></span>
<span class="line"><span style="color:#D73A49">    return</span><span style="color:#24292E"> Time.</span><span style="color:#6F42C1">of</span><span style="color:#24292E">(timeValue, velocityUnit.timeUnit)</span></span>
<span class="line"><span style="color:#24292E">  }</span></span>
<span class="line"><span style="color:#24292E">}</span></span></code></pre>
<p>여기서 주목할 점은 <code>multiply</code> 메서드와 <code>timeToTravel</code> 메서드이다. <code>multiply</code> 메서드는 속도와 시간을 곱하여 거리를 계산하고, <code>timeToTravel</code> 메서드는 거리를 속도로 나누어 시간을 계산한다. 이처럼 복합 측도는 기본 측도를 조합하여 새로운 기능을 제공할 수 있다.</p>
<p>마지막으로 속도 단위계를 정의하는 <code>VelocitySystem</code>을 구현해보자.</p>
<pre class="astro-code github-light" style="background-color:#fff;color:#24292e;overflow-x:auto" tabindex="0" data-language="kotlin"><code><span class="line"><span style="color:#D73A49">object</span><span style="color:#6F42C1"> VelocitySystem</span><span style="color:#24292E"> : </span><span style="color:#6F42C1">AbstractUnitSystem</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">Velocity</span><span style="color:#24292E">&gt;() {</span></span>
<span class="line"><span style="color:#D73A49">  val</span><span style="color:#24292E"> METERS_PER_SECOND </span><span style="color:#D73A49">=</span><span style="color:#6F42C1"> VelocityUnit</span><span style="color:#24292E">(</span><span style="color:#032F62">&quot;m/s&quot;</span><span style="color:#24292E">, </span><span style="color:#032F62">&quot;meters per second&quot;</span><span style="color:#24292E">, </span></span>
<span class="line"><span style="color:#24292E">                                        DistanceSystem.METER, TimeSystem.SECOND)</span></span>
<span class="line"><span style="color:#24292E">  </span></span>
<span class="line"><span style="color:#D73A49">  val</span><span style="color:#24292E"> KILOMETERS_PER_HOUR </span><span style="color:#D73A49">=</span><span style="color:#6F42C1"> VelocityUnit</span><span style="color:#24292E">(</span><span style="color:#032F62">&quot;km/h&quot;</span><span style="color:#24292E">, </span><span style="color:#032F62">&quot;kilometers per hour&quot;</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#24292E">                                          DistanceSystem.KILOMETER, TimeSystem.HOUR)</span></span>
<span class="line"><span style="color:#24292E">  </span></span>
<span class="line"><span style="color:#D73A49">  val</span><span style="color:#24292E"> MILES_PER_HOUR </span><span style="color:#D73A49">=</span><span style="color:#6F42C1"> VelocityUnit</span><span style="color:#24292E">(</span><span style="color:#032F62">&quot;mph&quot;</span><span style="color:#24292E">, </span><span style="color:#032F62">&quot;miles per hour&quot;</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#24292E">                                    DistanceSystem.MILE, TimeSystem.HOUR)</span></span>
<span class="line"><span style="color:#24292E">  </span></span>
<span class="line"><span style="color:#D73A49">  val</span><span style="color:#24292E"> FEET_PER_SECOND </span><span style="color:#D73A49">=</span><span style="color:#6F42C1"> VelocityUnit</span><span style="color:#24292E">(</span><span style="color:#032F62">&quot;ft/s&quot;</span><span style="color:#24292E">, </span><span style="color:#032F62">&quot;feet per second&quot;</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#24292E">                                      DistanceSystem.FOOT, TimeSystem.SECOND)</span></span>
<span class="line"><span style="color:#24292E">  </span></span>
<span class="line"><span style="color:#D73A49">  override</span><span style="color:#D73A49"> val</span><span style="color:#24292E"> baseUnit: </span><span style="color:#6F42C1">Unit</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">Velocity</span><span style="color:#24292E">&gt; </span><span style="color:#D73A49">=</span><span style="color:#24292E"> METERS_PER_SECOND</span></span>
<span class="line"><span style="color:#24292E">  </span></span>
<span class="line"><span style="color:#D73A49">  override</span><span style="color:#D73A49"> val</span><span style="color:#24292E"> availableUnits: </span><span style="color:#6F42C1">Set</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">Unit</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">Velocity</span><span style="color:#24292E">&gt;&gt; </span><span style="color:#D73A49">=</span><span style="color:#6F42C1"> setOf</span><span style="color:#24292E">(</span></span>
<span class="line"><span style="color:#24292E">    METERS_PER_SECOND, KILOMETERS_PER_HOUR, MILES_PER_HOUR, FEET_PER_SECOND</span></span>
<span class="line"><span style="color:#24292E">  )</span></span>
<span class="line"><span style="color:#24292E">  </span></span>
<span class="line"><span style="color:#6A737D">  // 속도 생성 메서드</span></span>
<span class="line"><span style="color:#D73A49">  fun</span><span style="color:#6F42C1"> from</span><span style="color:#24292E">(distance: </span><span style="color:#6F42C1">Distance</span><span style="color:#24292E">, time: </span><span style="color:#6F42C1">Time</span><span style="color:#24292E">): </span><span style="color:#6F42C1">Velocity</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#6A737D">    // 기본 단위로 변환</span></span>
<span class="line"><span style="color:#D73A49">    val</span><span style="color:#24292E"> baseDistance </span><span style="color:#D73A49">=</span><span style="color:#24292E"> distance.</span><span style="color:#6F42C1">convertTo</span><span style="color:#24292E">(DistanceSystem.METER)</span></span>
<span class="line"><span style="color:#D73A49">    val</span><span style="color:#24292E"> baseTime </span><span style="color:#D73A49">=</span><span style="color:#24292E"> time.</span><span style="color:#6F42C1">convertTo</span><span style="color:#24292E">(TimeSystem.SECOND)</span></span>
<span class="line"><span style="color:#24292E">    </span></span>
<span class="line"><span style="color:#6A737D">    // 속도 계산</span></span>
<span class="line"><span style="color:#D73A49">    val</span><span style="color:#24292E"> velocityValue </span><span style="color:#D73A49">=</span><span style="color:#24292E"> baseDistance.</span><span style="color:#D73A49">value</span><span style="color:#24292E">.</span><span style="color:#6F42C1">divide</span><span style="color:#24292E">(baseTime.</span><span style="color:#D73A49">value</span><span style="color:#24292E">, </span><span style="color:#005CC5">10</span><span style="color:#24292E">, RoundingMode.HALF_UP)</span></span>
<span class="line"><span style="color:#24292E">    </span></span>
<span class="line"><span style="color:#D73A49">    return</span><span style="color:#24292E"> Velocity.</span><span style="color:#6F42C1">of</span><span style="color:#24292E">(velocityValue, METERS_PER_SECOND)</span></span>
<span class="line"><span style="color:#24292E">  }</span></span>
<span class="line"><span style="color:#24292E">}</span></span></code></pre>
<p>위와 같이 여러 단위가 정의된 복합 측도도 기본 측도 모델로 구현할 수 있다.</p>
<h2 id="파생-측도"><a href="#파생-측도">파생 측도</a></h2>
<p>이어서 파생 측도는 기본 측도를 기반으로 만들 수 있는 새로운 측도다. 대표적인 예로 길이를 곱하여 면적을 구하거나, 길이와 면적을 곱하여 부피를 구하는 경우가 있다. 이런 경우 다음과 같이 코드를 작성할 수 있다.</p>
<pre class="astro-code github-light" style="background-color:#fff;color:#24292e;overflow-x:auto" tabindex="0" data-language="kotlin"><code><span class="line"><span style="color:#D73A49">class</span><span style="color:#6F42C1"> Distance</span><span style="color:#D73A49"> private</span><span style="color:#6F42C1"> constructor</span><span style="color:#24292E">(</span></span>
<span class="line"><span style="color:#D73A49">  value</span><span style="color:#24292E">: </span><span style="color:#6F42C1">BigDecimal</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#24292E">  unit: </span><span style="color:#6F42C1">DistanceUnit</span></span>
<span class="line"><span style="color:#24292E">) : </span><span style="color:#6F42C1">AbstractMeasure</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">Distance</span><span style="color:#24292E">&gt;(</span><span style="color:#6F42C1">value</span><span style="color:#24292E">, </span><span style="color:#6F42C1">unit</span><span style="color:#24292E">) {</span></span>
<span class="line"><span style="color:#24292E">    </span></span>
<span class="line"><span style="color:#6A737D">  // 기존 메서드들...</span></span>
<span class="line"><span style="color:#24292E">  </span></span>
<span class="line"><span style="color:#6A737D">  // 두 길이를 곱해 직사각형 면적 계산</span></span>
<span class="line"><span style="color:#D73A49">  fun</span><span style="color:#6F42C1"> area</span><span style="color:#24292E">(other: </span><span style="color:#6F42C1">Distance</span><span style="color:#24292E">): </span><span style="color:#6F42C1">Area</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#6A737D">    // 같은 단위로 변환</span></span>
<span class="line"><span style="color:#D73A49">    val</span><span style="color:#24292E"> convertedOther </span><span style="color:#D73A49">=</span><span style="color:#24292E"> other.</span><span style="color:#6F42C1">convertTo</span><span style="color:#24292E">(unit </span><span style="color:#D73A49">as</span><span style="color:#24292E"> DistanceUnit)</span></span>
<span class="line"><span style="color:#24292E">    </span></span>
<span class="line"><span style="color:#6A737D">    // 면적 계산</span></span>
<span class="line"><span style="color:#D73A49">    val</span><span style="color:#24292E"> areaValue </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> value</span><span style="color:#24292E">.</span><span style="color:#6F42C1">multiply</span><span style="color:#24292E">(convertedOther.</span><span style="color:#D73A49">value</span><span style="color:#24292E">)</span></span>
<span class="line"><span style="color:#24292E">    </span></span>
<span class="line"><span style="color:#6A737D">    // 길이 단위에 맞는 면적 단위 생성</span></span>
<span class="line"><span style="color:#D73A49">    val</span><span style="color:#24292E"> areaUnit </span><span style="color:#D73A49">=</span><span style="color:#24292E"> AreaUnit.</span><span style="color:#6F42C1">fromDistanceUnit</span><span style="color:#24292E">(unit </span><span style="color:#D73A49">as</span><span style="color:#24292E"> DistanceUnit)</span></span>
<span class="line"><span style="color:#24292E">    </span></span>
<span class="line"><span style="color:#D73A49">    return</span><span style="color:#24292E"> Area.</span><span style="color:#6F42C1">of</span><span style="color:#24292E">(areaValue, areaUnit)</span></span>
<span class="line"><span style="color:#24292E">  }</span></span>
<span class="line"><span style="color:#24292E">  </span></span>
<span class="line"><span style="color:#6A737D">  // 정사각형 면적</span></span>
<span class="line"><span style="color:#D73A49">  fun</span><span style="color:#6F42C1"> square</span><span style="color:#24292E">(): </span><span style="color:#6F42C1">Area</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#D73A49">    return</span><span style="color:#005CC5"> this</span><span style="color:#24292E">.</span><span style="color:#6F42C1">multiply</span><span style="color:#24292E">(</span><span style="color:#005CC5">this</span><span style="color:#24292E">)</span></span>
<span class="line"><span style="color:#24292E">  }</span></span>
<span class="line"><span style="color:#24292E">}</span></span></code></pre>
<p>위와 같이 <code>area</code> 메서드를 통해 두 길이를 곱하여 면적을 계산할 수 있다. 이때 면적 단위는 길이 단위를 기반으로 생성할 수 있다. 예를 들어 미터(m) 단위의 길이를 곱하면 제곱미터(m²) 단위의 면적이 된다. 이를 위해 <code>AreaUnit</code>에서 <code>fromDistanceUnit</code> 메서드를 구현하여 길이 단위를 기반으로 면적 단위를 생성할 수 있도록 만들어야 한다.</p>
<pre class="astro-code github-light" style="background-color:#fff;color:#24292e;overflow-x:auto" tabindex="0" data-language="kotlin"><code><span class="line"><span style="color:#D73A49">class</span><span style="color:#6F42C1"> AreaUnit</span><span style="color:#24292E">(</span></span>
<span class="line"><span style="color:#D73A49">  override</span><span style="color:#D73A49"> val</span><span style="color:#24292E"> symbol: </span><span style="color:#6F42C1">String</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#D73A49">  override</span><span style="color:#D73A49"> val</span><span style="color:#24292E"> name: </span><span style="color:#6F42C1">String</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#D73A49">  val</span><span style="color:#24292E"> conversionFactor: </span><span style="color:#6F42C1">BigDecimal</span><span style="color:#6A737D"> // 기본 단위(m²)에 대한 변환 계수</span></span>
<span class="line"><span style="color:#24292E">) : </span><span style="color:#6F42C1">Unit</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">Area</span><span style="color:#24292E">&gt; {</span></span>
<span class="line"><span style="color:#D73A49">  companion</span><span style="color:#D73A49"> object</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#6A737D">    // 길이 단위로부터 면적 단위 생성</span></span>
<span class="line"><span style="color:#D73A49">    fun</span><span style="color:#6F42C1"> fromDistanceUnit</span><span style="color:#24292E">(unit: </span><span style="color:#6F42C1">DistanceUnit</span><span style="color:#24292E">): </span><span style="color:#6F42C1">AreaUnit</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#D73A49">      val</span><span style="color:#24292E"> symbol </span><span style="color:#D73A49">=</span><span style="color:#032F62"> &quot;${unit.symbol}²&quot;</span></span>
<span class="line"><span style="color:#D73A49">      val</span><span style="color:#24292E"> name </span><span style="color:#D73A49">=</span><span style="color:#032F62"> &quot;square ${unit.name}&quot;</span></span>
<span class="line"><span style="color:#6A737D">      // 길이 변환 계수의 제곱이 면적 변환 계수가 됨</span></span>
<span class="line"><span style="color:#D73A49">      val</span><span style="color:#24292E"> conversionFactor </span><span style="color:#D73A49">=</span><span style="color:#24292E"> unit.conversionFactor.</span><span style="color:#6F42C1">pow</span><span style="color:#24292E">(</span><span style="color:#005CC5">2</span><span style="color:#24292E">)</span></span>
<span class="line"><span style="color:#D73A49">      return</span><span style="color:#6F42C1"> AreaUnit</span><span style="color:#24292E">(symbol, name, conversionFactor)</span></span>
<span class="line"><span style="color:#24292E">    }</span></span>
<span class="line"><span style="color:#24292E">  }</span></span>
<span class="line"><span style="color:#24292E">  </span></span>
<span class="line"><span style="color:#D73A49">  override</span><span style="color:#D73A49"> fun</span><span style="color:#6F42C1"> convert</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">: </span><span style="color:#6F42C1">BigDecimal</span><span style="color:#24292E">, toUnit: </span><span style="color:#6F42C1">Unit</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">Area</span><span style="color:#24292E">&gt;): </span><span style="color:#6F42C1">BigDecimal</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#6A737D">    // ... 면적 단위 변환 로직</span></span>
<span class="line"><span style="color:#24292E">  }</span></span>
<span class="line"><span style="color:#24292E">  </span></span>
<span class="line"><span style="color:#D73A49">  override</span><span style="color:#D73A49"> fun</span><span style="color:#6F42C1"> create</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">: </span><span style="color:#6F42C1">BigDecimal</span><span style="color:#24292E">): </span><span style="color:#6F42C1">Area</span><span style="color:#D73A49"> =</span><span style="color:#24292E"> Area.</span><span style="color:#6F42C1">of</span><span style="color:#24292E">(</span><span style="color:#D73A49">value</span><span style="color:#24292E">, </span><span style="color:#005CC5">this</span><span style="color:#24292E">)</span></span>
<span class="line"><span style="color:#24292E">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">// Area, AreaSystem 구현 생략</span></span></code></pre>
<p>이런 방식으로 측도와 측도 간의 관계를 정의하여 파생 측도를 구현할 수 있다. 측도는 독립적으로만 존재하는 것이 아니라, 서로 관계를 맺고 있으며, 이를 통해 복합 측도와 파생 측도를 모델링할 수 있다. 이러한 관계를 잘 정의하면, 다양한 물리적 현상을 프로그래밍적으로 표현할 수 있다.</p>
<h1 id="마치며"><a href="#마치며">마치며</a></h1>
<p>지금까지 측도 모델을 통해 어떻게 다양한 물리적 수량을 표현하고, 단위 변환 및 연산을 수행할 수 있는지 살펴보았다. 측도 모델은 객체지향 설계의 원칙을 잘 활용하여, 코드의 재사용성과 유지보수성을 높일 수 있는 강력한 도구이다. 또한 안정성 측면에서도 원시 타입을 사용하는 것보다 훨씬 안전하다.</p>
<p>소프트웨어가 어떤 가치를 제공하냐에 따라 필요한 측도는 다를 수 있다. 따라서 측도 모델을 설계할 때는 도메인에 맞는 측도를 정의하고, 필요한 연산과 변환을 고려하여 설계해야 한다. 또한, 측도 모델은 단순히 수량을 표현하는 것뿐만 아니라, 비즈니스 로직을 구현하는 데에도 큰 도움이 된다.</p>  </div> <div> <div class="mt-1 w-full"> <div class="mr-1 mb-1 inline-flex items-center rounded-[50px] border border-[#dfe3e8] px-2 text-[10px] text-[#888]" style="height: 20px;"> modeling </div> </div> <div class="flex items-center py-6" data-astro-cid-k7qsseos> <div class="shrink-0 basis-[80px]" data-astro-cid-k7qsseos> <img class="h-[80px] w-[80px] object-cover" style="border-radius: 50%;" src="/images/about/avatar.jpg" data-astro-cid-k7qsseos> </div> <div class="ml-8 flex-1 text-base" data-astro-cid-k7qsseos> <div data-astro-cid-k7qsseos>
Written by <a href="/about/" class="name-gradient font-bold no-underline" data-astro-cid-k7qsseos>
@kciter
</a> </div> <div class="text-sm font-light leading-snug" data-astro-cid-k7qsseos>가치있는 지식이 되기를 바랍니다</div> <div class="-ml-1 [&_a]:text-sm [&_a]:text-[#888]" data-astro-cid-k7qsseos> <a href="https://github.com/kciter" target="_blank" rel="noopener noreferrer" class="social-icon inline-block p-[5px] no-underline" aria-label="GitHub" style="--hover-color: #343434; transition: color .5s; margin-right: 5px;" data-astro-cid-yxtifmrq><svg class="inline-block h-4 w-4" viewBox="0 0 24 24" fill="currentColor" data-astro-cid-yxtifmrq><path d="M12 0C5.37 0 0 5.37 0 12c0 5.3 3.44 9.8 8.2 11.38.6.12.83-.26.83-.57v-2.2c-3.34.73-4.04-1.44-4.04-1.44-.55-1.38-1.33-1.75-1.33-1.75-1.09-.74.08-.73.08-.73 1.2.09 1.84 1.24 1.84 1.24 1.07 1.83 2.8 1.3 3.49 1 .1-.78.42-1.3.76-1.6-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.13-.3-.54-1.52.12-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6.02 0c2.28-1.55 3.28-1.23 3.28-1.23.66 1.66.25 2.88.12 3.18.77.84 1.24 1.91 1.24 3.22 0 4.61-2.81 5.63-5.48 5.92.43.37.81 1.1.81 2.22v3.29c0 .31.22.7.83.57C20.57 21.8 24 17.3 24 12c0-6.63-5.37-12-12-12z"/></svg></a><a href="https://www.facebook.com/sunhyoup.lee" target="_blank" rel="noopener noreferrer" class="social-icon inline-block p-[5px] no-underline" aria-label="Facebook" style="--hover-color: #3d5b99; transition: color .5s; margin-right: 5px;" data-astro-cid-yxtifmrq><svg class="inline-block h-4 w-4" viewBox="0 0 24 24" fill="currentColor" data-astro-cid-yxtifmrq><path d="M24 12.07C24 5.41 18.63 0 12 0S0 5.41 0 12.07c0 6.02 4.39 11.02 10.13 11.93v-8.44H7.08v-3.49h3.04V9.41c0-3.02 1.79-4.68 4.53-4.68 1.31 0 2.68.24 2.68.24v2.97h-1.51c-1.49 0-1.95.93-1.95 1.88v2.26h3.33l-.53 3.49h-2.8v8.44C19.61 23.09 24 18.09 24 12.07z"/></svg></a><a href="https://www.linkedin.com/in/kciter" target="_blank" rel="noopener noreferrer" class="social-icon inline-block p-[5px] no-underline" aria-label="LinkedIn" style="--hover-color: #0073a4; transition: color .5s; margin-right: 5px;" data-astro-cid-yxtifmrq><svg class="inline-block h-4 w-4" viewBox="0 0 24 24" fill="currentColor" data-astro-cid-yxtifmrq><path d="M20.45 20.45h-3.55v-5.57c0-1.33-.02-3.04-1.85-3.04-1.85 0-2.14 1.45-2.14 2.94v5.67H9.36V9h3.41v1.56h.05c.48-.9 1.64-1.85 3.37-1.85 3.6 0 4.27 2.37 4.27 5.46v6.28zM5.34 7.43a2.06 2.06 0 1 1 0-4.12 2.06 2.06 0 0 1 0 4.12zM7.12 20.45H3.56V9h3.56v11.45zM22.22 0H1.77C.79 0 0 .77 0 1.72v20.56C0 23.23.79 24 1.77 24h20.45C23.2 24 24 23.23 24 22.28V1.72C24 .77 23.2 0 22.22 0z"/></svg></a><a href="https://twitter.com/kciter" target="_blank" rel="noopener noreferrer" class="social-icon inline-block p-[5px] no-underline" aria-label="X (Twitter)" style="--hover-color: #343434; transition: color .5s; margin-right: 5px;" data-astro-cid-yxtifmrq><svg class="inline-block h-4 w-4" viewBox="0 0 24 24" fill="currentColor" data-astro-cid-yxtifmrq><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg></a><a href="/feed.xml" target="_blank" rel="noopener noreferrer" class="social-icon inline-block p-[5px] no-underline" aria-label="RSS Feed" style="--hover-color: #ff6600; transition: color .5s;" data-astro-cid-yxtifmrq><svg class="inline-block h-4 w-4" viewBox="0 0 24 24" fill="currentColor" data-astro-cid-yxtifmrq><path d="M6.18 15.64a2.18 2.18 0 1 1 0 4.36 2.18 2.18 0 0 1 0-4.36zM4 4.44v3.57A12.01 12.01 0 0 1 15.99 20h3.57A15.57 15.57 0 0 0 4 4.44zM4 10.1v3.57c3.5 0 6.33 2.84 6.33 6.33h3.57c0-5.47-4.43-9.9-9.9-9.9z"/></svg></a> </div> </div> </div>  <div class="mb-2" data-astro-cid-4kgnabjz><div class="my-2 text-[1.3em] font-bold text-[#454f5b]" data-astro-cid-4kgnabjz>
이 글을 후원해주신 고마운 분들
</div><div class="flex" data-astro-cid-4kgnabjz><div class="sponsors flex flex-1" data-astro-cid-4kgnabjz><a href="https://github.com/ibcylon" target="_blank" class="mr-1" style="text-decoration: none;" data-astro-cid-4kgnabjz><img src="https://avatars.githubusercontent.com/u/25360781?u=2c87bc8941f9dfe019e027cb22712e124f88a709&v=4" alt="ibcylon" class="relative h-9 w-9 overflow-hidden" style="border-radius: 50%;" data-astro-cid-4kgnabjz></a><a href="https://github.com/18-12847" target="_blank" class="mr-1" style="text-decoration: none;" data-astro-cid-4kgnabjz><img src="https://avatars.githubusercontent.com/u/118495919?u=f2b649c2058f423f96879c91dd5115c90fdc3354&v=4" alt="18-12847" class="relative h-9 w-9 overflow-hidden" style="border-radius: 50%;" data-astro-cid-4kgnabjz></a><a href="https://github.com/honux77" target="_blank" class="mr-1" style="text-decoration: none;" data-astro-cid-4kgnabjz><img src="https://avatars.githubusercontent.com/u/2168702?u=52a017f8024e27c8c3b749e7daab81e1be6da93d&v=4" alt="honux77" class="relative h-9 w-9 overflow-hidden" style="border-radius: 50%;" data-astro-cid-4kgnabjz></a><a href="https://github.com/Jeewhan" target="_blank" class="mr-1" style="text-decoration: none;" data-astro-cid-4kgnabjz><img src="https://avatars.githubusercontent.com/u/14256139?u=59386eab9b64e21b89c4c587e92c969217a9c417&v=4" alt="Jeewhan" class="relative h-9 w-9 overflow-hidden" style="border-radius: 50%;" data-astro-cid-4kgnabjz></a></div><a href="https://github.com/sponsors/kciter" target="_blank" class="flex h-8 w-[120px] cursor-pointer items-center justify-center rounded-[7px] border border-[#e1e4e8] bg-[#fafbfc] text-sm transition-all hover:bg-[#f0f3f6]" style="text-decoration: none;" data-astro-cid-4kgnabjz><svg height="14" viewBox="0 0 16 16" version="1.1" width="14" class="mr-1 fill-red-500" data-astro-cid-4kgnabjz><path d="m8 14.25.345.666a.75.75 0 0 1-.69 0l-.008-.004-.018-.01a7.152 7.152 0 0 1-.31-.17 22.055 22.055 0 0 1-3.434-2.414C2.045 10.731 0 8.35 0 5.5 0 2.836 2.086 1 4.25 1 5.797 1 7.153 1.802 8 3.02 8.847 1.802 10.203 1 11.75 1 13.914 1 16 2.836 16 5.5c0 2.85-2.045 5.231-3.885 6.818a22.066 22.066 0 0 1-3.744 2.584l-.018.01-.006.003h-.002ZM4.25 2.5c-1.336 0-2.75 1.164-2.75 3 0 2.15 1.58 4.144 3.365 5.682A20.58 20.58 0 0 0 8 13.393a20.58 20.58 0 0 0 3.135-2.211C12.92 9.644 14.5 7.65 14.5 5.5c0-1.836-1.414-3-2.75-3-1.373 0-2.609.986-3.029 2.456a.749.749 0 0 1-1.442 0C6.859 3.486 5.623 2.5 4.25 2.5Z" data-astro-cid-4kgnabjz></path></svg><span data-astro-cid-4kgnabjz>Sponsor</span></a></div></div> <div id="comments"> <style>astro-island,astro-slot,astro-static-slot{display:contents}</style><script>(()=>{var a=(s,i,o)=>{let r=async()=>{await(await s())()},t=typeof i.value=="object"?i.value:void 0,c={rootMargin:t==null?void 0:t.rootMargin},n=new IntersectionObserver(e=>{for(let l of e)if(l.isIntersecting){n.disconnect(),r();break}},c);for(let e of o.children)n.observe(e)};(self.Astro||(self.Astro={})).visible=a;window.dispatchEvent(new Event("astro:visible"));})();</script><script>(()=>{var A=Object.defineProperty;var g=(i,o,a)=>o in i?A(i,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):i[o]=a;var d=(i,o,a)=>g(i,typeof o!="symbol"?o+"":o,a);{let i={0:t=>m(t),1:t=>a(t),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(a(t)),5:t=>new Set(a(t)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(t),9:t=>new Uint16Array(t),10:t=>new Uint32Array(t),11:t=>1/0*t},o=t=>{let[l,e]=t;return l in i?i[l](e):void 0},a=t=>t.map(o),m=t=>typeof t!="object"||t===null?t:Object.fromEntries(Object.entries(t).map(([l,e])=>[l,o(e)]));class y extends HTMLElement{constructor(){super(...arguments);d(this,"Component");d(this,"hydrator");d(this,"hydrate",async()=>{var b;if(!this.hydrator||!this.isConnected)return;let e=(b=this.parentElement)==null?void 0:b.closest("astro-island[ssr]");if(e){e.addEventListener("astro:hydrate",this.hydrate,{once:!0});return}let c=this.querySelectorAll("astro-slot"),n={},h=this.querySelectorAll("template[data-astro-template]");for(let r of h){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("data-astro-template")||"default"]=r.innerHTML,r.remove())}for(let r of c){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("name")||"default"]=r.innerHTML)}let p;try{p=this.hasAttribute("props")?m(JSON.parse(this.getAttribute("props"))):{}}catch(r){let s=this.getAttribute("component-url")||"<unknown>",v=this.getAttribute("component-export");throw v&&(s+=` (export ${v})`),console.error(`[hydrate] Error parsing props for component ${s}`,this.getAttribute("props"),r),r}let u;await this.hydrator(this)(this.Component,p,n,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),this.dispatchEvent(new CustomEvent("astro:hydrate"))});d(this,"unmount",()=>{this.isConnected||this.dispatchEvent(new CustomEvent("astro:unmount"))})}disconnectedCallback(){document.removeEventListener("astro:after-swap",this.unmount),document.addEventListener("astro:after-swap",this.unmount,{once:!0})}connectedCallback(){if(!this.hasAttribute("await-children")||document.readyState==="interactive"||document.readyState==="complete")this.childrenConnectedCallback();else{let e=()=>{document.removeEventListener("DOMContentLoaded",e),c.disconnect(),this.childrenConnectedCallback()},c=new MutationObserver(()=>{var n;((n=this.lastChild)==null?void 0:n.nodeType)===Node.COMMENT_NODE&&this.lastChild.nodeValue==="astro:end"&&(this.lastChild.remove(),e())});c.observe(this,{childList:!0}),document.addEventListener("DOMContentLoaded",e)}}async childrenConnectedCallback(){let e=this.getAttribute("before-hydration-url");e&&await import(e),this.start()}async start(){let e=JSON.parse(this.getAttribute("opts")),c=this.getAttribute("client");if(Astro[c]===void 0){window.addEventListener(`astro:${c}`,()=>this.start(),{once:!0});return}try{await Astro[c](async()=>{let n=this.getAttribute("renderer-url"),[h,{default:p}]=await Promise.all([import(this.getAttribute("component-url")),n?import(n):()=>()=>{}]),u=this.getAttribute("component-export")||"default";if(!u.includes("."))this.Component=h[u];else{this.Component=h;for(let f of u.split("."))this.Component=this.Component[f]}return this.hydrator=p,this.hydrate},e,this)}catch(n){console.error(`[astro-island] Error hydrating ${this.getAttribute("component-url")}`,n)}}attributeChangedCallback(){this.hydrate()}}d(y,"observedAttributes",["props"]),customElements.get("astro-island")||customElements.define("astro-island",y)}})();</script><astro-island uid="liNcb" prefix="r3" component-url="/_astro/Giscus.BCCeZi7E.js" component-export="default" renderer-url="/_astro/client.C9fCgUO1.js" props="{&quot;repo&quot;:[0,&quot;kciter/kciter.github.io&quot;],&quot;theme&quot;:[0,&quot;light&quot;]}" ssr client="visible" opts="{&quot;name&quot;:&quot;Giscus&quot;,&quot;value&quot;:true}" await-children><div></div><!--astro:end--></astro-island> </div> </div> <div class="pt-8 pb-8" data-astro-cid-llggujpl> <div class="grid grid-cols-3 gap-5 max-[30rem]:grid-cols-1" data-astro-cid-llggujpl> <a href="/posts/mcp-from-ux-perspective/" class="related-post block scale-100 no-underline transition-all duration-[333ms] ease-[ease]" style="text-decoration: none;" data-astro-cid-llggujpl> <img src="/images/2025-04-10-mcp-from-ux-perspective/thumbnail.jpg" alt="UX 관점에서 바라보는 MCP" loading="lazy" class="block w-full object-cover shadow-[0_0_10px_2px_rgba(0,0,0,0.05)]" style="aspect-ratio: 16/9;" data-astro-cid-llggujpl> <div class="mt-3 text-xl leading-6 font-thin" data-astro-cid-llggujpl>UX 관점에서 바라보는 MCP</div> <small data-astro-cid-llggujpl>2025-04-10</small> </a><a href="/posts/using-kotlin-script/" class="related-post block scale-100 no-underline transition-all duration-[333ms] ease-[ease]" style="text-decoration: none;" data-astro-cid-llggujpl> <img src="/images/2025-01-19-using-kotlin-script/thumbnail.png" alt="Kotlin Script 활용하기" loading="lazy" class="block w-full object-cover shadow-[0_0_10px_2px_rgba(0,0,0,0.05)]" style="aspect-ratio: 16/9;" data-astro-cid-llggujpl> <div class="mt-3 text-xl leading-6 font-thin" data-astro-cid-llggujpl>Kotlin Script 활용하기</div> <small data-astro-cid-llggujpl>2025-01-19</small> </a><a href="/posts/what-is-beautiful-code/" class="related-post block scale-100 no-underline transition-all duration-[333ms] ease-[ease]" style="text-decoration: none;" data-astro-cid-llggujpl> <img src="/images/2023-12-05-what-is-beautiful-code/thumbnail.png" alt="아름다운 코드에 대하여" loading="lazy" class="block w-full object-cover shadow-[0_0_10px_2px_rgba(0,0,0,0.05)]" style="aspect-ratio: 16/9;" data-astro-cid-llggujpl> <div class="mt-3 text-xl leading-6 font-thin" data-astro-cid-llggujpl>아름다운 코드에 대하여</div> <small data-astro-cid-llggujpl>2023-12-05</small> </a><a href="/posts/warp-and-weft/" class="related-post block scale-100 no-underline transition-all duration-[333ms] ease-[ease]" style="text-decoration: none;" data-astro-cid-llggujpl> <img src="/images/2024-05-17-warp-and-weft/thumbnail.png" alt="씨줄과 날줄" loading="lazy" class="block w-full object-cover shadow-[0_0_10px_2px_rgba(0,0,0,0.05)]" style="aspect-ratio: 16/9;" data-astro-cid-llggujpl> <div class="mt-3 text-xl leading-6 font-thin" data-astro-cid-llggujpl>씨줄과 날줄</div> <small data-astro-cid-llggujpl>2024-05-17</small> </a><a href="/posts/build-large-scale-react-web-apps/" class="related-post block scale-100 no-underline transition-all duration-[333ms] ease-[ease]" style="text-decoration: none;" data-astro-cid-llggujpl> <img src="/images/2025-03-12-build-large-scale-react-web-apps/thumbnail.png" alt="대규모 리액트 웹 앱 개발" loading="lazy" class="block w-full object-cover shadow-[0_0_10px_2px_rgba(0,0,0,0.05)]" style="aspect-ratio: 16/9;" data-astro-cid-llggujpl> <div class="mt-3 text-xl leading-6 font-thin" data-astro-cid-llggujpl>대규모 리액트 웹 앱 개발</div> <small data-astro-cid-llggujpl>2025-03-12</small> </a><a href="/posts/multi-paradigm-programming-book/" class="related-post block scale-100 no-underline transition-all duration-[333ms] ease-[ease]" style="text-decoration: none;" data-astro-cid-llggujpl> <img src="/images/2025-04-25-multi-paradigm-programming-book/thumbnail.png" alt="멀티패러다임 프로그래밍과 리스트 프로세싱" loading="lazy" class="block w-full object-cover shadow-[0_0_10px_2px_rgba(0,0,0,0.05)]" style="aspect-ratio: 16/9;" data-astro-cid-llggujpl> <div class="mt-3 text-xl leading-6 font-thin" data-astro-cid-llggujpl>멀티패러다임 프로그래밍과 리스트 프로세싱</div> <small data-astro-cid-llggujpl>2025-04-25</small> </a> </div> </div>  </div> <footer class="m-8 text-center text-[#999]"> <div> <a href="https://github.com/kciter" target="_blank" rel="noopener noreferrer" class="social-icon inline-block p-[5px] no-underline" aria-label="GitHub" style="--hover-color: #343434; transition: color .5s; margin-right: 5px;" data-astro-cid-yxtifmrq><svg class="inline-block h-4 w-4" viewBox="0 0 24 24" fill="currentColor" data-astro-cid-yxtifmrq><path d="M12 0C5.37 0 0 5.37 0 12c0 5.3 3.44 9.8 8.2 11.38.6.12.83-.26.83-.57v-2.2c-3.34.73-4.04-1.44-4.04-1.44-.55-1.38-1.33-1.75-1.33-1.75-1.09-.74.08-.73.08-.73 1.2.09 1.84 1.24 1.84 1.24 1.07 1.83 2.8 1.3 3.49 1 .1-.78.42-1.3.76-1.6-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.13-.3-.54-1.52.12-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6.02 0c2.28-1.55 3.28-1.23 3.28-1.23.66 1.66.25 2.88.12 3.18.77.84 1.24 1.91 1.24 3.22 0 4.61-2.81 5.63-5.48 5.92.43.37.81 1.1.81 2.22v3.29c0 .31.22.7.83.57C20.57 21.8 24 17.3 24 12c0-6.63-5.37-12-12-12z"/></svg></a><a href="https://www.facebook.com/sunhyoup.lee" target="_blank" rel="noopener noreferrer" class="social-icon inline-block p-[5px] no-underline" aria-label="Facebook" style="--hover-color: #3d5b99; transition: color .5s; margin-right: 5px;" data-astro-cid-yxtifmrq><svg class="inline-block h-4 w-4" viewBox="0 0 24 24" fill="currentColor" data-astro-cid-yxtifmrq><path d="M24 12.07C24 5.41 18.63 0 12 0S0 5.41 0 12.07c0 6.02 4.39 11.02 10.13 11.93v-8.44H7.08v-3.49h3.04V9.41c0-3.02 1.79-4.68 4.53-4.68 1.31 0 2.68.24 2.68.24v2.97h-1.51c-1.49 0-1.95.93-1.95 1.88v2.26h3.33l-.53 3.49h-2.8v8.44C19.61 23.09 24 18.09 24 12.07z"/></svg></a><a href="https://www.linkedin.com/in/kciter" target="_blank" rel="noopener noreferrer" class="social-icon inline-block p-[5px] no-underline" aria-label="LinkedIn" style="--hover-color: #0073a4; transition: color .5s; margin-right: 5px;" data-astro-cid-yxtifmrq><svg class="inline-block h-4 w-4" viewBox="0 0 24 24" fill="currentColor" data-astro-cid-yxtifmrq><path d="M20.45 20.45h-3.55v-5.57c0-1.33-.02-3.04-1.85-3.04-1.85 0-2.14 1.45-2.14 2.94v5.67H9.36V9h3.41v1.56h.05c.48-.9 1.64-1.85 3.37-1.85 3.6 0 4.27 2.37 4.27 5.46v6.28zM5.34 7.43a2.06 2.06 0 1 1 0-4.12 2.06 2.06 0 0 1 0 4.12zM7.12 20.45H3.56V9h3.56v11.45zM22.22 0H1.77C.79 0 0 .77 0 1.72v20.56C0 23.23.79 24 1.77 24h20.45C23.2 24 24 23.23 24 22.28V1.72C24 .77 23.2 0 22.22 0z"/></svg></a><a href="https://twitter.com/kciter" target="_blank" rel="noopener noreferrer" class="social-icon inline-block p-[5px] no-underline" aria-label="X (Twitter)" style="--hover-color: #343434; transition: color .5s; margin-right: 5px;" data-astro-cid-yxtifmrq><svg class="inline-block h-4 w-4" viewBox="0 0 24 24" fill="currentColor" data-astro-cid-yxtifmrq><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg></a><a href="/feed.xml" target="_blank" rel="noopener noreferrer" class="social-icon inline-block p-[5px] no-underline" aria-label="RSS Feed" style="--hover-color: #ff6600; transition: color .5s;" data-astro-cid-yxtifmrq><svg class="inline-block h-4 w-4" viewBox="0 0 24 24" fill="currentColor" data-astro-cid-yxtifmrq><path d="M6.18 15.64a2.18 2.18 0 1 1 0 4.36 2.18 2.18 0 0 1 0-4.36zM4 4.44v3.57A12.01 12.01 0 0 1 15.99 20h3.57A15.57 15.57 0 0 0 4 4.44zM4 10.1v3.57c3.5 0 6.33 2.84 6.33 6.33h3.57c0-5.47-4.43-9.9-9.9-9.9z"/></svg></a> </div> <div class="mt-4 mb-4 font-['Quattrocento_Sans',sans-serif] text-[0.8rem] text-[#9a9a9a]"> <a href="/about/" class="p-2.5 text-[#999] hover:text-[#333]" style="text-decoration: none;">
kciter.so | devlog by Sunhyoup Lee
</a> </div> </footer> </div> </body></html> <script type="module">document.querySelectorAll(".post-container a[data-footnote-ref]").forEach(o=>{const e=o.getAttribute("href")?.slice(1);if(!e)return;const r=document.getElementById(e);if(!r)return;const t=r.textContent?.replace("↩","").trim()||"";o.setAttribute("data-tooltip",t)});document.querySelectorAll(".code-tabs").forEach(o=>{const e=Array.from(o.querySelectorAll(":scope > pre"));if(e.length<2)return;const r=o.getAttribute("data-labels")?.split(",").map(a=>a.trim()),t=document.createElement("div");t.className="code-tabs-bar",e.forEach((a,s)=>{const n=r?.[s]||a.getAttribute("data-language")||"code",c=document.createElement("button");c.textContent=n,r?.[s]&&c.classList.add("has-filename"),s===0&&c.classList.add("active"),c.addEventListener("click",()=>{t.querySelectorAll("button").forEach(l=>l.classList.remove("active")),e.forEach(l=>l.classList.remove("active")),c.classList.add("active"),e[s].classList.add("active")}),t.appendChild(c)}),e[0].classList.add("active"),o.prepend(t)});const i=document.querySelectorAll(".toc .toc-list a");if(i.length>0){const e=Array.from(i).map(t=>t.getAttribute("href")?.slice(1)).filter(Boolean).map(t=>document.getElementById(t)).filter(Boolean),r=new IntersectionObserver(t=>{for(const a of t)if(a.isIntersecting){const s=a.target.id;i.forEach(n=>{n.classList.toggle("active",n.getAttribute("href")===`#${s}`)})}},{rootMargin:"0px 0px -70% 0px",threshold:0});e.forEach(t=>r.observe(t))}</script>