import{j as t}from"./jsx-runtime.s5l94Kta.js";import{r as f}from"./index.Dkaqzkgy.js";const j=(e,n)=>{if(e==null)return"";switch(n){case"NUMBER":return Number(e).toLocaleString();case"DATE":return e instanceof Date?e.toLocaleDateString():typeof e=="string"?new Date(e).toLocaleDateString():String(e);default:return String(e)}},b=(e,n)=>e.cells.find(a=>a.columnId===n),S=({columnId:e,sortable:n,sorting:a})=>{if(!n)return null;if(a&&a.length>0){const l=a[0];if(l.columnId===e)return l.direction==="ASC"?t.jsx("span",{className:"sort-icon",children:"↑"}):t.jsx("span",{className:"sort-icon",children:"↓"})}return t.jsx("span",{className:"sort-icon sort-icon-none",children:"↕"})},C=({columns:e,sortable:n,sorting:a,onSort:l})=>t.jsx("thead",{children:t.jsx("tr",{children:e.map(i=>t.jsx("th",{className:`column-${i.align.toLowerCase()} ${i.sortable?"sortable":""}`,onClick:()=>i.sortable?l(i.id):null,children:t.jsxs("div",{className:"th-content",children:[t.jsx("span",{children:i.label}),i.sortable&&t.jsx(S,{columnId:i.id,sortable:n,sorting:a})]})},i.id))})}),D=({colSpan:e})=>t.jsx("tr",{children:t.jsx("td",{colSpan:e,className:"loading-cell",children:t.jsx("div",{className:"loading-spinner"})})}),y=({colSpan:e,message:n="데이터가 없습니다."})=>t.jsx("tr",{children:t.jsx("td",{colSpan:e,className:"empty-table",children:n})}),N=({columnId:e,columnType:n,align:a,value:l})=>t.jsx("td",{className:`column-${a.toLowerCase()}`,children:j(l,n)},e),E=({row:e,columns:n,onClick:a})=>t.jsx("tr",{className:a?"clickable-row":"",onClick:()=>a?a(e):null,children:n.map(l=>{const i=b(e,l.id),c=i?i.value:null;return t.jsx(N,{columnId:l.id,columnType:l.type,align:l.align,value:c},l.id)})}),I=({columns:e,rows:n,loading:a,onRowClick:l})=>a?t.jsx("tbody",{children:t.jsx(D,{colSpan:e.length})}):n.length===0?t.jsx("tbody",{children:t.jsx(y,{colSpan:e.length})}):t.jsx("tbody",{children:n.map((i,c)=>t.jsx(E,{row:i,columns:e,onClick:l},c))}),T=({pagination:e,onPageChange:n})=>{const{page:a,totalPage:l,pageSize:i}=e;return t.jsxs("div",{className:"table-pagination",children:[t.jsx("button",{className:"pagination-button",disabled:a<=1,onClick:()=>n(1),children:"<<"}),t.jsx("button",{className:"pagination-button",disabled:a<=1,onClick:()=>n(a-1),children:"<"}),t.jsxs("span",{className:"pagination-info",children:[a," / ",l]}),t.jsx("button",{className:"pagination-button",disabled:a>=l,onClick:()=>n(a+1),children:">"}),t.jsx("button",{className:"pagination-button",disabled:a>=l,onClick:()=>n(l),children:">>"}),t.jsxs("span",{className:"pagination-size-info",children:["(",i,"개씩 보기)"]})]})},B=({viewModel:e,onSortChange:n,onPageChange:a,onRowClick:l,loading:i=!1,className:c=""})=>{const[m,p]=f.useState(e.state);f.useEffect(()=>{p(e.state)},[e.state]);const x=r=>{if(!e.sortable)return;const d=e.columns.find(g=>g.id===r);if(!d||!d.sortable)return;let o="ASC";if(m.sorting&&m.sorting.length>0){const g=m.sorting[0];g.columnId===r&&(o=g.direction==="ASC"?"DESC":"ASC")}const s={columnId:r,direction:o},u={...m,sorting:[s]};p(u),n&&n(s)},h=r=>{e.pagination&&r>=1&&r<=e.pagination.totalPage&&a&&a(r)};return t.jsxs("div",{className:`table-renderer-container ${c}`,children:[t.jsx("div",{className:"table-wrapper",children:t.jsxs("table",{className:"vm-table",children:[t.jsx(C,{columns:e.columns,sortable:e.sortable,sorting:m.sorting,onSort:x}),t.jsx(I,{columns:e.columns,rows:e.rows,loading:i,onRowClick:l})]})}),e.pagination&&t.jsx(T,{pagination:e.pagination,onPageChange:h})]})},v=[{id:1,name:"홍길동",email:"hong@example.com",joinDate:"2023-01-15",point:3500},{id:2,name:"김영희",email:"kim@example.com",joinDate:"2023-02-20",point:4200},{id:3,name:"이철수",email:"lee@example.com",joinDate:"2023-03-05",point:2800},{id:4,name:"박지민",email:"park@example.com",joinDate:"2023-04-10",point:5100},{id:5,name:"최민지",email:"choi@example.com",joinDate:"2023-05-18",point:1900},{id:6,name:"정다희",email:"jung@example.com",joinDate:"2023-06-22",point:3200},{id:7,name:"강현우",email:"kang@example.com",joinDate:"2023-07-09",point:4600},{id:8,name:"윤서연",email:"yoon@example.com",joinDate:"2023-08-14",point:2100},{id:9,name:"서민석",email:"seo@example.com",joinDate:"2023-09-30",point:3800},{id:10,name:"임수진",email:"lim@example.com",joinDate:"2023-10-05",point:5300},{id:11,name:"오준호",email:"oh@example.com",joinDate:"2023-11-11",point:2700},{id:12,name:"한지은",email:"han@example.com",joinDate:"2023-12-20",point:4100}],R=async e=>{console.log("Fetching data with params:",e);const n=e.pageSize||5,a=e.page||1,l=(a-1)*n,i=l+n;let c=[...v];e.sortBy&&c.sort((r,d)=>{const o=r[e.sortBy],s=d[e.sortBy];return typeof o=="string"&&typeof s=="string"?e.sortDirection==="ASC"?o.localeCompare(s):s.localeCompare(o):e.sortDirection==="ASC"?o-s:s-o}),e.filter&&e.filterValue&&(c=c.filter(r=>{const d=r[e.filter];return typeof d=="string"?d.toLowerCase().includes(e.filterValue.toLowerCase()):typeof d=="number"?d===Number(e.filterValue):!1}));const p=c.slice(l,i).map(r=>({cells:[{columnId:"id",value:r.id},{columnId:"name",value:r.name},{columnId:"email",value:r.email},{columnId:"joinDate",value:r.joinDate},{columnId:"point",value:r.point}]})),x=c.length,h=Math.ceil(x/n);return{columns:[{id:"id",label:"ID",type:"NUMBER",align:"CENTER",sortable:!0},{id:"name",label:"이름",type:"TEXT",align:"LEFT",sortable:!0},{id:"email",label:"이메일",type:"TEXT",align:"LEFT",sortable:!1},{id:"joinDate",label:"가입일",type:"DATE",align:"CENTER",sortable:!0},{id:"point",label:"포인트",type:"NUMBER",align:"RIGHT",sortable:!0}],rows:p,sortable:!0,pagination:{page:a,totalPage:h,pageSize:n},state:{sorting:e.sortBy?[{columnId:e.sortBy,direction:e.sortDirection||"ASC"}]:[],filters:e.filter?[{columnId:e.filter,type:"LIKE",value:e.filterValue}]:null}}};function k(){const[e,n]=f.useState(null),[a,l]=f.useState(!0),[i,c]=f.useState({page:1,pageSize:5,sortBy:"",sortDirection:"ASC",filter:"",filterValue:""});f.useEffect(()=>{(async()=>{l(!0);try{await new Promise(u=>setTimeout(u,500));const s=await R(i);n(s)}catch(s){console.error("Error loading table data:",s)}finally{l(!1)}})()},[i]);const m=o=>{c({...i,sortBy:o.columnId,sortDirection:o.direction})},p=o=>{c({...i,page:o})},x=o=>{const s=o.cells.find(u=>u.columnId==="id");s&&alert(`${s.value}번 행을 클릭했습니다.`)},h=o=>{const s=parseInt(o.target.value);c({...i,page:1,pageSize:s})},r=o=>{o.preventDefault();const s=new FormData(o.currentTarget),u=s.get("filterColumn"),g=s.get("filterValue");c({...i,page:1,filter:u,filterValue:g})},d=()=>{c({...i,page:1,filter:"",filterValue:""});const o=document.getElementById("filterForm");o&&o.reset()};return e?t.jsxs("div",{style:{paddingTop:"16px",paddingBottom:"16px",borderTop:"1px solid #ccc",borderBottom:"1px solid #ccc"},children:[t.jsxs("div",{className:"controls-container",children:[t.jsx("div",{className:"filter-container",children:t.jsxs("form",{id:"filterForm",onSubmit:r,children:[t.jsxs("select",{name:"filterColumn",className:"filter-select",children:[t.jsx("option",{value:"",children:"필터 컬럼 선택"}),t.jsx("option",{value:"name",children:"이름"}),t.jsx("option",{value:"email",children:"이메일"})]}),t.jsx("input",{type:"text",name:"filterValue",placeholder:"필터 값 입력",className:"filter-input"}),t.jsx("button",{type:"submit",className:"filter-button",children:"필터 적용"}),t.jsx("button",{type:"button",className:"filter-reset-button",onClick:d,children:"필터 초기화"})]})}),t.jsxs("div",{className:"page-size-container",children:[t.jsx("label",{htmlFor:"pageSize",children:"페이지 크기:"}),t.jsxs("select",{id:"pageSize",value:i.pageSize,onChange:h,className:"page-size-select",children:[t.jsx("option",{value:"3",children:"3개씩"}),t.jsx("option",{value:"5",children:"5개씩"}),t.jsx("option",{value:"10",children:"10개씩"})]})]})]}),t.jsx(B,{viewModel:e,onSortChange:m,onPageChange:p,onRowClick:x,loading:a}),t.jsxs("div",{className:"api-params",children:[t.jsx("h3",{children:"현재 API 파라미터:"}),t.jsx("pre",{children:JSON.stringify(i,null,2)})]})]}):t.jsx("div",{className:"loading-container",children:"로딩 중..."})}export{k as TableExample};
